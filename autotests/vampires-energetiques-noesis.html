<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- SEO -->
  <title>Vampires √ânerg√©tiques,Typologie Relationnelle | NO√âSIS</title>
  <meta name="description" content="Auto-test psychosocial (40 questions) pour identifier les relations asym√©triques chroniques et l'extraction d'√©nergie √©motionnelle. Analyse scientifique rigoureuse sur 6 dimensions.">
  
  <!-- Open Graph -->
  <meta property="og:title" content="Vampires √ânerg√©tiques,Typologie | NO√âSIS">
  <meta property="og:description" content="Identification des patterns de relations √©puisantes. 40 questions, 8-10 minutes.">
  <meta property="og:type" content="website">
  
  <!-- Polices Google -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@300;400;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <style>
    /* ============================================
       VARIABLES CSS NO√âSIS
       ============================================ */
    :root {
      /* Fondations Neutres */
      --noir-absolu: #0A0A0A;
      --noir-doux: #111111;
      --creme-principal: #F7F5EF;
      --creme-chaud: #F9F7F1;
      --blanc-surface: #FFFFFF;
      
      /* Signature Or NO√âSIS */
      --or-signature: #C7A86D;
      --or-riche: #D4B980;
      --or-sombre: #A89158;
      --or-subtil: rgba(199,168,109,0.08);
      --or-leger: rgba(199,168,109,0.15);
      --or-moyen: rgba(199,168,109,0.25);
      
      /* Bordures */
      --border-subtil: rgba(10,10,10,0.08);
      --border-leger: rgba(10,10,10,0.12);
      --border-visible: rgba(10,10,10,0.18);
      
      /* Typographie */
      --fs-xs: 12px; --fs-sm: 14px; --fs-md: 18px;
      --fs-lg: 21px; --fs-xl: 24px; --fs-2xl: 32px; --fs-3xl: 42px;
      --lh-tight: 1.2; --lh-normal: 1.5; --lh-relaxed: 1.7;
      
      /* Spacing (√©chelle 8px) */
      --s-2: 8px; --s-3: 12px; --s-4: 16px;
      --s-6: 24px; --s-8: 32px; --s-12: 48px;
      --s-16: 64px; --s-20: 80px;
      
      /* Ombres */
      --shadow-soft: 0 2px 8px rgba(10,10,10,0.08), 0 1px 2px rgba(10,10,10,0.12);
      --shadow-medium: 0 4px 16px rgba(10,10,10,0.1), 0 2px 4px rgba(10,10,10,0.15);
      --shadow-large: 0 8px 32px rgba(10,10,10,0.12), 0 2px 8px rgba(10,10,10,0.18);
      
      /* Border Radius */
      --radius-sm: 4px; --radius-md: 8px; --radius-lg: 12px;
      --radius-xl: 16px; --radius-2xl: 24px; --radius-pill: 9999px;
      
      /* Animations */
      --duration-fast: 150ms;
      --duration-normal: 250ms;
      --duration-slow: 350ms;
      --ease-standard: cubic-bezier(0.4, 0.0, 0.2, 1);
      --ease-spring: cubic-bezier(0.16, 1, 0.3, 1);
      
      /* Couleurs Dimensionnelles */
      --epuisement-color: #dc2626;
      --epuisement-bg: rgba(220,38,38,0.08);
      --tactique-color: #ea580c;
      --tactique-bg: rgba(234,88,12,0.08);
      --cognitif-color: #7c3aed;
      --cognitif-bg: rgba(124,58,237,0.08);
      --frontiere-color: #2563eb;
      --frontiere-bg: rgba(37,99,235,0.08);
      --social-color: #059669;
      --social-bg: rgba(5,150,105,0.08);
      --reversibilite-color: #10b981;
      --reversibilite-bg: rgba(16,185,129,0.08);
    }
    
    /* ============================================
       RESET & BASE
       ============================================ */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      font-size: var(--fs-md);
      line-height: var(--lh-relaxed);
      color: var(--noir-absolu);
      background: var(--creme-principal);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    
    h1, h2, h3 {
      font-family: 'Fraunces', Georgia, serif;
      font-weight: 600;
      line-height: var(--lh-tight);
      color: var(--noir-absolu);
    }
    
    h1 { font-size: var(--fs-3xl); }
    h2 { font-size: var(--fs-2xl); }
    h3 { font-size: var(--fs-xl); }
    
    /* ============================================
       LAYOUT
       ============================================ */
    .app-container {
      max-width: 900px;
      margin: 0 auto;
      padding: var(--s-12) var(--s-6);
    }
    
    .screen {
      display: none;
      animation: fadeIn var(--duration-normal) var(--ease-standard);
    }
    
    .screen.active {
      display: block;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(8px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* ============================================
       EN-T√äTE INTRODUCTION
       ============================================ */
    .intro-header {
      text-align: center;
      margin-bottom: var(--s-12);
    }
    
    .intro-icon-container {
      width: 80px;
      height: 80px;
      margin: 0 auto var(--s-6);
      background: linear-gradient(135deg, var(--or-subtil), var(--or-leger));
      border: 3px solid var(--or-signature);
      border-radius: var(--radius-xl);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .intro-icon {
      width: 48px;
      height: 48px;
      stroke: var(--or-signature);
      fill: none;
      stroke-width: 2;
    }
    
    .intro-title {
      font-size: var(--fs-3xl);
      margin-bottom: var(--s-3);
      color: var(--noir-absolu);
    }
    
    .intro-subtitle {
      font-size: var(--fs-md);
      color: rgba(10,10,10,0.6);
      font-weight: 400;
      line-height: var(--lh-normal);
      max-width: 700px;
      margin: 0 auto;
    }
    
    /* ============================================
       CARTES
       ============================================ */
    .card {
      background: var(--blanc-surface);
      border-radius: var(--radius-2xl);
      padding: var(--s-12);
      margin-bottom: var(--s-8);
      box-shadow: var(--shadow-large);
    }
    
    .card h2 {
      font-size: var(--fs-xl);
      margin-bottom: var(--s-6);
      display: flex;
      align-items: center;
      gap: var(--s-3);
    }
    
    .card-icon {
      width: 24px;
      height: 24px;
      stroke: var(--or-signature);
      fill: none;
      stroke-width: 2;
      flex-shrink: 0;
    }
    
    .card p {
      margin-bottom: var(--s-4);
      color: rgba(10,10,10,0.85);
      line-height: var(--lh-relaxed);
    }
    
    .card p:last-child {
      margin-bottom: 0;
    }
    
    .card ul {
      margin-left: var(--s-6);
      color: rgba(10,10,10,0.85);
    }
    
    .card ul li {
      margin-bottom: var(--s-2);
      line-height: var(--lh-normal);
    }
    
    /* ============================================
       M√âTHODOLOGIE,GRID 2x2+1
       ============================================ */
    .methodology-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: var(--s-4);
      margin-bottom: var(--s-6);
    }
    
    .methodology-item {
      background: var(--creme-chaud);
      border-radius: var(--radius-lg);
      padding: var(--s-6);
      text-align: center;
    }
    
    .methodology-item-icon {
      width: 48px;
      height: 48px;
      margin: 0 auto var(--s-3);
      stroke: var(--or-signature);
      fill: none;
      stroke-width: 2;
    }
    
    .methodology-item-title {
      font-family: 'Fraunces', serif;
      font-size: var(--fs-lg);
      font-weight: 600;
      margin-bottom: var(--s-2);
      color: var(--noir-absolu);
    }
    
    .methodology-item-subtitle {
      font-size: var(--fs-sm);
      color: rgba(10,10,10,0.7);
      line-height: var(--lh-normal);
    }
    
    .methodology-item.full-width {
      grid-column: 1 / -1;
    }
    
    .methodology-validity {
      background: var(--or-subtil);
      border-left: 4px solid var(--or-signature);
      border-radius: var(--radius-md);
      padding: var(--s-4);
      font-size: var(--fs-sm);
      line-height: var(--lh-normal);
      color: rgba(10,10,10,0.75);
    }
    
    .methodology-validity strong {
      color: var(--noir-absolu);
      font-weight: 600;
    }
    
    /* ============================================
       WARNING BOX
       ============================================ */
    .warning-box {
      background: #fffbeb;
      border-left: 4px solid var(--or-signature);
      border-radius: var(--radius-md);
      padding: var(--s-6);
      margin-bottom: var(--s-8);
    }
    
    .warning-box h3 {
      font-size: var(--fs-lg);
      margin-bottom: var(--s-3);
      display: flex;
      align-items: center;
      gap: var(--s-2);
      color: var(--noir-absolu);
    }
    
    .warning-icon {
      width: 20px;
      height: 20px;
      stroke: var(--or-signature);
      fill: none;
      stroke-width: 2;
      flex-shrink: 0;
    }
    
    .warning-box p {
      font-size: var(--fs-sm);
      line-height: var(--lh-relaxed);
      color: rgba(10,10,10,0.75);
      margin-bottom: var(--s-3);
    }
    
    .warning-box p:last-child {
      margin-bottom: 0;
    }
    
    .emergency-resources {
      margin-top: var(--s-4);
      padding-top: var(--s-4);
      border-top: 1px solid rgba(199,168,109,0.3);
      font-weight: 500;
    }
    
    .emergency-resources strong {
      color: var(--or-sombre);
    }
    
    /* ============================================
       DIMENSIONS √âVALU√âES
       ============================================ */
    .dimensions-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: var(--s-4);
    }
    
    .dimension-card {
      padding: var(--s-6);
      border-radius: var(--radius-lg);
      border-left: 4px solid;
      position: relative;
    }
    
    .dimension-card.epuisement {
      background: var(--epuisement-bg);
      border-color: var(--epuisement-color);
    }
    
    .dimension-card.tactique {
      background: var(--tactique-bg);
      border-color: var(--tactique-color);
    }
    
    .dimension-card.cognitif {
      background: var(--cognitif-bg);
      border-color: var(--cognitif-color);
    }
    
    .dimension-card.frontiere {
      background: var(--frontiere-bg);
      border-color: var(--frontiere-color);
    }
    
    .dimension-card.social {
      background: var(--social-bg);
      border-color: var(--social-color);
    }
    
    .dimension-card.reversibilite {
      background: var(--reversibilite-bg);
      border-color: var(--reversibilite-color);
    }
    
    .dimension-number {
      font-family: 'Fraunces', serif;
      font-size: var(--fs-3xl);
      font-weight: 300;
      opacity: 0.2;
      margin-bottom: var(--s-2);
    }
    
    .dimension-title {
      font-family: 'Fraunces', serif;
      font-size: var(--fs-lg);
      font-weight: 600;
      margin-bottom: var(--s-3);
      color: var(--noir-absolu);
    }
    
    .dimension-description {
      font-size: var(--fs-sm);
      color: rgba(10,10,10,0.75);
      line-height: var(--lh-normal);
    }
    
    /* ============================================
       FORMULAIRE ANAMN√àSE
       ============================================ */
    .form-group {
      display: flex;
      flex-direction: column;
      gap: var(--s-2);
      margin-bottom: var(--s-6);
    }
    
    .form-label {
      font-size: var(--fs-md);
      font-weight: 600;
      color: var(--noir-absolu);
    }
    
    .form-select, .form-input {
      padding: var(--s-4);
      border: 2px solid var(--border-leger);
      border-radius: var(--radius-md);
      font-size: var(--fs-md);
      font-family: 'Inter', sans-serif;
      background: var(--blanc-surface);
      transition: all var(--duration-normal) var(--ease-standard);
    }
    
    .form-select:focus, .form-input:focus {
      outline: none;
      border-color: var(--or-signature);
      box-shadow: 0 0 0 3px var(--or-subtil);
    }
    
    /* ============================================
       CONSENTEMENT
       ============================================ */
    .consent-container {
      background: var(--or-subtil);
      border: 2px solid var(--or-leger);
      border-radius: var(--radius-md);
      padding: var(--s-6);
      margin-top: var(--s-8);
      margin-bottom: var(--s-6);
    }
    
    .consent-checkbox-wrapper {
      display: flex;
      align-items: flex-start;
      gap: var(--s-3);
      cursor: pointer;
    }
    
    .consent-checkbox-wrapper input[type="checkbox"] {
      margin-top: 4px;
      width: 20px;
      height: 20px;
      cursor: pointer;
      accent-color: var(--or-signature);
    }
    
    .consent-checkbox-wrapper label {
      flex: 1;
      font-size: var(--fs-sm);
      line-height: var(--lh-normal);
      color: var(--noir-absolu);
      cursor: pointer;
    }
    
    /* ============================================
       BOUTONS
       ============================================ */
    .btn {
      font-family: 'Inter', sans-serif;
      font-size: var(--fs-md);
      font-weight: 600;
      padding: var(--s-4) var(--s-8);
      border-radius: var(--radius-md);
      cursor: pointer;
      transition: all var(--duration-normal) var(--ease-standard);
      border: none;
      display: inline-block;
      text-decoration: none;
      text-align: center;
    }
    
    .btn-primary {
      background: var(--or-signature);
      color: var(--blanc-surface);
      box-shadow: var(--shadow-soft);
    }
    
    .btn-primary:hover:not(:disabled) {
      background: var(--or-riche);
      transform: translateY(-2px);
      box-shadow: var(--shadow-medium);
    }
    
    .btn-primary:active:not(:disabled) {
      background: var(--or-sombre);
      transform: translateY(0);
    }
    
    .btn-primary:disabled {
      opacity: 0.4;
      cursor: not-allowed;
      transform: none;
    }
    
    .btn-secondary {
      background: transparent;
      color: var(--or-signature);
      border: 2px solid var(--or-signature);
    }
    
    .btn-secondary:hover {
      background: var(--or-subtil);
    }
    
    .btn-large {
      width: 100%;
      padding: var(--s-6) var(--s-8);
      font-size: var(--fs-lg);
    }
    
    /* ============================================
       BARRE DE PROGRESSION
       ============================================ */
    .progress-container {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: var(--blanc-surface);
      padding: var(--s-4) var(--s-6);
      box-shadow: var(--shadow-soft);
      z-index: 1000;
    }
    
    .progress-info {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--s-2);
      font-size: var(--fs-sm);
      font-weight: 500;
      color: var(--noir-doux);
    }
    
    #questions-remaining {
      color: rgba(10,10,10,0.6);
    }
    
    .progress-bar-container {
      height: 4px;
      background: var(--creme-principal);
      border-radius: var(--radius-pill);
      overflow: hidden;
    }
    
    .progress-bar-fill {
      height: 100%;
      background: var(--or-signature);
      transition: width var(--duration-slow) var(--ease-spring);
      border-radius: var(--radius-pill);
    }
    
    /* ============================================
       QUESTION
       ============================================ */
    .question-container {
      margin-top: 100px;
      margin-bottom: var(--s-20);
    }
    
    .question-card {
      background: var(--blanc-surface);
      border-radius: var(--radius-2xl);
      padding: var(--s-12);
      box-shadow: var(--shadow-large);
    }
    
    .question-header {
      margin-bottom: var(--s-6);
    }
    
    .question-number {
      font-size: var(--fs-xs);
      font-weight: 600;
      color: rgba(10,10,10,0.5);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: var(--s-2);
    }
    
    .dimension-badge {
      display: inline-block;
      padding: var(--s-2) var(--s-4);
      border-radius: var(--radius-pill);
      font-size: var(--fs-xs);
      font-weight: 600;
      margin-bottom: var(--s-6);
    }
    
    .dimension-badge.epuisement {
      background: var(--epuisement-bg);
      color: var(--epuisement-color);
    }
    
    .dimension-badge.tactique {
      background: var(--tactique-bg);
      color: var(--tactique-color);
    }
    
    .dimension-badge.cognitif {
      background: var(--cognitif-bg);
      color: var(--cognitif-color);
    }
    
    .dimension-badge.frontiere {
      background: var(--frontiere-bg);
      color: var(--frontiere-color);
    }
    
    .dimension-badge.social {
      background: var(--social-bg);
      color: var(--social-color);
    }
    
    .dimension-badge.reversibilite {
      background: var(--reversibilite-bg);
      color: var(--reversibilite-color);
    }
    
    .question-text {
      font-size: var(--fs-lg);
      line-height: var(--lh-relaxed);
      margin-bottom: var(--s-8);
      color: var(--noir-absolu);
    }
    
    .answer-options {
      display: flex;
      flex-direction: column;
      gap: var(--s-3);
    }
    
    .answer-option {
      background: var(--blanc-surface);
      border: 2px solid var(--border-leger);
      border-radius: var(--radius-md);
      padding: var(--s-4);
      cursor: pointer;
      transition: all var(--duration-normal) var(--ease-standard);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .answer-option:hover {
      border-color: var(--border-visible);
      transform: translateX(4px);
      box-shadow: var(--shadow-soft);
    }
    
    .answer-option.selected {
      background: var(--or-subtil);
      border: 2px solid var(--or-signature);
      transform: scale(1.02);
    }
    
    .option-content {
      flex: 1;
    }
    
    .option-label {
      font-size: var(--fs-md);
      font-weight: 600;
      color: var(--noir-absolu);
      margin-bottom: var(--s-2);
    }
    
    .option-sublabel {
      font-size: var(--fs-sm);
      color: rgba(10,10,10,0.7);
      line-height: var(--lh-normal);
    }
    
    .option-check {
      width: 24px;
      height: 24px;
      border-radius: var(--radius-pill);
      border: 2px solid var(--border-visible);
      transition: all var(--duration-fast) var(--ease-standard);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      margin-left: var(--s-4);
    }
    
    .answer-option.selected .option-check {
      background: var(--or-signature);
      border-color: var(--or-signature);
    }
    
    .check-icon {
      width: 14px;
      height: 14px;
      stroke: var(--blanc-surface);
      stroke-width: 3;
      display: none;
    }
    
    .answer-option.selected .check-icon {
      display: block;
    }
    
    /* ============================================
       NAVIGATION FOOTER
       ============================================ */
    .nav-footer {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--blanc-surface);
      padding: var(--s-4) var(--s-6);
      box-shadow: 0 -2px 8px rgba(10,10,10,0.08);
      display: flex;
      justify-content: space-between;
      gap: var(--s-4);
      z-index: 999;
    }
    
    .nav-footer .btn {
      flex: 1;
      max-width: 200px;
    }
    
    /* ============================================
       R√âSULTATS
       ============================================ */
    .results-header {
      text-align: center;
      margin-bottom: var(--s-12);
    }
    
    .score-circle-container {
      display: flex;
      justify-content: center;
      margin: var(--s-8) 0;
    }
    
    .result-band {
      text-align: center;
      padding: var(--s-6);
      border-radius: var(--radius-lg);
      margin-top: var(--s-6);
    }
    
    .result-band h3 {
      font-size: var(--fs-2xl);
      margin-bottom: var(--s-3);
    }
    
    .result-band p {
      font-size: var(--fs-md);
      line-height: var(--lh-relaxed);
    }
    
    .dimension-bars {
      display: flex;
      flex-direction: column;
      gap: var(--s-6);
    }
    
    .dimension-bar-item {
      display: flex;
      align-items: center;
      gap: var(--s-4);
    }
    
    .dimension-bar-label {
      min-width: 140px;
      font-weight: 600;
      font-size: var(--fs-sm);
    }
    
    .dimension-bar-track {
      flex: 1;
      height: 32px;
      background: var(--creme-chaud);
      border-radius: var(--radius-md);
      overflow: hidden;
      position: relative;
    }
    
    .dimension-bar-fill {
      height: 100%;
      transition: width 1s var(--ease-spring);
      display: flex;
      align-items: center;
      justify-content: flex-end;
      padding-right: var(--s-3);
    }
    
    .dimension-bar-value {
      font-weight: 700;
      font-size: var(--fs-sm);
      color: var(--blanc-surface);
      text-shadow: 0 1px 2px rgba(0,0,0,0.2);
    }
    
    .export-actions {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: var(--s-4);
      margin-top: var(--s-8);
    }
    
    /* ============================================
       RESPONSIVE
       ============================================ */
    @media (max-width: 768px) {
      :root {
        --fs-3xl: 32px;
        --fs-2xl: 24px;
        --s-12: 32px;
      }
      
      .app-container {
        padding: var(--s-8) var(--s-4);
      }
      
      .methodology-grid,
      .dimensions-grid {
        grid-template-columns: 1fr;
      }
      
      .question-container {
        margin-top: 90px;
      }
      
      .nav-footer {
        flex-direction: column;
      }
      
      .nav-footer .btn {
        max-width: 100%;
      }
      
      .export-actions {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  
  <div class="app-container">
    
    <!-- ============================================
         √âCRAN 1 : INTRODUCTION
         ============================================ -->
    <div id="intro-screen" class="screen active">
      
      <!-- En-t√™te -->
      <div class="intro-header">
        <div class="intro-icon-container">
          <svg class="intro-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
            <circle cx="9" cy="7" r="4"/>
            <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
            <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
            <line x1="2" y1="2" x2="22" y2="22"/>
          </svg>
        </div>
        <h1 class="intro-title">Vampires √ânerg√©tiques</h1>
        <p class="intro-subtitle">
          Typologie Relationnelle,Identification des patterns d'extraction √©motionnelle chronique et asym√©trie syst√©mique
        </p>
      </div>
      
      <!-- Avertissement -->
      <div class="warning-box">
        <h3>
          <svg class="warning-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
            <line x1="12" y1="9" x2="12" y2="13"/>
            <line x1="12" y1="17" x2="12.01" y2="17"/>
          </svg>
          Avertissement Important
        </h3>
        <p>
          Cet outil constitue un <strong>questionnaire de sensibilisation</strong> et ne remplace en aucun cas une consultation avec un professionnel de sant√© qualifi√© (psychologue, psychiatre, th√©rapeute).
        </p>
        <p>
          Les r√©sultats refl√®tent votre <strong>perception subjective</strong> √† un instant donn√© et n√©cessitent une interpr√©tation contextuelle par un clinicien. <strong>Aucune donn√©e n'est collect√©e, stock√©e ou transmise.</strong> Toutes les informations restent locales dans votre navigateur.
        </p>
        <div class="emergency-resources">
          <strong>Ressources d'urgence :</strong> 3919 (Violences Femmes Info, 24/7) ‚Ä¢ 119 (Enfance en Danger) ‚Ä¢ 3114 (Pr√©vention Suicide)
        </div>
      </div>
      
      <!-- M√©thodologie -->
      <div class="card">
        <h2>
          <svg class="card-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
            <polyline points="3.27 6.96 12 12.01 20.73 6.96"/>
            <line x1="12" y1="22.08" x2="12" y2="12"/>
          </svg>
          M√©thodologie
        </h2>
        <div class="methodology-grid">
          <div class="methodology-item">
            <svg class="methodology-item-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
              <line x1="9" y1="9" x2="15" y2="9"/>
              <line x1="9" y1="15" x2="15" y2="15"/>
            </svg>
            <div class="methodology-item-title">40 Questions</div>
            <div class="methodology-item-subtitle">√âvaluation compl√®te approfondie</div>
          </div>
          <div class="methodology-item">
            <svg class="methodology-item-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="10"/>
              <polyline points="12 6 12 12 16 14"/>
            </svg>
            <div class="methodology-item-title">8-10 Minutes</div>
            <div class="methodology-item-subtitle">Temps estim√© de passation</div>
          </div>
          <div class="methodology-item">
            <svg class="methodology-item-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
              <line x1="16" y1="2" x2="16" y2="6"/>
              <line x1="8" y1="2" x2="8" y2="6"/>
              <line x1="3" y1="10" x2="21" y2="10"/>
            </svg>
            <div class="methodology-item-title">6 Derniers Mois</div>
            <div class="methodology-item-subtitle">P√©riode de r√©f√©rence</div>
          </div>
          <div class="methodology-item">
            <svg class="methodology-item-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="5" y="2" width="14" height="20" rx="2" ry="2"/>
              <line x1="12" y1="18" x2="12.01" y2="18"/>
            </svg>
            <div class="methodology-item-title">100% Anonyme</div>
            <div class="methodology-item-subtitle">Donn√©es strictement confidentielles</div>
          </div>
          <div class="methodology-item full-width">
            <svg class="methodology-item-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
              <polyline points="7 10 12 15 17 10"/>
              <line x1="12" y1="15" x2="12" y2="3"/>
            </svg>
            <div class="methodology-item-title">Export PDF</div>
            <div class="methodology-item-subtitle">Rapport d√©taill√© professionnel √† t√©l√©charger</div>
          </div>
        </div>
        <div class="methodology-validity">
          <strong>Cadre th√©orique :</strong> Th√©orie de l'√©change social (Thibaut & Kelley, 1959), asym√©trie relationnelle chronique (Felmlee, 1994), √©puisement compassionnel (Figley, 1995), dynamiques narcissiques et extraction √©motionnelle (Kernberg, 1975).
          <br><br>
          <strong>Validit√© :</strong> Outil de sensibilisation non valid√© psychom√©triquement. Ne constitue pas un instrument diagnostique. Les r√©sultats doivent √™tre interpr√©t√©s par un professionnel qualifi√©.
        </div>
      </div>
      
      <!-- Dimensions √âvalu√©es -->
      <div class="card">
        <h2>
          <svg class="card-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="3" y="3" width="7" height="7"/>
            <rect x="14" y="3" width="7" height="7"/>
            <rect x="14" y="14" width="7" height="7"/>
            <rect x="3" y="14" width="7" height="7"/>
          </svg>
          Dimensions √âvalu√©es
        </h2>
        <p style="margin-bottom: 24px;">
          Ce questionnaire √©value six dimensions psychosociales des relations asym√©triques et √©puisantes, identifi√©es dans la recherche contemporaine sur les dynamiques relationnelles toxiques.
        </p>
        <div class="dimensions-grid">
          <div class="dimension-card epuisement">
            <div class="dimension-number">01</div>
            <div class="dimension-title">√âpuisement √âmotionnel</div>
            <div class="dimension-description">
              Fatigue chronique, sympt√¥mes physiques, drainage √©nerg√©tique syst√©matique apr√®s interactions.
            </div>
          </div>
          <div class="dimension-card tactique">
            <div class="dimension-number">02</div>
            <div class="dimension-title">Tactiques Manipulatives</div>
            <div class="dimension-description">
              Monopolisation, dramatisation, cr√©ation de dettes morales, minimisation des besoins l√©gitimes.
            </div>
          </div>
          <div class="dimension-card cognitif">
            <div class="dimension-number">03</div>
            <div class="dimension-title">Envahissement Cognitif</div>
            <div class="dimension-description">
              Ruminations, hypervigilance, difficult√©s concentration, auto-censure pr√©ventive.
            </div>
          </div>
          <div class="dimension-card frontiere">
            <div class="dimension-number">04</div>
            <div class="dimension-title">Transgression Fronti√®res</div>
            <div class="dimension-description">
              Limites ignor√©es, sanctions √©motionnelles, asym√©trie du don, responsabilit√© √©motionnelle d√©plac√©e.
            </div>
          </div>
          <div class="dimension-card social">
            <div class="dimension-number">05</div>
            <div class="dimension-title">Impact Social & Fonctionnel</div>
            <div class="dimension-description">
              Alt√©ration performance, isolement progressif, multi-canal invasif, dissimulation par honte.
            </div>
          </div>
          <div class="dimension-card reversibilite">
            <div class="dimension-number">06</div>
            <div class="dimension-title">R√©versibilit√© Dynamique</div>
            <div class="dimension-description">
              Capacit√© de r√©cup√©ration, efficacit√© des fronti√®res, reconnaissance des exc√®s, durabilit√© des am√©liorations.
            </div>
          </div>
        </div>
      </div>
      
      <!-- Comment √ßa marche -->
      <div class="card">
        <h2>
          <svg class="card-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="3"/>
            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
          </svg>
          Comment √ßa marche
        </h2>
        <p>
          <strong>√âchelle de r√©ponse (0-4) :</strong> Chaque item est √©valu√© selon la fr√©quence √† laquelle vous ressentez la situation d√©crite dans votre contexte professionnel actuel : 0 (Jamais), 1 (Rarement), 2 (Parfois), 3 (Souvent), 4 (Quasi-syst√©matiquement).
        </p>
        <p>
          <strong>Calcul des scores :</strong> Score par dimension (0-32 points, 8 items √ó 0-4) + Score total (0-160 points, somme des 5 dimensions) + IIF,Impact Fonctionnel Imm√©diat (0-20 points, 5 items critiques prioritaires de la dimension Impact).
        </p>
        <p>
          <strong>Interpr√©tation :</strong> Plus le score est √©lev√©, plus la perte de sens est marqu√©e. Les r√©sultats sont fournis par dimension et globalement, avec des recommandations personnalis√©es selon votre profil. Un score √©lev√© indique un besoin d'attention et potentiellement d'accompagnement professionnel.
        </p>
      </div>
      
      <!-- Informations Pr√©liminaires -->
      <div class="card">
        <h2>
          <svg class="card-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
            <circle cx="8.5" cy="7" r="4"/>
            <line x1="20" y1="8" x2="20" y2="14"/>
            <line x1="23" y1="11" x2="17" y1="11"/>
          </svg>
          Informations Pr√©liminaires (Optionnel)
        </h2>
        <div class="form-group">
          <label for="relation-type" class="form-label">Type de relation concern√©e</label>
          <select id="relation-type" class="form-select">
            <option value="">S√©lectionner...</option>
            <option value="romantic">Relation amoureuse / Couple</option>
            <option value="family">Relation familiale (parent, fratrie...)</option>
            <option value="friend">Relation amicale</option>
            <option value="professional">Relation professionnelle (coll√®gue, hi√©rarchie...)</option>
            <option value="other">Autre</option>
          </select>
        </div>
        <div class="form-group">
          <label for="relation-duration" class="form-label">Dur√©e approximative de la relation</label>
          <select id="relation-duration" class="form-select">
            <option value="">S√©lectionner...</option>
            <option value="<6m">Moins de 6 mois</option>
            <option value="6m-1y">6 mois √† 1 an</option>
            <option value="1-2y">1 √† 2 ans</option>
            <option value="2-5y">2 √† 5 ans</option>
            <option value=">5y">Plus de 5 ans</option>
          </select>
        </div>
        <div class="form-group">
          <label for="participant-name" class="form-label">Nom ou pseudonyme (appara√Ætra sur le PDF)</label>
          <input type="text" id="participant-name" class="form-input" placeholder="Anonyme" value="Anonyme">
        </div>
      </div>
      
      <!-- Consentement -->
      <div class="consent-container">
        <div class="consent-checkbox-wrapper">
          <input type="checkbox" id="consent-checkbox">
          <label for="consent-checkbox">
            J'ai lu et compris les avertissements. Je confirme que cet outil est utilis√© √† des fins informatives uniquement et qu'il ne remplace pas une consultation avec un professionnel de sant√© qualifi√©. Je comprends que toutes mes donn√©es restent locales et ne sont transmises √† aucun serveur.
          </label>
        </div>
      </div>
      
      <button class="btn btn-primary btn-large" id="start-btn" disabled>
        Commencer l'√âvaluation
      </button>
      
    </div>
    
    <!-- ============================================
         √âCRAN 2 : QUESTIONNAIRE
         ============================================ -->
    <div id="test-screen" class="screen">
      <div class="progress-container">
        <div class="progress-info">
          <span id="progress-text">Question 1 / 40</span>
          <span id="questions-remaining">40 questions restantes</span>
        </div>
        <div class="progress-bar-container">
          <div class="progress-bar-fill" id="progress-fill" style="width: 0%"></div>
        </div>
      </div>
      
      <div class="question-container" id="question-container"></div>
      
      <div class="nav-footer" style="display: none;">
        <button class="btn btn-secondary" id="prev-btn">‚Üê Pr√©c√©dent</button>
        <button class="btn btn-primary" id="next-btn" disabled>Suivant ‚Üí</button>
      </div>
    </div>
    
    <!-- ============================================
         √âCRAN 3 : R√âSULTATS
         ============================================ -->
    <div id="results-screen" class="screen">
      <div class="results-header">
        <h1>Vos R√©sultats</h1>
        <p style="font-size: 14px; color: rgba(10,10,10,0.6); margin-top: 8px;" id="results-date"></p>
      </div>
      
      <div class="card">
        <h2>Score Global</h2>
        <div class="score-circle-container" id="score-circle"></div>
        <div id="result-band"></div>
      </div>
      
      <div class="card">
        <h2>Analyse par Dimension</h2>
        <div class="dimension-bars" id="dimension-bars"></div>
      </div>
      
      <div class="card">
        <h2>Profil Contextuel</h2>
        <div id="profile-summary"></div>
      </div>
      
      <div class="card">
        <h2>Recommandations Personnalis√©es</h2>
        <div id="recommendations"></div>
      </div>
      
      <div class="card" style="background: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 100%);">
        <h2>Ressources & Soutien</h2>
        <ul>
          <li><strong>3919</strong>,Violences Femmes Info (24/7, gratuit)</li>
          <li><strong>119</strong>,All√¥ Enfance en Danger (gratuit)</li>
          <li><strong>3114</strong>,Pr√©vention Suicide (24/7, gratuit)</li>
          <li><strong>SOS Femmes</strong>,01 40 47 06 06</li>
          <li><strong>CIDFF</strong>,Centre d'Information sur les Droits des Femmes et des Familles (<a href="https://www.cidff.info" target="_blank" style="color: var(--or-signature);">cidff.info</a>)</li>
          <li><strong>Psycom</strong>,Information sant√© mentale (<a href="https://www.psycom.org" target="_blank" style="color: var(--or-signature);">psycom.org</a>)</li>
        </ul>
      </div>
      
      <div class="export-actions">
        <button class="btn btn-primary" id="pdf-btn">üìÑ T√©l√©charger PDF</button>
        <button class="btn btn-secondary" id="email-btn">‚úâÔ∏è Envoyer Email</button>
        <button class="btn btn-secondary" id="json-btn">üìä Export JSON</button>
        <button class="btn btn-secondary" id="reset-btn">üîÑ Recommencer</button>
      </div>
    </div>
    
  </div>
  
  <script>
    // ============================================
    // CONFIGURATION
    // ============================================
    const SCALE = [
      {v:0, l:"Jamais", s:"Absent ou tr√®s rare (<5%)"},
      {v:1, l:"Rarement", s:"Occasionnel (5-25%)"},
      {v:2, l:"Parfois", s:"R√©gulier (25-50%)"},
      {v:3, l:"Souvent", s:"Fr√©quent (50-75%)"},
      {v:4, l:"Quasi-syst√©matiquement", s:"Permanent (>75%)"}
    ];
    
    const DIMENSIONS = [
      {k:'epuisement', l:'√âpuisement', fullLabel:'√âpuisement √âmotionnel', c:'#dc2626'},
      {k:'tactique', l:'Tactiques', fullLabel:'Tactiques Manipulatives', c:'#ea580c'},
      {k:'cognitif', l:'Cognitif', fullLabel:'Envahissement Cognitif', c:'#7c3aed'},
      {k:'frontiere', l:'Fronti√®res', fullLabel:'Transgression Fronti√®res', c:'#2563eb'},
      {k:'social', l:'Social', fullLabel:'Impact Social & Fonctionnel', c:'#059669'},
      {k:'reversibilite', l:'R√©versibilit√©', fullLabel:'R√©versibilit√© Dynamique', c:'#10b981'}
    ];
    
    const QUESTIONS = [
      // √âpuisement (7)
      {id:'q1', dim:'epuisement', text:"Je me sens particuli√®rement fatigu√©¬∑e apr√®s avoir interagi avec cette personne."},
      {id:'q2', dim:'epuisement', text:"J'ai besoin de m'isoler ou me reposer apr√®s nos √©changes."},
      {id:'q3', dim:'epuisement', text:"Je ressens du stress ou de l'anxi√©t√© avant ses appels/messages."},
      {id:'q4', dim:'epuisement', text:"J'ai des sympt√¥mes physiques apr√®s nos interactions (maux de t√™te, tension...)."},
      {id:'q5', dim:'epuisement', text:"Mon √©nergie varie nettement selon sa pr√©sence ou absence."},
      {id:'q6', dim:'epuisement', text:"Je me r√©veille la nuit en pensant √† cette relation."},
      {id:'q7', dim:'epuisement', text:"Mes autres activit√©s sont affect√©es par la fatigue li√©e √† cette relation."},
      
      // Tactiques (8)
      {id:'q8', dim:'tactique', text:"Elle monopolise mon temps de mani√®re disproportionn√©e."},
      {id:'q9', dim:'tactique', text:"Elle impose ses sujets sans s'int√©resser aux miens."},
      {id:'q10', dim:'tactique', text:"Elle dramatise pour obtenir une r√©ponse prioritaire."},
      {id:'q11', dim:'tactique', text:"Elle cr√©e des 'dettes morales' : je me sens redevable."},
      {id:'q12', dim:'tactique', text:"Elle requalifie mes refus comme des attaques."},
      {id:'q13', dim:'tactique', text:"Elle minimise ou d√©nigre mes besoins."},
      {id:'q14', dim:'tactique', text:"Elle demande des choses qui d√©passent mes capacit√©s r√©elles."},
      {id:'q15', dim:'tactique', text:"La personne reconna√Æt ses torts et cherche √† √©quilibrer la relation.", reverse:true},
      
      // Cognitif (7)
      {id:'q16', dim:'cognitif', text:"Je rumine longuement apr√®s nos √©changes."},
      {id:'q17', dim:'cognitif', text:"Je suis en hypervigilance : j'anticipe ses r√©actions."},
      {id:'q18', dim:'cognitif', text:"J'ai des difficult√©s de concentration accrues."},
      {id:'q19', dim:'cognitif', text:"Je me censure pour √©viter ses r√©actions."},
      {id:'q20', dim:'cognitif', text:"Je doute de ma perception apr√®s qu'elle l'ait contest√©e."},
      {id:'q21', dim:'cognitif', text:"J'ai perdu de l'int√©r√™t pour mes projets personnels."},
      {id:'q22', dim:'cognitif', text:"Je me sens clairement mieux quand la relation est en pause.", reverse:true},
      
      // Fronti√®res (8)
      {id:'q23', dim:'frontiere', text:"Mes limites sont test√©es puis ignor√©es."},
      {id:'q24', dim:'frontiere', text:"Quand je dis non, elle r√©agit par sanction √©motionnelle."},
      {id:'q25', dim:'frontiere', text:"Je donne syst√©matiquement plus que je re√ßois."},
      {id:'q26', dim:'frontiere', text:"Je m'excuse d'exister quand j'exprime un besoin."},
      {id:'q27', dim:'frontiere', text:"Je cache mon √©tat pour ne pas la contrarier."},
      {id:'q28', dim:'frontiere', text:"Je me sens responsable de son bien-√™tre √©motionnel."},
      {id:'q29', dim:'frontiere', text:"Je consens √† ses demandes pour √©viter un conflit.", critical:true},
      {id:'q30', dim:'frontiere', text:"Mes limites claires sont respect√©es durablement.", reverse:true},
      
      // Social (6)
      {id:'q31', dim:'social', text:"Mon entourage dit que je parais √©puis√©¬∑e ou chang√©¬∑e."},
      {id:'q32', dim:'social', text:"Mes t√¢ches pro/√©tudes sont retard√©es par ses sollicitations."},
      {id:'q33', dim:'social', text:"Elle me contacte sur plusieurs canaux en parall√®le."},
      {id:'q34', dim:'social', text:"Elle contourne mes cr√©neaux ou contacte mon entourage.", critical:true},
      {id:'q35', dim:'social', text:"Elle tente d'isoler mes autres relations de soutien.", critical:true},
      {id:'q36', dim:'social', text:"Je cache la situation par honte ou peur du jugement."},
      
      // R√©versibilit√© (4)
      {id:'q37', dim:'reversibilite', text:"Mon √©nergie remonte quand je r√©duis le contact.", reverse:true},
      {id:'q38', dim:'reversibilite', text:"Des r√®gles claires am√©liorent la relation.", reverse:true},
      {id:'q39', dim:'reversibilite', text:"Elle reconna√Æt ses exc√®s et modifie son comportement.", reverse:true},
      {id:'q40', dim:'reversibilite', text:"Les am√©liorations tiennent rarement plus de quelques semaines."}
    ];
    
    const BANDS = [
      {min:0, max:35, level:"Relation Fonctionnelle", color:"#10b981", text:"Pas de pattern toxique majeur. Ajustements ponctuels possibles."},
      {min:36, max:70, level:"Fatigue Mod√©r√©e", color:"#f59e0b", text:"√âpuisement notable. Limites plus claires recommand√©es. Consulter si r√©sistance durable."},
      {min:71, max:110, level:"Pattern √âpuisant √âtabli", color:"#ea580c", text:"Toxicit√© significative. Bien-√™tre affect√©. R√©duire exposition + consultation psychologique recommand√©e."},
      {min:111, max:200, level:"D√©rive d'Emprise Probable", color:"#dc2626", text:"‚ö†Ô∏è Dynamique potentiellement coercitive. PRIORIT√â : protection, distance, soutien sp√©cialis√© imm√©diat."}
    ];
    
    // ============================================
    // STATE
    // ============================================
    const state = {
      screen: 'intro',
      qIdx: 0,
      answers: {},
      anamnesis: {
        type: null,
        dur: null,
        name: 'Anonyme'
      }
    };
    
    // ============================================
    // INITIALISATION
    // ============================================
    document.addEventListener('DOMContentLoaded', () => {
      const consent = document.getElementById('consent-checkbox');
      const relType = document.getElementById('relation-type');
      const startBtn = document.getElementById('start-btn');
      
      function updateStart() {
        startBtn.disabled = !(consent.checked && relType.value);
      }
      
      consent.addEventListener('change', updateStart);
      relType.addEventListener('change', updateStart);
      
      startBtn.addEventListener('click', () => {
        state.anamnesis.type = document.getElementById('relation-type').value;
        state.anamnesis.dur = document.getElementById('relation-duration').value;
        state.anamnesis.name = document.getElementById('participant-name').value || 'Anonyme';
        showScreen('test');
        renderQuestion();
      });
    });
    
    // ============================================
    // NAVIGATION
    // ============================================
    function showScreen(screenName) {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById(`${screenName}-screen`).classList.add('active');
      state.screen = screenName;
      window.scrollTo({top: 0, behavior: 'smooth'});
    }
    
    // ============================================
    // QUESTIONNAIRE
    // ============================================
    function renderQuestion() {
      const q = QUESTIONS[state.qIdx];
      const dim = DIMENSIONS.find(d => d.k === q.dim);
      const progress = ((state.qIdx + 1) / QUESTIONS.length) * 100;
      
      document.getElementById('progress-text').textContent = `Question ${state.qIdx + 1} / ${QUESTIONS.length}`;
      document.getElementById('questions-remaining').textContent = `${QUESTIONS.length - state.qIdx} questions restantes`;
      document.getElementById('progress-fill').style.width = `${progress}%`;
      
      const container = document.getElementById('question-container');
      container.innerHTML = `
        <div class="question-card">
          <div class="question-header">
            <div class="question-number">Question ${state.qIdx + 1}</div>
            <div class="dimension-badge ${q.dim}">${dim.l}</div>
          </div>
          <div class="question-text">${q.text}</div>
          <div class="answer-options" id="answer-options"></div>
        </div>
      `;
      
      const optionsContainer = document.getElementById('answer-options');
      SCALE.forEach(option => {
        const optDiv = document.createElement('div');
        optDiv.className = 'answer-option';
        if (state.answers[q.id] === option.v) {
          optDiv.classList.add('selected');
        }
        optDiv.innerHTML = `
          <div class="option-content">
            <div class="option-label">${option.l}</div>
            <div class="option-sublabel">${option.s}</div>
          </div>
          <div class="option-check">
            <svg class="check-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
              <polyline points="20 6 9 17 4 12"/>
            </svg>
          </div>
        `;
        optDiv.onclick = () => selectAnswer(q.id, option.v);
        optionsContainer.appendChild(optDiv);
      });
      
      // Update nav footer
      document.querySelector('.nav-footer').style.display = 'flex';
      document.getElementById('prev-btn').style.visibility = state.qIdx > 0 ? 'visible' : 'hidden';
      updateNextButton();
    }
    
    function selectAnswer(qId, value) {
      state.answers[qId] = value;
      
      // Visual feedback
      document.querySelectorAll('.answer-option').forEach(opt => {
        opt.classList.remove('selected');
      });
      event.currentTarget.classList.add('selected');
      
      // Auto-advance immediately
      updateNextButton();
      setTimeout(() => {
        if (state.qIdx < QUESTIONS.length - 1) {
          nextQuestion();
        } else {
          showResults();
        }
      }, 0);
    }
    
    function updateNextButton() {
      const nextBtn = document.getElementById('next-btn');
      const currentQ = QUESTIONS[state.qIdx];
      const hasAnswer = state.answers[currentQ.id] !== undefined;
      nextBtn.disabled = !hasAnswer;
      if (state.qIdx === QUESTIONS.length - 1) {
        nextBtn.textContent = 'Voir mes R√©sultats ‚Üí';
      } else {
        nextBtn.textContent = 'Suivant ‚Üí';
      }
    }
    
    function nextQuestion() {
      if (state.qIdx < QUESTIONS.length - 1) {
        state.qIdx++;
        renderQuestion();
      } else {
        showResults();
      }
    }
    
    function prevQuestion() {
      if (state.qIdx > 0) {
        state.qIdx--;
        renderQuestion();
      }
    }
    
    document.getElementById('prev-btn').addEventListener('click', prevQuestion);
    document.getElementById('next-btn').addEventListener('click', () => {
      if (state.qIdx < QUESTIONS.length - 1) {
        nextQuestion();
      } else {
        showResults();
      }
    });
    
    // ============================================
    // CALCUL R√âSULTATS
    // ============================================
    function calculateScores() {
      const dimScores = {};
      let totalScore = 0;
      let maxTotal = 0;
      
      DIMENSIONS.forEach(dim => {
        dimScores[dim.k] = {score: 0, max: 0, percentage: 0, label: dim.fullLabel, color: dim.c};
      });
      
      QUESTIONS.forEach(q => {
        const answer = state.answers[q.id];
        if (answer !== undefined) {
          const value = q.reverse ? (4 - answer) : answer;
          totalScore += value;
          maxTotal += 4;
          dimScores[q.dim].score += value;
          dimScores[q.dim].max += 4;
        }
      });
      
      Object.keys(dimScores).forEach(k => {
        dimScores[k].percentage = Math.round((dimScores[k].score / dimScores[k].max) * 100);
      });
      
      const percentage = Math.round((totalScore / maxTotal) * 100);
      const band = BANDS.find(b => totalScore >= b.min && totalScore <= b.max);
      
      return {
        total: totalScore,
        maxTotal,
        percentage,
        dimensions: dimScores,
        band
      };
    }
    
    // ============================================
    // AFFICHAGE R√âSULTATS
    // ============================================
    function showResults() {
      const scores = calculateScores();
      showScreen('results');
      
      // Date
      const now = new Date();
      document.getElementById('results-date').textContent = `G√©n√©r√© le ${now.toLocaleDateString('fr-FR', {weekday:'long', year:'numeric', month:'long', day:'numeric'})}`;
      
      // Score Circle
      document.getElementById('score-circle').innerHTML = createScoreCircle(scores.total, scores.maxTotal);
      
      // Result Band
      document.getElementById('result-band').innerHTML = `
        <div class="result-band" style="background: ${scores.band.color}15; border-left: 4px solid ${scores.band.color};">
          <h3 style="color: ${scores.band.color};">${scores.band.level}</h3>
          <p>${scores.band.text}</p>
        </div>
      `;
      
      // Dimension Bars
      const dimBarsHtml = Object.entries(scores.dimensions)
        .sort((a,b) => b[1].percentage - a[1].percentage)
        .map(([key, data]) => `
          <div class="dimension-bar-item">
            <div class="dimension-bar-label">${data.label}</div>
            <div class="dimension-bar-track">
              <div class="dimension-bar-fill" style="width: ${data.percentage}%; background: ${data.color};">
                <span class="dimension-bar-value">${data.percentage}%</span>
              </div>
            </div>
          </div>
        `).join('');
      document.getElementById('dimension-bars').innerHTML = dimBarsHtml;
      
      // Profile Summary
      const typeLabels = {
        romantic: "Relation amoureuse / Couple",
        family: "Relation familiale",
        friend: "Relation amicale",
        professional: "Relation professionnelle",
        other: "Autre"
      };
      const durLabels = {
        '<6m': "Moins de 6 mois",
        '6m-1y': "6 mois √† 1 an",
        '1-2y': "1 √† 2 ans",
        '2-5y': "2 √† 5 ans",
        '>5y': "Plus de 5 ans"
      };
      document.getElementById('profile-summary').innerHTML = `
        <p><strong>Type de relation :</strong> ${typeLabels[state.anamnesis.type] || 'Non sp√©cifi√©'}</p>
        <p><strong>Dur√©e :</strong> ${durLabels[state.anamnesis.dur] || 'Non sp√©cifi√©e'}</p>
        <p><strong>Score global :</strong> ${scores.total}/${scores.maxTotal} (${scores.percentage}%)</p>
      `;
      
      // Recommendations
      const recs = generateRecommendations(scores);
      document.getElementById('recommendations').innerHTML = `<ol>${recs.map(r => `<li>${r}</li>`).join('')}</ol>`;
      
      // Export Buttons
      document.getElementById('pdf-btn').onclick = () => generatePDF(scores);
      document.getElementById('email-btn').onclick = () => generateEmail(scores);
      document.getElementById('json-btn').onclick = () => exportJSON(scores);
      document.getElementById('reset-btn').onclick = () => location.reload();
    }
    
    function createScoreCircle(score, max) {
      const percentage = Math.round((score / max) * 100);
      const radius = 100;
      const circumference = 2 * Math.PI * radius;
      const offset = circumference - (percentage / 100) * circumference;
      
      return `
        <svg width="260" height="260" style="transform: rotate(-90deg);">
          <circle cx="130" cy="130" r="${radius}" fill="none" stroke="#F7F5EF" stroke-width="16"/>
          <circle cx="130" cy="130" r="${radius}" fill="none" stroke="#C7A86D" stroke-width="16" 
                  stroke-dasharray="${circumference}" stroke-dashoffset="${offset}"
                  stroke-linecap="round" style="transition: stroke-dashoffset 1s cubic-bezier(0.16, 1, 0.3, 1);"/>
          <text x="130" y="115" text-anchor="middle" font-family="Fraunces, serif" font-size="48" font-weight="700" fill="#0A0A0A" transform="rotate(90 130 130)">${score}</text>
          <text x="130" y="145" text-anchor="middle" font-family="Inter, sans-serif" font-size="16" fill="rgba(10,10,10,0.6)" transform="rotate(90 130 130)">sur ${max}</text>
          <text x="130" y="165" text-anchor="middle" font-family="Inter, sans-serif" font-size="20" font-weight="600" fill="#C7A86D" transform="rotate(90 130 130)">${percentage}%</text>
        </svg>
      `;
    }
    
    function generateRecommendations(scores) {
      const recs = [];
      const pct = scores.percentage;
      
      if (pct >= 70) {
        recs.push("<strong>PRIORIT√â URGENTE :</strong> Consultation avec un psychologue sp√©cialis√© en trauma relationnel recommand√©e imm√©diatement.");
        recs.push("R√©duire drastiquement les interactions avec cette personne. Envisager une distanciation temporaire ou permanente.");
        recs.push("Solliciter votre r√©seau de soutien (proches de confiance, associations sp√©cialis√©es).");
      } else if (pct >= 45) {
        recs.push("Consultation psychologique recommand√©e pour √©valuer l'impact et d√©velopper des strat√©gies de protection.");
        recs.push("√âtablir des fronti√®res claires et explicites. R√©duire la disponibilit√© √©motionnelle et temporelle.");
        recs.push("Documenter les patterns toxiques observ√©s pour clarifier la situation.");
      } else {
        recs.push("Rester vigilant¬∑e sur l'√©volution de la dynamique relationnelle.");
        recs.push("Renforcer les limites personnelles d√®s les premiers signes d'inconfort.");
        recs.push("Consulter si la situation √©volue n√©gativement ou si l'√©puisement persiste.");
      }
      
      // Dimension-specific
      const highDims = Object.entries(scores.dimensions)
        .filter(([k,v]) => v.percentage >= 60)
        .sort((a,b) => b[1].percentage - a[1].percentage);
      
      if (highDims.length > 0) {
        recs.push(`<strong>Dimension pr√©dominante :</strong> ${highDims[0][1].label} (${highDims[0][1].percentage}%). Focus sur cette dimension en priorit√©.`);
      }
      
      return recs;
    }
    
    // ============================================
    // EXPORT PDF
    // ============================================
    function generatePDF(scores) {
      const printWindow = window.open('', '', 'width=800,height=600');
      printWindow.document.write(`
        <!DOCTYPE html>
        <html lang="fr">
        <head>
          <meta charset="UTF-8">
          <title>Rapport Vampires √ânerg√©tiques,${state.anamnesis.name},NO√âSIS</title>
          <style>
            @page { size: A4; margin: 2.5cm; }
            body { font-family: 'Inter', Arial, sans-serif; font-size: 10pt; line-height: 1.5; color: #0A0A0A; }
            h1, h2 { font-family: 'Fraunces', Georgia, serif; page-break-after: avoid; }
            h1 { font-size: 24pt; margin-bottom: 6pt; text-align: center; }
            h2 { font-size: 16pt; margin-top: 16pt; margin-bottom: 8pt; border-bottom: 2px solid #C7A86D; padding-bottom: 4pt; }
            .section { page-break-inside: avoid; margin-bottom: 16pt; }
            .score-box { background: #F7F5EF; padding: 12pt; border-radius: 8pt; text-align: center; margin: 16pt 0; }
            .score-number { font-size: 36pt; font-weight: bold; color: #C7A86D; }
            table { width: 100%; border-collapse: collapse; margin: 12pt 0; }
            td, th { padding: 6pt; text-align: left; border-bottom: 1px solid #ddd; }
            th { background: #F7F5EF; font-weight: 600; }
            .warning { background: #fffbeb; border-left: 4pt solid #C7A86D; padding: 8pt; margin: 12pt 0; }
            .footer { margin-top: 24pt; padding-top: 12pt; border-top: 2px solid #C7A86D; font-size: 8pt; color: #666; text-align: center; }
          </style>
        </head>
        <body>
          <div style="text-align: center; margin-bottom: 24pt;">
            <h1>VAMPIRES √âNERG√âTIQUES</h1>
            <p style="font-size: 11pt; color: #666;">Typologie Relationnelle,Rapport d'Auto-√âvaluation</p>
            <p style="font-size: 10pt; margin-top: 8pt;"><strong>Participant :</strong> ${state.anamnesis.name}</p>
            <p style="font-size: 10pt;"><strong>Date :</strong> ${new Date().toLocaleDateString('fr-FR', {year:'numeric', month:'long', day:'numeric'})}</p>
          </div>
          
          <div class="section">
            <h2>Synth√®se Ex√©cutive</h2>
            <div class="score-box">
              <div class="score-number">${scores.total}/${scores.maxTotal}</div>
              <div style="font-size: 14pt; margin-top: 8pt;">${scores.percentage}%,${scores.band.level}</div>
            </div>
            <p>${scores.band.text}</p>
          </div>
          
          <div class="section">
            <h2>Analyse Dimensionnelle</h2>
            <table>
              <tr><th>Dimension</th><th>Score</th><th>Pourcentage</th></tr>
              ${Object.entries(scores.dimensions).sort((a,b) => b[1].percentage - a[1].percentage).map(([k,v]) => `
                <tr><td>${v.label}</td><td>${v.score}/${v.max}</td><td><strong>${v.percentage}%</strong></td></tr>
              `).join('')}
            </table>
          </div>
          
          <div class="section">
            <h2>Profil Contextuel</h2>
            <p><strong>Type de relation :</strong> ${state.anamnesis.type || 'Non sp√©cifi√©'}</p>
            <p><strong>Dur√©e approximative :</strong> ${state.anamnesis.dur || 'Non sp√©cifi√©e'}</p>
          </div>
          
          <div class="section">
            <h2>Recommandations Personnalis√©es</h2>
            <ol>${generateRecommendations(scores).map(r => `<li>${r}</li>`).join('')}</ol>
          </div>
          
          <div class="section">
            <h2>D√©tail des R√©ponses</h2>
            ${DIMENSIONS.map(dim => `
              <h3 style="font-size: 12pt; margin-top: 12pt; color: ${dim.c};">${dim.fullLabel}</h3>
              <ul style="margin-left: 16pt;">
                ${QUESTIONS.filter(q => q.dim === dim.k).map(q => {
                  const ans = state.answers[q.id];
                  const opt = SCALE.find(s => s.v === ans);
                  return `<li style="margin-bottom: 6pt;"><strong>${q.text}</strong><br><em>R√©ponse : ${opt.l} (${opt.v})</em></li>`;
                }).join('')}
              </ul>
            `).join('')}
          </div>
          
          <div class="warning">
            <h3 style="font-size: 12pt; margin-bottom: 6pt;">‚ö† Avertissement Important</h3>
            <p>Ce questionnaire constitue un outil de sensibilisation et ne remplace en aucun cas une consultation avec un professionnel qualifi√©. Les r√©sultats refl√®tent votre perception subjective et n√©cessitent interpr√©tation contextuelle.</p>
            <p><strong>Ressources :</strong> 3919 (Violences Femmes Info) ‚Ä¢ 119 (Enfance en Danger) ‚Ä¢ 3114 (Pr√©vention Suicide)</p>
          </div>
          
          <div class="footer">
            <p><strong>NO√âSIS</strong>,Intelligence transdisciplinaire au service de la lucidit√©</p>
            <p>¬© ${new Date().getFullYear()} NO√âSIS,Tous droits r√©serv√©s</p>
            <p>Outil de sensibilisation non diagnostique ‚Ä¢ Confidentialit√© : aucune collecte sans action explicite</p>
          </div>
        </body>
        </html>
      `);
      printWindow.document.close();
      setTimeout(() => printWindow.print(), 800);
    }
    
    // ============================================
    // EXPORT EMAIL
    // ============================================
    function generateEmail(scores) {
      const body = `
RAPPORT NO√âSIS,VAMPIRES √âNERG√âTIQUES
Participant : ${state.anamnesis.name}
G√©n√©r√© le ${new Date().toLocaleDateString('fr-FR')}

SCORE TOTAL : ${scores.total}/${scores.maxTotal} (${scores.percentage}%)
NIVEAU : ${scores.band.level}

ANALYSE DIMENSIONNELLE :
${Object.entries(scores.dimensions).sort((a,b) => b[1].percentage - a[1].percentage).map(([k,v]) => `‚Ä¢ ${v.label} : ${v.percentage}%`).join('\n')}

PROFIL :
‚Ä¢ Type : ${state.anamnesis.type || 'Non sp√©cifi√©'}
‚Ä¢ Dur√©e : ${state.anamnesis.dur || 'Non sp√©cifi√©e'}

Pour consulter le rapport complet avec analyses approfondies, recommandations personnalis√©es et d√©tail des r√©ponses, veuillez t√©l√©charger la version PDF depuis l'interface NO√âSIS.

---
NO√âSIS,Intelligence transdisciplinaire
¬© ${new Date().getFullYear()},Tous droits r√©serv√©s
      `.trim();
      
      window.location.href = `mailto:?subject=${encodeURIComponent('Rapport Vampires √ânerg√©tiques,' + state.anamnesis.name + ',NO√âSIS')}&body=${encodeURIComponent(body)}`;
    }
    
    // ============================================
    // EXPORT JSON
    // ============================================
    function exportJSON(scores) {
      const data = {
        metadata: {
          test: "Vampires √ânerg√©tiques,Typologie Relationnelle",
          version: "2.0 - NO√âSIS",
          date: new Date().toISOString(),
          participant: state.anamnesis.name
        },
        anamnesis: state.anamnesis,
        responses: {
          answers: state.answers,
          completion: `${Object.keys(state.answers).length}/${QUESTIONS.length}`
        },
        scoring: {
          total: scores.total,
          maxTotal: scores.maxTotal,
          percentage: scores.percentage,
          dimensions: scores.dimensions,
          resultBand: scores.band
        },
        detailedResponses: QUESTIONS.map(q => ({
          id: q.id,
          dimension: q.dim,
          text: q.text,
          response: {
            value: state.answers[q.id],
            label: SCALE.find(s => s.v === state.answers[q.id])?.l,
            sublabel: SCALE.find(s => s.v === state.answers[q.id])?.s
          }
        }))
      };
      
      const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `vampires-energetiques-${state.anamnesis.name}-${Date.now()}.json`;
      a.click();
      URL.revokeObjectURL(url);
    }
  </script>
  
</body>
</html>