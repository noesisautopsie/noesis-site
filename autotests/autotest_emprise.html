<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Auto-Test Emprise & Contrôle Coercitif | NOÉSIS</title>
  <meta name="description" content="Évaluation approfondie des dynamiques d'emprise et de contrôle coercitif. Outil non diagnostique orienté vers la prise de conscience.">
  <meta name="test-version" content="1.0.0">
  <meta name="test-last-updated" content="2025-11-10">
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@300;400;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <style>

    /* ========================================
       VARIABLES CSS NOÉSIS
       ======================================== */
    :root {
      /* Fondations Neutres */
      --noir-absolu: #0A0A0A;
      --noir-doux: #111111;
      --noir-surface: #1A1A1A;
      --creme-principal: #F7F5EF;
      --creme-chaud: #F9F7F1;
      --blanc-surface: #FFFFFF;
      
      /* Signature Or NOÉSIS */
      --or-signature: #C7A86D;
      --or-riche: #D4B980;
      --or-sombre: #A89158;
      --or-subtil: rgba(199,168,109,0.08);
      --or-leger: rgba(199,168,109,0.15);
      --or-moyen: rgba(199,168,109,0.25);
      
      /* Bordures & Séparateurs */
      --border-subtil: rgba(10,10,10,0.08);
      --border-leger: rgba(10,10,10,0.12);
      --border-visible: rgba(10,10,10,0.18);
      
      /* Couleurs Dimensionnelles (TDAH) */
      --axe-a-color: #2563eb;
      --axe-a-bg: rgba(37,99,235,0.08);
      --axe-b-color: #dc2626;
      --axe-b-bg: rgba(220,38,38,0.08);
      --axe-c-color: #7c3aed;
      --axe-c-bg: rgba(124,58,237,0.08);
      --axe-d-color: #ea580c;
      --axe-d-bg: rgba(234,88,12,0.08);
      --axe-e-color: #0891b2;
      --axe-e-bg: rgba(8,145,178,0.08);
      
      /* Typographie */
      --fs-xs: 12px;   --fs-sm: 14px;   --fs-md: 18px;
      --fs-lg: 21px;   --fs-xl: 24px;   --fs-2xl: 32px;
      --fs-3xl: 42px;  --fs-4xl: 56px;
      --lh-tight: 1.2; --lh-normal: 1.5; --lh-relaxed: 1.7;
      
      /* Spacing (Échelle 8px) */
      --s-2: 8px;    --s-3: 12px;   --s-4: 16px;
      --s-6: 24px;   --s-8: 32px;   --s-12: 48px;
      --s-16: 64px;  --s-20: 80px;
      
      /* Ombres & Élévations */
      --shadow-soft: 0 2px 8px rgba(10,10,10,0.08), 0 1px 2px rgba(10,10,10,0.12);
      --shadow-medium: 0 4px 16px rgba(10,10,10,0.1), 0 2px 4px rgba(10,10,10,0.15);
      --shadow-large: 0 8px 32px rgba(10,10,10,0.12), 0 2px 8px rgba(10,10,10,0.18);
      
      /* Border Radius */
      --radius-sm: 4px;   --radius-md: 8px;   --radius-lg: 12px;
      --radius-xl: 16px;  --radius-2xl: 24px; --radius-pill: 9999px;
      
      /* Animations */
      --duration-fast: 150ms;
      --duration-normal: 250ms;
      --duration-slow: 350ms;
      --ease-standard: cubic-bezier(0.4, 0.0, 0.2, 1);
      --ease-spring: cubic-bezier(0.16, 1, 0.3, 1);
    }
    
    /* ========================================
       RESET & BASE
       ======================================== */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      font-size: var(--fs-md);
      line-height: var(--lh-relaxed);
      color: var(--noir-absolu);
      background: var(--creme-principal);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    
    h1, h2, h3 {
      font-family: 'Fraunces', Georgia, serif;
      font-weight: 600;
      line-height: var(--lh-tight);
      color: var(--noir-absolu);
    }
    
    h1 { font-size: var(--fs-3xl); }
    h2 { font-size: var(--fs-2xl); }
    h3 { font-size: var(--fs-xl); }
    
    p {
      margin-bottom: var(--s-4);
    }
    
    strong {
      font-weight: 600;
      color: var(--noir-absolu);
    }
    
    /* ========================================
       LAYOUT
       ======================================== */
    .app-container {
      max-width: 900px;
      margin: 0 auto;
      padding: var(--s-12) var(--s-6);
    }
    
    .screen {
      display: none;
      opacity: 0;
    }
    
    .screen.active {
      display: block;
      animation: fadeIn var(--duration-normal) var(--ease-standard) forwards;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(8px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* ========================================
       COMPOSANTS,CARTES
       ======================================== */
    .card {
      background: var(--blanc-surface);
      border-radius: var(--radius-2xl);
      padding: var(--s-12);
      margin-bottom: var(--s-8);
      box-shadow: var(--shadow-large);
    }
    
    .card h2, .card h3 {
      margin-bottom: var(--s-6);
      display: flex;
      align-items: center;
      gap: var(--s-3);
    }
    
    .card-icon {
      width: 24px;
      height: 24px;
      stroke: var(--or-signature);
      fill: none;
      stroke-width: 2;
      stroke-linecap: round;
      stroke-linejoin: round;
    }
    
    /* ========================================
       COMPOSANTS,WARNING BOX
       ======================================== */
    .warning-box {
      background: #fffbeb;
      border-left: 4px solid var(--or-signature);
      border-radius: var(--radius-md);
      padding: var(--s-6);
      margin-bottom: var(--s-8);
    }
    
    .warning-box h3 {
      font-size: var(--fs-lg);
      margin-bottom: var(--s-3);
      display: flex;
      align-items: center;
      gap: var(--s-2);
      color: var(--noir-absolu);
    }
    
    .warning-box p {
      font-size: var(--fs-sm);
      line-height: var(--lh-relaxed);
      color: rgba(10,10,10,0.75);
      margin-bottom: var(--s-3);
    }
    
    .warning-box p:last-child {
      margin-bottom: 0;
    }
    
    .warning-box ul {
      margin-left: var(--s-6);
      margin-top: var(--s-3);
    }
    
    .warning-box li {
      font-size: var(--fs-sm);
      line-height: var(--lh-relaxed);
      color: rgba(10,10,10,0.75);
      margin-bottom: var(--s-2);
    }
    
    .warning-icon {
      width: 20px;
      height: 20px;
      stroke: var(--or-signature);
      fill: none;
      stroke-width: 2;
    }
    
    /* ========================================
       COMPOSANTS,HEADER
       ======================================== */
    .header {
      text-align: center;
      margin-bottom: var(--s-12);
    }
    
    .header-icon {
      width: 80px;
      height: 80px;
      margin: 0 auto var(--s-4);
      background: linear-gradient(135deg, var(--or-signature), var(--or-riche));
      border-radius: var(--radius-xl);
      border: 3px solid var(--or-signature);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: var(--shadow-medium);
    }
    
    .header-icon svg {
      width: 40px;
      height: 40px;
      stroke: var(--blanc-surface);
      fill: none;
      stroke-width: 2.5;
      stroke-linecap: round;
      stroke-linejoin: round;
    }
    
    .header h1 {
      margin-bottom: var(--s-2);
    }
    
    .header-subtitle {
      font-size: var(--fs-md);
      color: var(--noir-doux);
      opacity: 0.8;
    }
    
    /* ========================================
       COMPOSANTS,FORMULAIRES
       ======================================== */
    .form-group {
      margin-bottom: var(--s-6);
    }
    
    .form-group label {
      display: block;
      font-weight: 600;
      font-size: var(--fs-md);
      margin-bottom: var(--s-3);
      color: var(--noir-absolu);
    }
    
    .form-group input,
    .form-group select {
      width: 100%;
      padding: var(--s-4);
      border: 2px solid var(--border-leger);
      border-radius: var(--radius-md);
      font-size: var(--fs-md);
      font-family: 'Inter', sans-serif;
      background: var(--blanc-surface);
      color: var(--noir-absolu);
      transition: all var(--duration-normal) var(--ease-standard);
    }
    
    .form-group input:focus,
    .form-group select:focus {
      outline: none;
      border-color: var(--or-signature);
      box-shadow: 0 0 0 3px var(--or-subtil);
    }
    
    .checkbox-container {
      display: flex;
      align-items: flex-start;
      gap: var(--s-3);
      cursor: pointer;
      padding: var(--s-4);
      border: 2px solid var(--border-leger);
      border-radius: var(--radius-md);
      background: var(--blanc-surface);
      transition: all var(--duration-normal) var(--ease-standard);
    }
    
    .checkbox-container:hover {
      border-color: var(--or-signature);
      background: var(--or-subtil);
    }
    
    .checkbox-container input[type="checkbox"] {
      width: 20px;
      height: 20px;
      margin-top: 2px;
      cursor: pointer;
      accent-color: var(--or-signature);
    }
    
    .checkbox-label {
      font-size: var(--fs-md);
      line-height: var(--lh-relaxed);
      color: var(--noir-absolu);
    }
    
    /* ========================================
       COMPOSANTS,BOUTONS
       ======================================== */
    .btn-primary {
      background: var(--or-signature);
      color: var(--blanc-surface);
      font-weight: 600;
      font-size: var(--fs-md);
      padding: var(--s-4) var(--s-8);
      border: none;
      border-radius: var(--radius-md);
      cursor: pointer;
      font-family: 'Inter', sans-serif;
      transition: all var(--duration-normal) var(--ease-standard);
      box-shadow: var(--shadow-soft);
    }
    
    .btn-primary:hover:not(:disabled) {
      background: var(--or-riche);
      transform: translateY(-2px);
      box-shadow: var(--shadow-medium);
    }
    
    .btn-primary:disabled {
      opacity: 0.4;
      cursor: not-allowed;
      transform: none;
    }
    
    .btn-secondary {
      background: transparent;
      color: var(--or-signature);
      font-weight: 600;
      font-size: var(--fs-md);
      padding: var(--s-4) var(--s-8);
      border: 2px solid var(--or-signature);
      border-radius: var(--radius-md);
      cursor: pointer;
      font-family: 'Inter', sans-serif;
      transition: all var(--duration-normal) var(--ease-standard);
    }
    
    .btn-secondary:hover {
      background: var(--or-subtil);
      transform: translateY(-2px);
    }
    
    .btn-group {
      display: flex;
      gap: var(--s-4);
      flex-wrap: wrap;
      justify-content: center;
      margin-top: var(--s-6);
    }
    
    /* ========================================
       COMPOSANTS,BARRE DE PROGRESSION
       ======================================== */
    .progress-container {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: var(--blanc-surface);
      padding: var(--s-4) var(--s-6);
      box-shadow: var(--shadow-soft);
      z-index: 1000;
      display: none;
    }
    
    .progress-container.active {
      display: block;
    }
    
    .progress-text {
      font-size: var(--fs-sm);
      font-weight: 500;
      color: var(--noir-doux);
      text-align: center;
      margin-bottom: var(--s-2);
    }
    
    .progress-bar {
      height: 4px;
      background: var(--creme-principal);
      border-radius: var(--radius-pill);
      overflow: hidden;
    }
    
    .progress-fill {
      height: 100%;
      background: var(--or-signature);
      transition: width var(--duration-slow) var(--ease-spring);
      width: 0%;
    }
    
    /* ========================================
       COMPOSANTS,QUESTIONS
       ======================================== */
    .question-container {
      margin-top: var(--s-20);
      min-height: 60vh;
    }
    
    .question-card {
      background: var(--blanc-surface);
      border-radius: var(--radius-2xl);
      padding: var(--s-12);
      box-shadow: var(--shadow-large);
    }
    
    .dimension-badge {
      display: inline-block;
      padding: var(--s-2) var(--s-4);
      border-radius: var(--radius-pill);
      font-size: var(--fs-sm);
      font-weight: 600;
      margin-bottom: var(--s-6);
    }
    
    .dimension-badge.axe-a {
      background: var(--inattention-bg);
      color: var(--inattention-color);
      border: 1px solid var(--inattention-color);
    }
    
    .dimension-badge.axe-b {
      background: var(--hyperactivite-bg);
      color: var(--hyperactivite-color);
      border: 1px solid var(--hyperactivite-color);
    }
    
    .dimension-badge.axe-c {
      background: var(--executif-bg);
      color: var(--executif-color);
      border: 1px solid var(--executif-color);
    }
    
    .dimension-badge.axe-d {
      background: var(--emotion-bg);
      color: var(--emotion-color);
      border: 1px solid var(--emotion-color);
    }
    
    .dimension-badge.axe-e {
      background: var(--impact-bg);
      color: var(--impact-color);
      border: 1px solid var(--impact-color);
    }
    
    .question-number {
      font-size: var(--fs-sm);
      font-weight: 500;
      color: var(--noir-doux);
      margin-bottom: var(--s-2);
    }
    
    .question-text {
      font-size: var(--fs-lg);
      font-weight: 500;
      line-height: var(--lh-relaxed);
      margin-bottom: var(--s-8);
      color: var(--noir-absolu);
    }
    
    .answer-options {
      display: flex;
      flex-direction: column;
      gap: var(--s-3);
    }
    
    .answer-option {
      background: var(--blanc-surface);
      border: 2px solid var(--border-leger);
      border-radius: var(--radius-md);
      padding: var(--s-4);
      cursor: pointer;
      transition: all var(--duration-normal) var(--ease-standard);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .answer-option:hover {
      border-color: var(--border-visible);
      transform: translateX(4px);
      box-shadow: var(--shadow-soft);
    }
    
    .answer-option.selected {
      background: var(--or-subtil);
      border-color: var(--or-signature);
      transform: scale(1.02);
    }
    
    .option-content {
      flex: 1;
    }
    
    .option-label {
      font-size: var(--fs-md);
      font-weight: 600;
      margin-bottom: var(--s-2);
      color: var(--noir-absolu);
    }
    
    .option-sublabel {
      font-size: var(--fs-sm);
      color: var(--noir-doux);
    }
    
    .option-check {
      width: 24px;
      height: 24px;
      border-radius: var(--radius-pill);
      border: 2px solid var(--border-visible);
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all var(--duration-normal) var(--ease-standard);
    }
    
    .answer-option.selected .option-check {
      background: var(--or-signature);
      border-color: var(--or-signature);
    }
    
    .check-icon {
      width: 16px;
      height: 16px;
      stroke: var(--blanc-surface);
      stroke-width: 3;
      opacity: 0;
      transition: opacity var(--duration-fast) var(--ease-standard);
    }
    
    .answer-option.selected .check-icon {
      opacity: 1;
    }
    
    .navigation-buttons {
      display: flex;
      justify-content: space-between;
      gap: var(--s-4);
      margin-top: var(--s-8);
    }
    
    /* ========================================
       COMPOSANTS,RÉSULTATS
       ======================================== */
    .result-summary {
      text-align: center;
      padding: var(--s-12);
      background: var(--blanc-surface);
      border-radius: var(--radius-2xl);
      margin-bottom: var(--s-8);
      box-shadow: var(--shadow-large);
    }
    
    .result-icon {
      width: 64px;
      height: 64px;
      margin: 0 auto var(--s-6);
      background: linear-gradient(135deg, var(--or-signature), var(--or-riche));
      border-radius: var(--radius-xl);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: var(--shadow-medium);
    }
    
    .result-icon svg {
      width: 32px;
      height: 32px;
      stroke: var(--blanc-surface);
      fill: none;
      stroke-width: 2.5;
    }
    
    .result-score {
      font-size: var(--fs-4xl);
      font-weight: 700;
      font-family: 'Fraunces', serif;
      margin-bottom: var(--s-2);
      color: var(--noir-absolu);
    }
    
    .result-max {
      font-size: var(--fs-xl);
      color: var(--noir-doux);
      margin-bottom: var(--s-6);
    }
    
    .result-band {
      display: inline-block;
      padding: var(--s-3) var(--s-6);
      border-radius: var(--radius-pill);
      font-size: var(--fs-lg);
      font-weight: 600;
      margin-bottom: var(--s-4);
    }
    
    .result-interpretation {
      font-size: var(--fs-md);
      line-height: var(--lh-relaxed);
      color: var(--noir-doux);
      max-width: 600px;
      margin: 0 auto;
    }
    
    .dimensions-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: var(--s-6);
      margin-bottom: var(--s-8);
    }
    
    .dimension-card {
      background: var(--blanc-surface);
      border-radius: var(--radius-xl);
      padding: var(--s-6);
      box-shadow: var(--shadow-medium);
      border-left: 4px solid;
    }
    
    .dimension-card.axe-a {
      border-color: var(--inattention-color);
    }
    
    .dimension-card.axe-b {
      border-color: var(--hyperactivite-color);
    }
    
    .dimension-card.axe-c {
      border-color: var(--executif-color);
    }
    
    .dimension-card.axe-d {
      border-color: var(--emotion-color);
    }
    
    .dimension-card.axe-e {
      border-color: var(--impact-color);
    }
    
    .dimension-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--s-3);
    }
    
    .dimension-name {
      font-size: var(--fs-lg);
      font-weight: 600;
      color: var(--noir-absolu);
    }
    
    .dimension-score {
      font-size: var(--fs-xl);
      font-weight: 700;
      font-family: 'Fraunces', serif;
    }
    
    .dimension-bar {
      height: 6px;
      background: var(--creme-principal);
      border-radius: var(--radius-pill);
      overflow: hidden;
      margin-bottom: var(--s-3);
    }
    
    .dimension-bar-fill {
      height: 100%;
      border-radius: var(--radius-pill);
      transition: width var(--duration-slow) var(--ease-spring);
    }
    
    .dimension-card.axe-a .dimension-bar-fill {
      background: var(--inattention-color);
    }
    
    .dimension-card.axe-b .dimension-bar-fill {
      background: var(--hyperactivite-color);
    }
    
    .dimension-card.axe-c .dimension-bar-fill {
      background: var(--executif-color);
    }
    
    .dimension-card.axe-d .dimension-bar-fill {
      background: var(--emotion-color);
    }
    
    .dimension-card.axe-e .dimension-bar-fill {
      background: var(--impact-color);
    }
    
    .dimension-level {
      font-size: var(--fs-sm);
      font-weight: 600;
      color: var(--noir-doux);
    }
    
    .recommendations-list {
      background: var(--blanc-surface);
      border-radius: var(--radius-xl);
      padding: var(--s-8);
      margin-bottom: var(--s-8);
      box-shadow: var(--shadow-medium);
    }
    
    .recommendations-list h3 {
      margin-bottom: var(--s-6);
    }
    
    .recommendation-item {
      padding: var(--s-4);
      margin-bottom: var(--s-4);
      border-left: 3px solid var(--or-signature);
      background: var(--or-subtil);
      border-radius: var(--radius-md);
    }
    
    .recommendation-item:last-child {
      margin-bottom: 0;
    }
    
    .recommendation-title {
      font-weight: 600;
      font-size: var(--fs-md);
      margin-bottom: var(--s-2);
      color: var(--noir-absolu);
    }
    
    .recommendation-text {
      font-size: var(--fs-sm);
      line-height: var(--lh-relaxed);
      color: var(--noir-doux);
      margin-bottom: 0;
    }
    
    /* ========================================
       COMPOSANTS,FOOTER
       ======================================== */
    .footer {
      text-align: center;
      padding: var(--s-8) var(--s-6);
      margin-top: var(--s-12);
      border-top: 1px solid var(--border-leger);
    }
    
    .footer p {
      font-size: var(--fs-sm);
      color: var(--noir-doux);
      margin-bottom: var(--s-2);
    }
    
    .footer p:last-child {
      margin-bottom: 0;
    }
    
    /* ========================================
       PRINT STYLES
       ======================================== */
    @media print {
      body {
        background: white;
        font-size: 12pt;
        line-height: 1.5;
      }
      
      .app-container {
        max-width: 100%;
        padding: 0;
      }
      
      .card, .result-summary, .dimension-card {
        box-shadow: none;
        page-break-inside: avoid;
      }
      
      .btn-primary, .btn-secondary, .btn-group {
        display: none;
      }
      
      .progress-container {
        display: none;
      }
      
      h1, h2, h3 {
        page-break-after: avoid;
      }
      
      .section {
        page-break-inside: avoid;
      }
      
      table {
        width: 100%;
        border-collapse: collapse;
      }
      
      th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;
      }
      
      th {
        background-color: #f5f5f5;
      }
    }
    
    /* ========================================
       RESPONSIVE
       ======================================== */
    @media (max-width: 768px) {
      :root {
        --fs-3xl: 32px;
        --fs-2xl: 24px;
        --fs-xl: 21px;
        --fs-lg: 18px;
      }
      
      .app-container {
        padding: var(--s-8) var(--s-4);
      }
      
      .card, .question-card, .result-summary {
        padding: var(--s-8);
      }
      
      .dimensions-grid {
        grid-template-columns: 1fr;
      }
      
      .btn-group {
        flex-direction: column;
      }
      
      .btn-primary, .btn-secondary {
        width: 100%;
      }
      
      .navigation-buttons {
        flex-direction: column-reverse;
      }
    }
  
      --axe-f-color: #65a30d;
      --axe-f-bg: rgba(101,163,13,0.08);

  </style>
</head>
<body>
  <div class="app-container">
    
    <!-- ÉCRAN INTRODUCTION -->
    <div id="intro-screen" class="screen active">
      <div class="header">
        <div class="header-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M12 2a10 10 0 1 0 0 20 10 10 0 1 0 0-20z"/>
            <path d="M12 6v6l4 2"/>
            <circle cx="12" cy="12" r="1"/>
          </svg>
        </div>
        <h1>Auto-Test Emprise & Contrôle Coercitif</h1>
        <p class="header-subtitle">Évaluation approfondie des dynamiques d'emprise psychologique</p>
      </div>

      <!-- Warning Box -->
      <div class="card warning-box">
        <h2>
          <svg class="card-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
            <line x1="12" y1="9" x2="12" y2="13"/>
            <line x1="12" y1="17" x2="12.01" y2="17"/>
          </svg>
          Avertissement Étape Zéro,Sécurité & Limites
        </h2>
        <p><strong>Cet outil constitue un questionnaire d'orientation et de sensibilisation.</strong> Il ne remplace en aucun cas une consultation avec un professionnel qualifié (psychologue, psychiatre, avocat spécialisé).</p>
        <p><strong>Sécurité prioritaire :</strong> En danger immédiat, contactez le <strong>17</strong> ou le <strong>112</strong>. Ressources d'urgence : <strong>3919</strong> (Violences Femmes Info, 24/7), <strong>3114</strong> (Prévention Suicide), <strong>119</strong> (Enfance en Danger), <strong>114</strong> (Urgence SMS).</p>
        <p><strong>Confidentialité :</strong> Aucune donnée n'est collectée ou transmise. Traitement 100% local dans votre navigateur. Suppression automatique à la fermeture.</p>
      </div>

      <!-- Dimensions Évaluées -->
      <div class="card">
        <h2>
          <svg class="card-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <rect x="3" y="3" width="7" height="7"/>
            <rect x="14" y="3" width="7" height="7"/>
            <rect x="14" y="14" width="7" height="7"/>
            <rect x="3" y="14" width="7" height="7"/>
          </svg>
          Dimensions Évaluées
        </h2>
        <p>Ce questionnaire évalue <strong>six dimensions cliniques</strong> de l'emprise et du contrôle coercitif selon une approche transdisciplinaire intégrant criminologie, neuropsychologie du trauma et sciences sociales.</p>
        
        <div class="dimensions-grid" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--s-6); margin-top: var(--s-8);">
          
          <div style="background: var(--axe-a-bg); border-left: 4px solid var(--axe-a-color); padding: var(--s-6); border-radius: var(--radius-md);">
            <div style="font-size: var(--fs-3xl); font-weight: 300; color: var(--axe-a-color); opacity: 0.3; margin-bottom: var(--s-3);">01</div>
            <h3 style="margin-bottom: var(--s-3); color: var(--axe-a-color);">Tactiques d'Emprise Directe</h3>
            <p style="font-size: var(--fs-sm); margin: 0;">Alternance séduction/punition, gaslighting, surveillance, contrôle comportemental, ultimatums. <strong>16 items</strong></p>
          </div>

          <div style="background: var(--axe-b-bg); border-left: 4px solid var(--axe-b-color); padding: var(--s-6); border-radius: var(--radius-md);">
            <div style="font-size: var(--fs-3xl); font-weight: 300; color: var(--axe-b-color); opacity: 0.3; margin-bottom: var(--s-3);">02</div>
            <h3 style="margin-bottom: var(--s-3); color: var(--axe-b-color);">Effets Neuro-Psychologiques</h3>
            <p style="font-size: var(--fs-sm); margin: 0;">Hypervigilance, troubles du sommeil, mémoire altérée, dissociation, épuisement décisionnel. <strong>14 items</strong></p>
          </div>

          <div style="background: var(--axe-c-bg); border-left: 4px solid var(--axe-c-color); padding: var(--s-6); border-radius: var(--radius-md);">
            <div style="font-size: var(--fs-3xl); font-weight: 300; color: var(--axe-c-color); opacity: 0.3; margin-bottom: var(--s-3);">03</div>
            <h3 style="margin-bottom: var(--s-3); color: var(--axe-c-color);">Isolement & Dépendances</h3>
            <p style="font-size: var(--fs-sm); margin: 0;">Coupure des soutiens, contrôle financier, sabotage professionnel, empêchement d'accès aux soins. <strong>12 items</strong></p>
          </div>

          <div style="background: var(--axe-d-bg); border-left: 4px solid var(--axe-d-color); padding: var(--s-6); border-radius: var(--radius-md);">
            <div style="font-size: var(--fs-3xl); font-weight: 300; color: var(--axe-d-color); opacity: 0.3; margin-bottom: var(--s-3);">04</div>
            <h3 style="margin-bottom: var(--s-3); color: var(--axe-d-color);">Menaces & Violences Non Visibles ⚠️</h3>
            <p style="font-size: var(--fs-sm); margin: 0;"><strong>Zone critique :</strong> menaces suicidaires, chantages, violences psychologiques. Items pondérés x2. <strong>14 items</strong></p>
          </div>

          <div style="background: var(--axe-e-bg); border-left: 4px solid var(--axe-e-color); padding: var(--s-6); border-radius: var(--radius-md);">
            <div style="font-size: var(--fs-3xl); font-weight: 300; color: var(--axe-e-color); opacity: 0.3; margin-bottom: var(--s-3);">05</div>
            <h3 style="margin-bottom: var(--s-3); color: var(--axe-e-color);">Post-Séparation & Cyber-Contrôle ⚠️</h3>
            <p style="font-size: var(--fs-sm); margin: 0;">Stalking, harcèlement numérique, géolocalisation. Phase de dangerosité maximale. <strong>10 items</strong></p>
          </div>

          <div style="background: var(--axe-f-bg); border-left: 4px solid var(--axe-f-color); padding: var(--s-6); border-radius: var(--radius-md);">
            <div style="font-size: var(--fs-3xl); font-weight: 300; color: var(--axe-f-color); opacity: 0.3; margin-bottom: var(--s-3);">06</div>
            <h3 style="margin-bottom: var(--s-3); color: var(--axe-f-color);">Contexte Institutionnel</h3>
            <p style="font-size: var(--fs-sm); margin: 0;">Défaillances des institutions censées protéger (police, justice, employeurs). <strong>6 items</strong></p>
          </div>

        </div>
      </div>

      <!-- Méthodologie -->
      <div class="card">
        <h2>
          <svg class="card-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <circle cx="11" cy="11" r="8"/>
            <path d="m21 21-4.35-4.35"/>
          </svg>
          Méthodologie,Pourquoi 72 Questions ?
        </h2>
        <p><strong>L'emprise est un système complexe</strong> nécessitant une évaluation approfondie. Un test court (15-20 items) produirait 60-70% de faux négatifs car les victimes ne reconnaîtraient pas les tactiques subtiles.</p>
        
        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--s-4); margin-top: var(--s-6);">
          
          <div style="background: var(--creme-chaud); padding: var(--s-6); border-radius: var(--radius-lg); text-align: center;">
            <svg style="width: 48px; height: 48px; stroke: var(--or-signature); fill: none; margin: 0 auto var(--s-3);" viewBox="0 0 24 24">
              <rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/>
            </svg>
            <h3 style="font-size: var(--fs-xl); margin-bottom: var(--s-2);">72 Questions</h3>
            <p style="font-size: var(--fs-sm); margin: 0; color: var(--noir-doux);">Évaluation complète approfondie</p>
          </div>

          <div style="background: var(--creme-chaud); padding: var(--s-6); border-radius: var(--radius-lg); text-align: center;">
            <svg style="width: 48px; height: 48px; stroke: var(--or-signature); fill: none; margin: 0 auto var(--s-3);" viewBox="0 0 24 24">
              <circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/>
            </svg>
            <h3 style="font-size: var(--fs-xl); margin-bottom: var(--s-2);">15-20 Minutes</h3>
            <p style="font-size: var(--fs-sm); margin: 0; color: var(--noir-doux);">Temps estimé de passation</p>
          </div>

          <div style="background: var(--creme-chaud); padding: var(--s-6); border-radius: var(--radius-lg); text-align: center;">
            <svg style="width: 48px; height: 48px; stroke: var(--or-signature); fill: none; margin: 0 auto var(--s-3);" viewBox="0 0 24 24">
              <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
              <polyline points="7.5 4.21 12 6.81 16.5 4.21"/><polyline points="7.5 19.79 7.5 14.6 3 12"/><polyline points="21 12 16.5 14.6 16.5 19.79"/><polyline points="3.27 6.96 12 12.01 20.73 6.96"/><line x1="12" y1="22.08" x2="12" y2="12"/>
            </svg>
            <h3 style="font-size: var(--fs-xl); margin-bottom: var(--s-2);">6 Axes Cliniques</h3>
            <p style="font-size: var(--fs-sm); margin: 0; color: var(--noir-doux);">Approche transdisciplinaire</p>
          </div>

          <div style="background: var(--creme-chaud); padding: var(--s-6); border-radius: var(--radius-lg); text-align: center;">
            <svg style="width: 48px; height: 48px; stroke: var(--or-signature); fill: none; margin: 0 auto var(--s-3);" viewBox="0 0 24 24">
              <rect x="5" y="2" width="14" height="20" rx="2" ry="2"/><line x1="12" y1="18" x2="12.01" y2="18"/>
            </svg>
            <h3 style="font-size: var(--fs-xl); margin-bottom: var(--s-2);">100% Anonyme</h3>
            <p style="font-size: var(--fs-sm); margin: 0; color: var(--noir-doux);">Données strictement confidentielles</p>
          </div>

        </div>

        <div style="background: var(--or-subtil); border-left: 4px solid var(--or-signature); padding: var(--s-4); border-radius: var(--radius-md); margin-top: var(--s-6);">
          <p style="margin: 0; font-size: var(--fs-sm);"><strong>⏱ Durée estimée :</strong> 15-20 minutes. Ce temps investi est proportionnel à l'enjeu : votre sécurité et votre lucidité. <strong>26 items sur 72 sont pondérés x2</strong> car ils indiquent une dangerosité immédiate.</p>
        </div>
      </div>

      <!-- Comment ça marche -->
      <div class="card">
        <h2>
          <svg class="card-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/>
          </svg>
          Comment ça marche
        </h2>
        
        <h3 style="color: var(--or-signature); margin-bottom: var(--s-4);">Échelle de Réponse</h3>
        <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: var(--s-3); margin-bottom: var(--s-8);">
          <div style="background: var(--creme-chaud); padding: var(--s-4); border-radius: var(--radius-md); text-align: center;">
            <div style="font-size: var(--fs-2xl); font-weight: 700; color: var(--noir-absolu); margin-bottom: var(--s-2);">0</div>
            <div style="font-weight: 600; margin-bottom: var(--s-2);">Jamais</div>
            <div style="font-size: var(--fs-xs); color: var(--noir-doux);">Absent ou très rare</div>
          </div>
          <div style="background: var(--creme-chaud); padding: var(--s-4); border-radius: var(--radius-md); text-align: center;">
            <div style="font-size: var(--fs-2xl); font-weight: 700; color: var(--noir-absolu); margin-bottom: var(--s-2);">1</div>
            <div style="font-weight: 600; margin-bottom: var(--s-2);">Rarement</div>
            <div style="font-size: var(--fs-xs); color: var(--noir-doux);">Occasionnel</div>
          </div>
          <div style="background: var(--creme-chaud); padding: var(--s-4); border-radius: var(--radius-md); text-align: center;">
            <div style="font-size: var(--fs-2xl); font-weight: 700; color: var(--noir-absolu); margin-bottom: var(--s-2);">2</div>
            <div style="font-weight: 600; margin-bottom: var(--s-2);">Parfois</div>
            <div style="font-size: var(--fs-xs); color: var(--noir-doux);">Régulier</div>
          </div>
          <div style="background: var(--creme-chaud); padding: var(--s-4); border-radius: var(--radius-md); text-align: center;">
            <div style="font-size: var(--fs-2xl); font-weight: 700; color: var(--noir-absolu); margin-bottom: var(--s-2);">3</div>
            <div style="font-weight: 600; margin-bottom: var(--s-2);">Souvent</div>
            <div style="font-size: var(--fs-xs); color: var(--noir-doux);">Fréquent</div>
          </div>
          <div style="background: var(--creme-chaud); padding: var(--s-4); border-radius: var(--radius-md); text-align: center;">
            <div style="font-size: var(--fs-2xl); font-weight: 700; color: var(--noir-absolu); margin-bottom: var(--s-2);">4</div>
            <div style="font-weight: 600; margin-bottom: var(--s-2);">Toujours</div>
            <div style="font-size: var(--fs-xs); color: var(--noir-doux);">Quasi-permanent</div>
          </div>
        </div>

        <p style="font-style: italic; font-size: var(--fs-sm); color: var(--noir-doux); margin-bottom: var(--s-6);">Chaque item est évalué selon la fréquence à laquelle vous ressentez la situation décrite dans votre contexte actuel.</p>

        <h3 style="color: var(--or-signature); margin-bottom: var(--s-4);">Calcul des Scores</h3>
        <div style="background: var(--creme-chaud); padding: var(--s-6); border-radius: var(--radius-lg); margin-bottom: var(--s-4);">
          <div style="display: flex; align-items: center; gap: var(--s-3); margin-bottom: var(--s-4);">
            <svg style="width: 24px; height: 24px; stroke: var(--or-signature); fill: none;" viewBox="0 0 24 24">
              <rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/>
            </svg>
            <strong>Score par Axe</strong>
          </div>
          <p style="font-size: var(--fs-sm); margin: 0;">0-32 points (8 items × 0-4) ou plus selon pondération</p>
        </div>

        <div style="background: var(--creme-chaud); padding: var(--s-6); border-radius: var(--radius-lg); margin-bottom: var(--s-4);">
          <div style="display: flex; align-items: center; gap: var(--s-3); margin-bottom: var(--s-4);">
            <svg style="width: 24px; height: 24px; stroke: var(--or-signature); fill: none;" viewBox="0 0 24 24">
              <circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/>
            </svg>
            <strong>Score Total</strong>
          </div>
          <p style="font-size: var(--fs-sm); margin: 0;">0-288 points (somme des 6 axes avec pondération)</p>
        </div>

        <div style="background: var(--creme-chaud); padding: var(--s-6); border-radius: var(--radius-lg);">
          <div style="display: flex; align-items: center; gap: var(--s-3); margin-bottom: var(--s-4);">
            <svg style="width: 24px; height: 24px; stroke: #dc2626; fill: none;" viewBox="0 0 24 24">
              <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/>
            </svg>
            <strong style="color: #dc2626;">Items Pondérés × 2 (26 items)</strong>
          </div>
          <p style="font-size: var(--fs-sm); margin: 0;">Indicateurs de dangerosité immédiate ou facteurs d'escalade létale</p>
        </div>

        <div style="background: var(--or-subtil); border-left: 4px solid var(--or-signature); padding: var(--s-4); border-radius: var(--radius-md); margin-top: var(--s-6);">
          <p style="margin: 0; font-size: var(--fs-sm);"><strong>Interprétation :</strong> Plus le score est élevé, plus la perte de sens est marquée. Les résultats sont fournis par dimension et globalement, avec des recommandations personnalisées selon votre profil. Un score élevé indique un besoin d'attention et potentiellement d'accompagnement professionnel.</p>
        </div>
      </div>

      <!-- Informations Préliminaires -->
      <div class="card">
        <h2>
          <svg class="card-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/>
          </svg>
          Informations Préliminaires (Optionnel)
        </h2>
        <p style="margin-bottom: var(--s-6); font-size: var(--fs-sm); color: var(--noir-doux);">Ces informations permettent d'affiner l'analyse. Elles sont entièrement facultatives et ne quittent jamais votre navigateur.</p>

        <div class="form-group">
          <label for="user-name">Votre prénom ou pseudonyme</label>
          <input type="text" id="user-name" placeholder="Ex : Marie, Alex..." maxlength="50">
        </div>

        <div class="form-group">
          <label for="user-age">Votre âge</label>
          <input type="number" id="user-age" placeholder="Ex : 32" min="14" max="99">
        </div>

        <div class="form-group">
          <label for="relationship-type">Type de relation évaluée</label>
          <select id="relationship-type">
            <option value="">Sélectionner...</option>
            <option value="intimate-current">Relation intime (en cours)</option>
            <option value="intimate-past">Relation intime (passée)</option>
            <option value="family">Familiale</option>
            <option value="professional">Professionnelle</option>
            <option value="friendship">Amicale</option>
            <option value="other">Autre</option>
          </select>
        </div>

        <div class="form-group">
          <label for="duration">Durée de la relation</label>
          <select id="duration">
            <option value="">Sélectionner...</option>
            <option value="less-6m">Moins de 6 mois</option>
            <option value="6m-1y">6 mois à 1 an</option>
            <option value="1-3y">1 à 3 ans</option>
            <option value="3-5y">3 à 5 ans</option>
            <option value="more-10y">Plus de 10 ans</option>
          </select>
        </div>

        <div class="form-group">
          <label for="living-situation">Situation actuelle</label>
          <select id="living-situation">
            <option value="">Sélectionner...</option>
            <option value="together">Nous vivons ensemble</option>
            <option value="separated-recent">Séparé·e récemment (< 6 mois)</option>
            <option value="separated-long">Séparé·e depuis longtemps (> 6 mois)</option>
            <option value="no-contact">Sans contact actuellement</option>
          </select>
        </div>
      </div>

      <!-- Consentement -->
      <div class="card">
        <div class="checkbox-container" onclick="document.getElementById('consent-checkbox').click()">
          <input type="checkbox" id="consent-checkbox" onchange="updateConsentButton(event)" onclick="event.stopPropagation()">
          <label for="consent-checkbox" class="checkbox-label">
            J'ai lu et compris les avertissements. Je confirme que cet outil est utilisé <strong>à des fins informatives uniquement</strong> et qu'il ne remplace pas une consultation avec un professionnel qualifié. Je comprends que toutes mes données restent <strong>locales dans mon navigateur</strong> et ne sont transmises à aucun serveur. En cas de danger immédiat, je contacterai les services d'urgence (17, 112).
          </label>
        </div>
      </div>

      <button class="btn-primary" id="start-btn" onclick="startTest()" disabled style="width: 100%; margin-top: var(--s-6);">Commencer l'Évaluation</button>
    </div>

    <!-- ÉCRAN QUESTIONNAIRE -->
    <div id="test-screen" class="screen">
      <div class="progress-container" id="progress-container">
        <div class="progress-text" id="progress-text">Question 1 / 72</div>
        <div class="progress-bar">
          <div class="progress-fill" id="progress-fill"></div>
        </div>
      </div>

      <div class="question-container" id="question-container">
        <!-- Questions injectées dynamiquement -->
      </div>

      <div class="navigation-buttons" style="display: flex; gap: var(--s-4); justify-content: center; margin-top: var(--s-8);">
        <button class="btn-secondary" id="prev-btn" onclick="prevQuestion()" style="display: none;">← Précédent</button>
        <button class="btn-primary" id="next-btn" onclick="nextQuestion()" disabled>Suivant →</button>
      </div>
    </div>

    <!-- ÉCRAN RÉSULTATS -->
    <div id="results-screen" class="screen">
      <div class="header">
        <h1>Résultats de l'Évaluation</h1>
        <p class="header-subtitle">Analyse complète selon 6 axes cliniques</p>
      </div>

      <div id="results-content">
        <!-- Résultats injectés dynamiquement -->
      </div>

      <div class="footer">
        <p><strong>NOÉSIS</strong>,Intelligence transdisciplinaire au service de la lucidité</p>
        <p>© 2025 NOÉSIS,Tous droits réservés</p>
        <p>Version 1.0.0,Dernière mise à jour : 10/11/2025</p>
      </div>
    </div>

  </div>


  <script>
    // ==================== CONFIGURATION ====================
    const TEST_NAME = "Auto-Test Emprise & Contrôle Coercitif";
    
    const AXES = [
      {key:'axe-a', label:'Tactiques d\'Emprise', shortLabel:'Axe A', color:'#dc2626', bg:'rgba(220,38,38,0.08)'},
      {key:'axe-b', label:'Effets Psychologiques', shortLabel:'Axe B', color:'#7c3aed', bg:'rgba(124,58,237,0.08)'},
      {key:'axe-c', label:'Isolement', shortLabel:'Axe C', color:'#2563eb', bg:'rgba(37,99,235,0.08)'},
      {key:'axe-d', label:'Menaces', shortLabel:'Axe D', color:'#ea580c', bg:'rgba(234,88,12,0.08)'},
      {key:'axe-e', label:'Post-Séparation', shortLabel:'Axe E', color:'#0891b2', bg:'rgba(8,145,178,0.08)'},
      {key:'axe-f', label:'Institutions', shortLabel:'Axe F', color:'#65a30d', bg:'rgba(101,163,13,0.08)'}
    ];
    
    const SCALE = [
      {v:0, l:"Jamais", s:"Absent ou très rare"},
      {v:1, l:"Rarement", s:"Occasionnel, sans impact notable"},
      {v:2, l:"Parfois", s:"Présent régulièrement, impact modéré"},
      {v:3, l:"Souvent", s:"Fréquent, impact significatif"},
      {v:4, l:"Presque toujours", s:"Quasi-permanent, impact majeur"}
    ];
    

const Q=[
{i:'a1',a:'axe-a',t:"Il/elle alterne entre moments séduisants et critiques sévères pour obtenir mon obéissance.",w:0},
{i:'a2',a:'axe-a',t:"Il/elle exige une exclusivité immédiate dans notre relation « pour prouver l'amour ».",w:0},
{i:'a3',a:'axe-a',t:"Il/elle impose des interdits implicites concernant certaines personnes que je fréquente.",w:0},
{i:'a4',a:'axe-a',t:"Il/elle surveille mes déplacements ou mes horaires de manière systématique.",w:1},
{i:'a5',a:'axe-a',t:"Il/elle exige d'accéder à mes appareils, mots de passe, comptes ou courriers.",w:1},
{i:'a6',a:'axe-a',t:"Il/elle manifeste des colères punitives suivies d'excuses séduisantes.",w:0},
{i:'a7',a:'axe-a',t:"Il/elle réécrit les faits après un conflit, modifiant la réalité de ce qui s'est passé.",w:0},
{i:'a8',a:'axe-a',t:"Il/elle met en doute ma mémoire ou ma perception malgré des preuves objectives.",w:0},
{i:'a9',a:'axe-a',t:"Il/elle utilise des tiers (amis, famille, collègues) pour me déstabiliser ou me surveiller.",w:0},
{i:'a10',a:'axe-a',t:"Il/elle formule des ultimatums répétés pour obtenir un avantage.",w:0},
{i:'a11',a:'axe-a',t:"Il/elle impose des injonctions concernant ma tenue, mon alimentation ou mes rituels quotidiens.",w:0},
{i:'a12',a:'axe-a',t:"Il/elle contrôle mon temps ou mon besoin de repos.",w:0},
{i:'a13',a:'axe-a',t:"Il/elle exerce une pression financière ou bloque l'accès à l'argent commun.",w:1},
{i:'a14',a:'axe-a',t:"Il/elle me dénigre publiquement de manière calculée pour me décrédibiliser.",w:0},
{i:'a15',a:'axe-a',t:"Il/elle fait disparaître sélectivement des informations utiles (documents, mails, contacts).",w:0},
{i:'a16',a:'axe-a',t:"Il/elle crée volontairement des obstacles administratifs pour me compliquer la vie.",w:0},
{i:'b1',a:'axe-b',t:"Je vis dans un état d'hypervigilance quotidienne sans cause externe objective.",w:0},
{i:'b2',a:'axe-b',t:"J'ai développé des troubles du sommeil depuis le début de cette relation.",w:0},
{i:'b3',a:'axe-b',t:"J'ai des difficultés de concentration nouvelles qui impactent mon travail ou mes études.",w:0},
{i:'b4',a:'axe-b',t:"Ma mémoire devient floue après nos disputes.",w:0},
{i:'b5',a:'axe-b',t:"Je ressens des symptômes physiques au contact de cette personne (nausées, tremblements, oppression).",w:0},
{i:'b6',a:'axe-b',t:"Mon humeur varie brutalement après avoir reçu ses messages ou appels.",w:0},
{i:'b7',a:'axe-b',t:"J'ai développé un réflexe d'auto-censure avant toute demande ou expression d'un besoin.",w:0},
{i:'b8',a:'axe-b',t:"Je ressens une peur anticipée lorsqu'il/elle rentre à la maison ou m'appelle.",w:0},
{i:'b9',a:'axe-b',t:"Je me sens « coupé·e » de moi-même, comme déconnecté·e de mes émotions ou de mon corps.",w:0},
{i:'b10',a:'axe-b',t:"Je doute régulièrement de ma perception des événements.",w:0},
{i:'b11',a:'axe-b',t:"J'ai besoin de vérifier ses messages ou nos échanges pour « me prouver » ce qui s'est dit.",w:0},
{i:'b12',a:'axe-b',t:"Je note ou archive systématiquement des informations pour contrer la désorientation.",w:0},
{i:'b13',a:'axe-b',t:"J'ai des pensées intrusives liées à des menaces passées ou à venir.",w:0},
{i:'b14',a:'axe-b',t:"Je ressens un épuisement décisionnel chronique, même pour des choix simples.",w:0},
{i:'c1',a:'axe-c',t:"Je décline des invitations par crainte de représailles ou de conflits.",w:0},
{i:'c2',a:'axe-c',t:"Je dois justifier chaque dépense, même minime.",w:0},
{i:'c3',a:'axe-c',t:"Il/elle m'impose le secret « pour protéger notre relation ».",w:0},
{i:'c4',a:'axe-c',t:"Il/elle me décrédibilise auprès de mes proches ou collègues.",w:0},
{i:'c5',a:'axe-c',t:"Il/elle organise ou exploite ma dépendance logistique (voiture, logement, administratif).",w:0},
{i:'c6',a:'axe-c',t:"Il/elle m'impose des déplacements ou a contraint un déménagement contre mon gré.",w:1},
{i:'c7',a:'axe-c',t:"Il/elle m'empêche d'accéder à des soins médicaux ou à un suivi thérapeutique.",w:1},
{i:'c8',a:'axe-c',t:"Il/elle retire ou contrôle mes outils professionnels essentiels (ordinateur, téléphone, clés).",w:1},
{i:'c9',a:'axe-c',t:"Il/elle sabote mes entretiens d'embauche, projets ou examens.",w:0},
{i:'c10',a:'axe-c',t:"Il/elle surveille mes allées et venues dans mon environnement de travail.",w:1},
{i:'c11',a:'axe-c',t:"Il/elle exerce des pressions pour que je coupe des liens de soutien (amis, famille, thérapeute).",w:0},
{i:'c12',a:'axe-c',t:"Il/elle m'interdit informellement de parler de nos problèmes à l'extérieur.",w:0},
{i:'d1',a:'axe-d',t:"Il/elle menace de se faire du mal « si je pars » ou si je ne cède pas.",w:1,c:1},
{i:'d2',a:'axe-d',t:"Il/elle profère des menaces envers mes proches, mes animaux ou mes biens.",w:1,c:1},
{i:'d3',a:'axe-d',t:"Il/elle me fait du chantage à l'intime (images, secrets, réputation).",w:1,c:1},
{i:'d4',a:'axe-d',t:"Il/elle m'inflige des « punitions silencieuses » prolongées (mutisme, disparition).",w:0},
{i:'d5',a:'axe-d',t:"Il/elle provoque des crises à proximité d'objets ou de murs pour m'intimider sans me toucher.",w:1,c:1},
{i:'d6',a:'axe-d',t:"Il/elle adopte une conduite dangereuse (voiture, moto) pour me faire peur.",w:1,c:1},
{i:'d7',a:'axe-d',t:"Il/elle formule des injonctions sexuelles non désirées ou dégradantes.",w:1,c:1},
{i:'d8',a:'axe-d',t:"Il/elle conditionne son affection ou son soutien à mon obéissance.",w:0},
{i:'d9',a:'axe-d',t:"Il/elle brandit des menaces juridiques infondées pour me réduire au silence.",w:1,c:1},
{i:'d10',a:'axe-d',t:"Il/elle répète des propos humiliants selon un rituel prévisible.",w:0},
{i:'d11',a:'axe-d',t:"Il/elle utilise la pression religieuse ou culturelle pour me contraindre.",w:0},
{i:'d12',a:'axe-d',t:"Il/elle exige des confessions filmées ou écrites comme « preuve de loyauté ».",w:1,c:1},
{i:'d13',a:'axe-d',t:"Il/elle exploite mes vulnérabilités économiques pour maintenir son emprise.",w:1,c:1},
{i:'d14',a:'axe-d',t:"Il/elle met en scène de fausses « preuves » pour me faire paraître coupable ou instable.",w:0},
{i:'e1',a:'axe-e',t:"Il/elle me surveille après la rupture (filatures, attentes devant mon domicile ou travail).",w:1,c:1},
{i:'e2',a:'axe-e',t:"Il/elle multiplie les faux comptes sur les réseaux sociaux pour m'observer.",w:1,c:1},
{i:'e3',a:'axe-e',t:"Il/elle alterne sollicitations charmantes et menaces après notre séparation.",w:0},
{i:'e4',a:'axe-e',t:"Il/elle me demande de retirer des témoignages ou de minimiser publiquement les faits.",w:0},
{i:'e5',a:'axe-e',t:"Il/elle m'envoie des messages via des « relais » (amis communs, famille).",w:0},
{i:'e6',a:'axe-e',t:"Il/elle tente de ruiner ma crédibilité en ligne (diffamation, faux profils).",w:0},
{i:'e7',a:'axe-e',t:"Il/elle s'introduit dans mes outils numériques ou cloud professionnels.",w:1,c:1},
{i:'e8',a:'axe-e',t:"Il/elle utilise des dispositifs de géolocalisation ou espionne mes appareils.",w:1,c:1},
{i:'e9',a:'axe-e',t:"Il/elle multiplie les signalements malveillants de contenus me concernant.",w:0},
{i:'e10',a:'axe-e',t:"Il/elle utilise les enfants ou des collègues comme leviers pour maintenir le contrôle.",w:1,c:1},
{i:'f1',a:'axe-f',t:"Je rencontre des blocages internes lorsque je cherche de l'aide (police, justice, employeur).",w:0},
{i:'f2',a:'axe-f',t:"Mes signalements sont minimisés ou banalisés par les institutions.",w:0},
{i:'f3',a:'axe-f',t:"Les retards ou errances procédurales m'exposent plus longtemps au danger.",w:0},
{i:'f4',a:'axe-f',t:"Je subis des pressions hiérarchiques ou institutionnelles pour « taire l'affaire ».",w:0},
{i:'f5',a:'axe-f',t:"Les procédures internes (enquête, médiation) sont utilisées contre moi.",w:0},
{i:'f6',a:'axe-f',t:"J'ai peur d'une escalade si je porte plainte ou formalise mes démarches.",w:0}
];

    
    const BANDS = [
      {min:0,max:59,level:"Signaux Faibles",severity:"low",color:"#10b981",interpretation:"Les comportements rapportés se situent dans une zone de vigilance sans caractère systématique d'emprise. Documentez toute évolution et fixez des limites claires.",recommendations:["Surveillez l'évolution des dynamiques relationnelles","Documentez les incidents avec dates et faits précis","Fixez et maintenez des limites personnelles claires","Consultez si augmentation de la fréquence"]},
      {min:60,max:119,level:"Zone Grise,Multiples Tactiques",severity:"medium",color:"#f59e0b",interpretation:"Plusieurs tactiques d'emprise identifiées avec fréquence préoccupante. Cette zone nécessite analyse approfondie et plan de protection.",recommendations:["Élaborez un plan de protection personnalisé","Documentez systématiquement avec preuves datées","Identifiez un réseau de soutien fiable","Consultez psychologue spécialisé trauma","Contactez 3919 ou France Victimes"]},
      {min:120,max:179,level:"Probabilité Élevée d'Emprise",severity:"high",color:"#dc2626",interpretation:"Cumul important de tactiques d'emprise et contrôle coercitif. Impact neuro-psychologique mesurable. Intervention coordonnée nécessaire.",recommendations:["PRIORITÉ : Sécurisez vos preuves","Consultez avocat spécialisé","Engagez suivi psycho-traumatologique","Contactez 3919 pour plan de sortie","Ordonnance de protection si applicable","Informez entourage proche"]},
      {min:180,max:288,level:"Alerte Sévère,Danger Élevé",severity:"severe",color:"#991b1b",interpretation:"Emprise structurée avec dangerosité documentée. Scores élevés axes D/E signalent risque d'escalade. Mise en sécurité rapide impérative.",recommendations:["🚨 URGENCE : 17 ou 112 si danger immédiat","Plan mise en sécurité avec hébergement protégé","Avocat + psychotrauma + associations","Ordonnance protection urgence","Signalement procureur si faits pénaux","Sécurisation numérique complète"]}
    ];
    
    // State
    let state = {
      currentScreen: 'intro',
      currentQuestionIndex: 0,
      answers: {},
      anamnesis: {name:'', age:null, relationshipType:'', duration:'', livingSituation:''},
      startTime: null,
      completionTime: null
    };
    
    // ==================== NAVIGATION ====================
    function updateConsentButton(e) {
      if(e) e.stopPropagation();
      document.getElementById('start-btn').disabled = !document.getElementById('consent-checkbox').checked;
    }
    
    function startTest() {
      state.anamnesis.name = document.getElementById('user-name').value.trim() || 'Anonyme';
      state.anamnesis.age = parseInt(document.getElementById('user-age').value) || null;
      state.anamnesis.relationshipType = document.getElementById('relationship-type').value;
      state.anamnesis.duration = document.getElementById('duration').value;
      state.anamnesis.livingSituation = document.getElementById('living-situation').value;
      state.startTime = Date.now();
      state.currentQuestionIndex = 0;
      state.answers = {};
      showScreen('test');
      document.getElementById('progress-container').classList.add('active');
      renderQuestion();
    }
    
    function showScreen(screenName) {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById(screenName + '-screen').classList.add('active');
      state.currentScreen = screenName;
      window.scrollTo({top: 0, behavior: 'smooth'});
    }
    
    function renderQuestion() {
      const q = Q[state.currentQuestionIndex];
      const axisInfo = AXES.find(a => a.key === q.a);
      const progress = ((state.currentQuestionIndex + 1) / Q.length) * 100;
      
      document.getElementById('progress-text').textContent = `Question ${state.currentQuestionIndex + 1} / ${Q.length}`;
      document.getElementById('progress-fill').style.width = progress + '%';
      
      const optionsHtml = SCALE.map(opt => `
        <div class="answer-option ${state.answers[q.i] === opt.v ? 'selected' : ''}" onclick="selectAnswer(${opt.v})">
          <div class="option-content">
            <div class="option-label">${opt.l}</div>
            <div class="option-sublabel">${opt.s}</div>
          </div>
          <div class="option-check">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><polyline points="20 6 9 17 4 12"/></svg>
          </div>
        </div>
      `).join('');
      
      document.getElementById('question-container').innerHTML = `
        <div class="question-card">
          <div class="dimension-badge" style="background: ${axisInfo.bg}; color: ${axisInfo.color};">${axisInfo.shortLabel},${axisInfo.label}</div>
          <div class="question-number">Question ${state.currentQuestionIndex + 1}</div>
          <div class="question-text">${q.t}${q.w ? ' <span style="color:#dc2626;font-weight:700;margin-left:8px">⚠︎</span>' : ''}</div>
          <div style="display:flex;flex-direction:column;gap:12px;">${optionsHtml}</div>
        </div>
      `;
      
      document.getElementById('prev-btn').style.display = state.currentQuestionIndex > 0 ? 'inline-block' : 'none';
      document.getElementById('next-btn').disabled = state.answers[q.i] === undefined;
      document.getElementById('next-btn').textContent = state.currentQuestionIndex === Q.length - 1 ? 'Voir mes Résultats' : 'Suivant →';
    }
    
    function selectAnswer(value) {
      state.answers[Q[state.currentQuestionIndex].i] = value;
      renderQuestion();
      setTimeout(() => nextQuestion(), 150);
    }
    
    function nextQuestion() {
      if (state.currentQuestionIndex < Q.length - 1) {
        state.currentQuestionIndex++;
        renderQuestion();
      } else {
        state.completionTime = Date.now();
        showResults();
      }
    }
    
    function prevQuestion() {
      if (state.currentQuestionIndex > 0) {
        state.currentQuestionIndex--;
        renderQuestion();
      }
    }
    
    // ==================== CALCUL SCORES ====================
    function calculateScores() {
      const dimensions = {};
      let totalWeighted = 0;
      const redFlags = [];
      
      AXES.forEach(axis => dimensions[axis.key] = {score: 0, maxScore: 0, percentage: 0});
      
      Q.forEach(q => {
        const answer = state.answers[q.i] || 0;
        const weighted = q.w ? 2 : 1;
        const scoreValue = answer * weighted;
        
        totalWeighted += scoreValue;
        dimensions[q.a].score += scoreValue;
        dimensions[q.a].maxScore += 4 * weighted;
        
        if (q.c && answer >= 3) {
          redFlags.push({id: q.i, text: q.t, value: answer, label: SCALE[answer].l});
        }
      });
      
      Object.keys(dimensions).forEach(key => {
        dimensions[key].percentage = Math.round((dimensions[key].score / dimensions[key].maxScore) * 100);
      });
      
      return {dimensions, totalWeighted, maxTotal: 288, redFlags};
    }
    
    function getResultBand(totalWeighted) {
      return BANDS.find(band => totalWeighted >= band.min && totalWeighted <= band.max);
    }
    
    // ==================== AFFICHAGE RÉSULTATS ====================
    function showResults() {
      showScreen('results');
      document.getElementById('progress-container').classList.remove('active');
      const scores = calculateScores();
      const resultBand = getResultBand(scores.totalWeighted);
      
      let html = `
        <div class="card result-summary">
          <h2>Score Global</h2>
          <div style="text-align:center;margin:var(--s-8) 0">
            <div style="font-family:'Fraunces',serif;font-size:var(--fs-4xl);font-weight:700">${scores.totalWeighted}</div>
            <div style="font-size:var(--fs-lg);color:var(--noir-doux);margin-top:var(--s-2)">sur ${scores.maxTotal} (${Math.round((scores.totalWeighted/scores.maxTotal)*100)}%)</div>
          </div>
          <div style="text-align:center">
            <div style="display:inline-block;padding:var(--s-3) var(--s-6);border-radius:var(--radius-pill);font-size:var(--fs-md);font-weight:600;background:${resultBand.severity==='low'?'rgba(16,185,129,0.15)':resultBand.severity==='medium'?'rgba(245,158,11,0.15)':resultBand.severity==='high'?'rgba(220,38,38,0.15)':'rgba(153,27,27,0.15)'};color:${resultBand.severity==='low'?'#065f46':resultBand.severity==='medium'?'#92400e':resultBand.severity==='high'?'#7f1d1d':'#450a0a'}">
              ${resultBand.level}
            </div>
          </div>
          <p style="margin-top:var(--s-6);text-align:justify">${resultBand.interpretation}</p>
        </div>
      `;
      
      if (scores.redFlags.length > 0) {
        html += `
          <div class="card" style="background:#fef2f2;border:2px solid #dc2626">
            <h3 style="color:#7f1d1d;margin-bottom:var(--s-4)">🚨 Drapeaux Rouges Identifiés (${scores.redFlags.length})</h3>
            <p style="font-size:var(--fs-sm);margin-bottom:var(--s-4)"><strong>ALERTE :</strong> Les items suivants indiquent une dangerosité immédiate nécessitant mise en sécurité prioritaire.</p>
            ${scores.redFlags.map(flag => `
              <div style="background:white;padding:var(--s-4);border-radius:var(--radius-md);margin-bottom:var(--s-3);border-left:4px solid #dc2626">
                <div style="font-weight:600;margin-bottom:4px">${flag.text}</div>
                <div style="font-size:var(--fs-sm);color:var(--noir-doux)">Fréquence : ${flag.label}</div>
              </div>
            `).join('')}
          </div>
        `;
      }
      
      html += `
        <div class="card">
          <h2>Analyse par Axe</h2>
          <div class="dimensions-grid">
      `;
      
      AXES.forEach(axis => {
        const dimData = scores.dimensions[axis.key];
        html += `
          <div class="dimension-card ${axis.key}">
            <h3>${axis.label}</h3>
            <div class="dimension-bar">
              <div class="dimension-bar-fill" style="width:${dimData.percentage}%;background:${axis.color}"></div>
            </div>
            <div class="dimension-level">${dimData.score} / ${dimData.maxScore} (${dimData.percentage}%)</div>
          </div>
        `;
      });
      
      html += `
          </div>
        </div>
        
        <div class="recommendations-list">
          <h3>Recommandations Personnalisées</h3>
          ${resultBand.recommendations.map(rec => `
            <div class="recommendation-item">
              <p class="recommendation-text">${rec}</p>
            </div>
          `).join('')}
        </div>
        
        <div class="card" style="background:#ecfdf5;border:2px solid #10b981">
          <h3>Ressources Urgentes France</h3>
          <div style="background:white;padding:var(--s-4);border-radius:var(--radius-md);margin-bottom:var(--s-3)">
            <strong>3919</strong>,Violences Femmes Info (24/7, gratuit, anonyme)
          </div>
          <div style="background:white;padding:var(--s-4);border-radius:var(--radius-md);margin-bottom:var(--s-3)">
            <strong>17</strong>,Police/Gendarmerie (danger immédiat)
          </div>
          <div style="background:white;padding:var(--s-4);border-radius:var(--radius-md);margin-bottom:var(--s-3)">
            <strong>114</strong>,Urgence SMS (si parole impossible)
          </div>
          <div style="background:white;padding:var(--s-4);border-radius:var(--radius-md);margin-bottom:var(--s-3)">
            <strong>3114</strong>,Prévention Suicide
          </div>
          <div style="background:white;padding:var(--s-4);border-radius:var(--radius-md)">
            <strong>119</strong>,Enfance en Danger
          </div>
        </div>
        
        <div class="btn-group">
          <button class="btn-secondary" onclick="window.print()">📄 Imprimer le Rapport</button>
          <button class="btn-secondary" onclick="exportEmail()">✉️ Envoyer par Email</button>
          <button class="btn-secondary" onclick="exportJSON()">📊 Exporter JSON</button>
          <button class="btn-secondary" onclick="resetTest()" style="color:#dc2626;border-color:#dc2626">🔄 Recommencer</button>
        </div>
      `;
      
      document.getElementById('results-content').innerHTML = html;
    }
    
    // ==================== EXPORTS ====================
    function exportEmail() {
      const scores = calculateScores();
      const resultBand = getResultBand(scores.totalWeighted);
      const body = `Rapport NOÉSIS,Emprise & Contrôle Coercitif
Participant : ${state.anamnesis.name}
Généré le ${new Date().toLocaleDateString('fr-FR')}

SCORE TOTAL : ${scores.totalWeighted} / ${scores.maxTotal} (${Math.round((scores.totalWeighted/scores.maxTotal)*100)}%)
NIVEAU : ${resultBand.level}

${scores.redFlags.length>0?`⚠️ DRAPEAUX ROUGES : ${scores.redFlags.length} item(s) critique(s)

`:''}ANALYSE PAR AXE :
${AXES.map(ax=>`• ${ax.label} : ${scores.dimensions[ax.key].percentage}%`).join('\n')}

Pour consulter le rapport complet, accédez à l'interface NOÉSIS.

---
NOÉSIS,Intelligence transdisciplinaire
© ${new Date().getFullYear()}`;
      
      window.location.href = `mailto:?subject=${encodeURIComponent('Rapport Emprise NOÉSIS,' + state.anamnesis.name)}&body=${encodeURIComponent(body)}`;
    }
    
    function exportJSON() {
      const scores = calculateScores();
      const data = {
        metadata: {test: TEST_NAME, version: "1.0.0", date: new Date().toISOString(), participant: state.anamnesis.name},
        anamnesis: state.anamnesis,
        responses: {answers: state.answers, completion: `${Object.keys(state.answers).length}/${Q.length}`},
        scoring: {totalWeighted: scores.totalWeighted, maxTotal: scores.maxTotal, dimensions: scores.dimensions, redFlags: scores.redFlags}
      };
      
      const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `noesis-emprise-${Date.now()}.json`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }
    
    function resetTest() {
      if (confirm("Recommencer ? Toutes vos réponses seront perdues.")) {
        state = {currentScreen:'intro', currentQuestionIndex:0, answers:{}, anamnesis:{name:'',age:null,relationshipType:'',duration:'',livingSituation:''}, startTime:null, completionTime:null};
        document.getElementById('user-name').value = '';
        document.getElementById('user-age').value = '';
        document.getElementById('relationship-type').value = '';
        document.getElementById('duration').value = '';
        document.getElementById('living-situation').value = '';
        document.getElementById('consent-checkbox').checked = false;
        updateConsentButton();
        showScreen('intro');
      }
    }
  </script>
</body>
</html>
