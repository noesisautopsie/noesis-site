<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Cartographie Clinique des Violences Subies | NOÉSIS</title>
  <meta name="description" content="Outil de repérage quasi-psychométrique des violences par type et par sphère de vie. Analyse multidimensionnelle de l'exposition aux violences psychologiques, physiques, sexuelles, économiques et institutionnelles.">
  <meta name="test-version" content="1.0.0">
  <meta name="test-last-updated" content="2025-11-16">
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@300;400;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <style>
    :root {
      --noir-absolu: #0A0A0A;
      --noir-doux: #111111;
      --noir-surface: #1A1A1A;
      --creme-principal: #F7F5EF;
      --creme-chaud: #F9F7F1;
      --blanc-surface: #FFFFFF;
      
      --or-signature: #C7A86D;
      --or-riche: #D4B980;
      --or-sombre: #A89158;
      --or-subtil: rgba(199,168,109,0.08);
      --or-leger: rgba(199,168,109,0.15);
      --or-moyen: rgba(199,168,109,0.25);
      
      --border-subtil: rgba(10,10,10,0.08);
      --border-leger: rgba(10,10,10,0.12);
      --border-visible: rgba(10,10,10,0.18);
      
      --vio-psycho-color: #dc2626;
      --vio-psycho-bg: rgba(220,38,38,0.08);
      --vio-physique-color: #ea580c;
      --vio-physique-bg: rgba(234,88,12,0.08);
      --vio-sexuelle-color: #7c3aed;
      --vio-sexuelle-bg: rgba(124,58,237,0.08);
      --vio-eco-color: #0891b2;
      --vio-eco-bg: rgba(8,145,178,0.08);
      --vio-instit-color: #2563eb;
      --vio-instit-bg: rgba(37,99,235,0.08);
      
      --sphere-i-color: #dc2626;
      --sphere-f-color: #ea580c;
      --sphere-p-color: #0891b2;
      --sphere-s-color: #2563eb;
      --sphere-a-color: #64748b;
      
      --fs-xs: 12px; --fs-sm: 14px; --fs-md: 18px;
      --fs-lg: 21px; --fs-xl: 24px; --fs-2xl: 32px;
      --fs-3xl: 42px; --fs-4xl: 56px;
      --lh-tight: 1.2; --lh-normal: 1.5; --lh-relaxed: 1.7;
      
      --s-2: 8px; --s-3: 12px; --s-4: 16px;
      --s-6: 24px; --s-8: 32px; --s-12: 48px;
      --s-16: 64px; --s-20: 80px;
      
      --shadow-soft: 0 2px 8px rgba(10,10,10,0.08), 0 1px 2px rgba(10,10,10,0.12);
      --shadow-medium: 0 4px 16px rgba(10,10,10,0.1), 0 2px 4px rgba(10,10,10,0.15);
      --shadow-large: 0 8px 32px rgba(10,10,10,0.12), 0 2px 8px rgba(10,10,10,0.18);
      
      --radius-sm: 4px; --radius-md: 8px; --radius-lg: 12px;
      --radius-xl: 16px; --radius-2xl: 24px; --radius-pill: 9999px;
      
      --duration-fast: 150ms;
      --duration-normal: 250ms;
      --duration-slow: 350ms;
      --ease-standard: cubic-bezier(0.4, 0.0, 0.2, 1);
      --ease-spring: cubic-bezier(0.16, 1, 0.3, 1);
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      font-size: var(--fs-md);
      line-height: var(--lh-relaxed);
      color: var(--noir-absolu);
      background: var(--creme-principal);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    
    h1, h2, h3 {
      font-family: 'Fraunces', Georgia, serif;
      font-weight: 600;
      line-height: var(--lh-tight);
      color: var(--noir-absolu);
    }
    
    h1 { font-size: var(--fs-3xl); }
    h2 { font-size: var(--fs-2xl); }
    h3 { font-size: var(--fs-xl); }
    
    p { margin-bottom: var(--s-4); }
    strong { font-weight: 600; color: var(--noir-absolu); }
    
    .site-header {
      background: var(--noir-surface);
      border-bottom: 1px solid rgba(199,168,109,0.2);
      padding: var(--s-4) 0;
      position: sticky;
      top: 0;
      z-index: 1000;
      box-shadow: 0 4px 12px rgba(0,0,0,0.25);
    }
    
    .header-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 var(--s-6);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    
    .site-logo {
      font-family: 'Fraunces', Georgia, serif;
      font-size: var(--fs-xl);
      font-weight: 700;
      color: var(--creme-principal);
      text-decoration: none;
      letter-spacing: 0.5px;
      transition: color var(--duration-fast) var(--ease-standard);
    }
    
    .site-logo:hover {
      color: var(--or-riche);
    }
    
    .site-logo span { color: var(--or-signature); }
    
    .site-nav {
      display: flex;
      align-items: center;
      gap: var(--s-8);
    }
    
    .nav-link {
      font-size: var(--fs-sm);
      font-weight: 500;
      color: rgba(247,245,239,0.85);
      text-decoration: none;
      padding: var(--s-2) var(--s-3);
      border-radius: var(--radius-md);
      transition: all var(--duration-fast) var(--ease-standard);
    }
    
    .nav-link:hover {
      color: var(--or-signature);
      background: rgba(199,168,109,0.12);
    }
    
    .nav-link.active {
      color: rgba(247,245,239,0.95);
      background: transparent;
      font-weight: 600;
    }
    
    .mobile-menu-toggle {
      display: none;
      background: none;
      border: none;
      cursor: pointer;
      padding: var(--s-2);
      color: var(--creme-principal);
      transition: color var(--duration-fast) var(--ease-standard);
    }
    
    .mobile-menu-toggle:hover {
      color: var(--or-signature);
    }
    
    @media (max-width: 768px) {
      .site-nav {
        display: none;
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background: var(--noir-surface);
        flex-direction: column;
        align-items: stretch;
        padding: var(--s-4);
        box-shadow: 0 8px 16px rgba(0,0,0,0.35);
        gap: 0;
        border-top: 1px solid rgba(199,168,109,0.15);
      }
      
      .site-nav.active { display: flex; }
      
      .nav-link {
        padding: var(--s-4);
        border-radius: 0;
        border-bottom: 1px solid rgba(199,168,109,0.1);
      }
      
      .mobile-menu-toggle { display: block; }
    }
    
    .app-container {
      max-width: 900px;
      margin: 0 auto;
      padding: var(--s-12) var(--s-6);
    }
    
    .screen {
      display: none;
      opacity: 0;
    }
    
    .screen.active {
      display: block;
      animation: fadeIn var(--duration-normal) var(--ease-standard) forwards;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(8px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .card {
      background: var(--blanc-surface);
      border-radius: var(--radius-2xl);
      padding: var(--s-12);
      margin-bottom: var(--s-8);
      box-shadow: var(--shadow-large);
    }
    
    .card h2, .card h3 {
      margin-bottom: var(--s-6);
      display: flex;
      align-items: center;
      gap: var(--s-3);
    }
    
    .card-icon {
      width: 24px;
      height: 24px;
      stroke: var(--or-signature);
      fill: none;
      stroke-width: 2;
      stroke-linecap: round;
      stroke-linejoin: round;
    }
    
    .warning-box {
      background: #fffbeb;
      border-left: 4px solid var(--or-signature);
      border-radius: var(--radius-md);
      padding: var(--s-6);
      margin-bottom: var(--s-8);
    }
    
    .warning-box h3 {
      font-size: var(--fs-lg);
      margin-bottom: var(--s-3);
      display: flex;
      align-items: center;
      gap: var(--s-2);
      color: var(--noir-absolu);
    }
    
    .warning-box p {
      font-size: var(--fs-sm);
      line-height: var(--lh-relaxed);
      color: rgba(10,10,10,0.75);
      margin-bottom: var(--s-3);
    }
    
    .warning-box p:last-child { margin-bottom: 0; }
    
    .warning-icon {
      width: 20px;
      height: 20px;
      stroke: var(--or-signature);
      fill: none;
      stroke-width: 2.5;
      stroke-linecap: round;
      stroke-linejoin: round;
    }
    
    /* Dimensions List */
    .dimensions-list {
      list-style: none;
      padding: 0;
      margin: var(--s-6) 0;
    }
    
    .dimension-item {
      padding: var(--s-6);
      margin-bottom: var(--s-4);
      border-radius: var(--radius-lg);
      border-left: 4px solid currentColor;
    }
    
    .dimension-item strong {
      display: block;
      font-size: var(--fs-lg);
      margin-bottom: var(--s-2);
      font-family: 'Fraunces', serif;
      color: var(--noir-absolu);
    }
    
    .dimension-item p {
      font-size: var(--fs-sm);
      color: rgba(10,10,10,0.75);
      margin: 0;
      line-height: var(--lh-relaxed);
    }
    
    /* Formulaires */
    .form-group {
      margin-bottom: var(--s-6);
    }
    
    .form-label {
      display: block;
      font-size: var(--fs-sm);
      font-weight: 600;
      margin-bottom: var(--s-2);
      color: var(--noir-absolu);
    }
    
    .form-input {
      width: 100%;
      padding: var(--s-3) var(--s-4);
      border: 2px solid var(--border-leger);
      border-radius: var(--radius-md);
      font-size: var(--fs-md);
      font-family: 'Inter', sans-serif;
      transition: all var(--duration-fast) var(--ease-standard);
    }
    
    .form-input:focus {
      outline: none;
      border-color: var(--or-signature);
      box-shadow: 0 0 0 3px var(--or-subtil);
    }
    
    /* Consent & Buttons */
      font-family: 'Inter', sans-serif;
      font-size: var(--fs-md);
      font-weight: 600;
      padding: var(--s-4) var(--s-8);
      border-radius: var(--radius-xl);
      border: 2px solid transparent;
      cursor: pointer;
      transition: all var(--duration-normal) var(--ease-spring);
      text-decoration: none;
      display: inline-block;
      text-align: center;
    }
    
    .btn-primary {
      background: linear-gradient(135deg, var(--or-signature) 0%, var(--or-riche) 100%);
      color: var(--noir-absolu);
      box-shadow: 
        0 8px 24px rgba(199,168,109,0.35),
        0 2px 8px rgba(199,168,109,0.25),
        inset 0 1px 0 rgba(255,255,255,0.2);
      border: none;
      font-size: var(--fs-lg);
      padding: var(--s-6) var(--s-12);
      letter-spacing: 0.5px;
      text-transform: uppercase;
      font-weight: 700;
    }
    
    .btn-primary:hover:not(:disabled) {
      background: linear-gradient(135deg, var(--or-riche) 0%, #E5C990 100%);
      transform: translateY(-3px);
      box-shadow: 
        0 12px 32px rgba(199,168,109,0.45),
        0 4px 12px rgba(199,168,109,0.35),
        inset 0 1px 0 rgba(255,255,255,0.3);
    }
    
    .btn-primary:active:not(:disabled) {
      transform: translateY(-1px);
      box-shadow: 
        0 6px 20px rgba(199,168,109,0.35),
        0 2px 8px rgba(199,168,109,0.25),
        inset 0 1px 0 rgba(255,255,255,0.15);
    }
    
    .btn-primary:disabled {
      background: var(--border-leger);
      color: rgba(10,10,10,0.4);
      cursor: not-allowed;
      box-shadow: none;
      border-color: transparent;
      text-transform: none;
    }
    
    /* Bouton Commencer l'Évaluation - Style doré premium forcé */
    #start-btn:not(:disabled),
    .btn-start-evaluation:not(:disabled) {
      background: linear-gradient(135deg, #C7A86D 0%, #D4B980 100%) !important;
      color: #0A0A0A !important;
      box-shadow: 
        0 8px 24px rgba(199,168,109,0.35),
        0 2px 8px rgba(199,168,109,0.25),
        inset 0 1px 0 rgba(255,255,255,0.2) !important;
      border: none !important;
      font-size: 21px !important;
      padding: 24px 48px !important;
      letter-spacing: 0.5px !important;
      text-transform: uppercase !important;
      font-weight: 700 !important;
    }
    
    #start-btn:hover:not(:disabled),
    .btn-start-evaluation:hover:not(:disabled) {
      background: linear-gradient(135deg, #D4B980 0%, #E5C990 100%) !important;
      transform: translateY(-3px) !important;
      box-shadow: 
        0 12px 32px rgba(199,168,109,0.45),
        0 4px 12px rgba(199,168,109,0.35),
        inset 0 1px 0 rgba(255,255,255,0.3) !important;
    }
    
    .btn-secondary {
      background: transparent;
      color: var(--noir-absolu);
      border-color: var(--border-visible);
    }
    
    .btn-secondary:hover {
      border-color: var(--or-signature);
      color: var(--or-signature);
      background: var(--or-subtil);
    }
    
    .btn-group {
      display: flex;
      gap: var(--s-4);
      flex-wrap: wrap;
      margin-top: var(--s-8);
    }
    
    .btn-group button, .btn-group a {
      flex: 1;
      min-width: 200px;
    }
    
    .form-group { margin-bottom: var(--s-6); }
    
    .form-label {
      display: block;
      font-size: var(--fs-sm);
      font-weight: 600;
      color: var(--noir-absolu);
      margin-bottom: var(--s-2);
    }
    
    .form-input, .form-select {
      width: 100%;
      font-family: 'Inter', sans-serif;
      font-size: var(--fs-md);
      padding: var(--s-3) var(--s-4);
      border: 2px solid var(--border-leger);
      border-radius: var(--radius-md);
      background: var(--blanc-surface);
      color: var(--noir-absolu);
      transition: all var(--duration-fast) var(--ease-standard);
    }
    
    .form-input:focus, .form-select:focus {
      outline: none;
      border-color: var(--or-signature);
      box-shadow: 0 0 0 3px var(--or-subtil);
    }
    
    .checkbox-group {
      display: flex;
      align-items: start;
      gap: var(--s-3);
      padding: var(--s-4);
      border: 2px solid var(--border-leger);
      border-radius: var(--radius-md);
      background: var(--creme-chaud);
    }
    
    .checkbox-group input[type="checkbox"] {
      width: 20px;
      height: 20px;
      margin-top: 2px;
      cursor: pointer;
      accent-color: var(--or-signature);
    }
    
    .checkbox-group label {
      flex: 1;
      font-size: var(--fs-sm);
      line-height: var(--lh-relaxed);
      cursor: pointer;
    }
    
    .progress-container {
      position: sticky;
      top: 65px;
      background: var(--blanc-surface);
      padding: var(--s-4) var(--s-6);
      border-radius: var(--radius-2xl);
      box-shadow: var(--shadow-medium);
      margin-bottom: var(--s-8);
      z-index: 900;
      display: none;
    }
    
    .progress-container.active { display: block; }
    
    .progress-text {
      font-size: var(--fs-sm);
      font-weight: 600;
      color: var(--noir-doux);
      margin-bottom: var(--s-2);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .progress-bar {
      height: 8px;
      background: var(--border-subtil);
      border-radius: var(--radius-pill);
      overflow: hidden;
    }
    
    .progress-bar-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--or-signature), var(--or-riche));
      border-radius: var(--radius-pill);
      transition: width var(--duration-normal) var(--ease-spring);
    }
    
    .question-card {
      background: var(--blanc-surface);
      border-radius: var(--radius-2xl);
      padding: var(--s-12);
      box-shadow: var(--shadow-large);
      margin-bottom: var(--s-8);
    }
    
    .question-number {
      font-size: var(--fs-sm);
      font-weight: 600;
      color: var(--or-signature);
      margin-bottom: var(--s-3);
    }
    
    .question-text {
      font-size: var(--fs-xl);
      font-weight: 600;
      color: var(--noir-absolu);
      margin-bottom: var(--s-6);
      line-height: var(--lh-normal);
    }
    
    .answer-options {
      display: grid;
      gap: var(--s-3);
      margin-bottom: var(--s-6);
    }
    
    .answer-option {
      background: var(--creme-chaud);
      border: 2px solid var(--border-leger);
      border-radius: var(--radius-xl);
      padding: var(--s-4) var(--s-6);
      cursor: pointer;
      transition: all var(--duration-fast) var(--ease-standard);
      display: flex;
      align-items: center;
      gap: var(--s-3);
    }
    
    .answer-option:hover {
      border-color: var(--or-signature);
      background: var(--or-subtil);
      transform: translateX(4px);
    }
    
    .answer-option.selected {
      background: var(--or-leger);
      border-color: var(--or-signature);
      box-shadow: 0 0 0 3px var(--or-subtil);
    }
    
    .answer-radio {
      width: 20px;
      height: 20px;
      border: 2px solid var(--border-visible);
      border-radius: 50%;
      position: relative;
      flex-shrink: 0;
    }
    
    .answer-option.selected .answer-radio {
      border-color: var(--or-signature);
    }
    
    .answer-option.selected .answer-radio::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 10px;
      height: 10px;
      background: var(--or-signature);
      border-radius: 50%;
    }
    
    .answer-label {
      flex: 1;
      font-size: var(--fs-md);
      font-weight: 500;
      color: var(--noir-absolu);
    }
    
    .spheres-selection {
      background: var(--creme-chaud);
      border: 2px solid var(--border-leger);
      border-radius: var(--radius-lg);
      padding: var(--s-4);
      margin-top: var(--s-4);
    }
    
    .spheres-label {
      font-size: var(--fs-sm);
      font-weight: 600;
      color: var(--noir-absolu);
      margin-bottom: var(--s-3);
    }
    
    .spheres-checkboxes {
      display: flex;
      flex-wrap: wrap;
      gap: var(--s-4);
    }
    
    .spheres-checkboxes label {
      display: flex;
      align-items: center;
      gap: var(--s-2);
      font-size: var(--fs-sm);
      cursor: pointer;
      user-select: none;
    }
    
    .spheres-checkboxes input[type="checkbox"] {
      width: 18px;
      height: 18px;
      cursor: pointer;
      accent-color: var(--or-signature);
    }
    
    .navigation-buttons {
      display: flex;
      justify-content: space-between;
      gap: var(--s-4);
      margin-top: var(--s-8);
    }
    
    .dimension-card {
      background: var(--creme-chaud);
      border-radius: var(--radius-lg);
      padding: var(--s-6);
      margin-bottom: var(--s-4);
      border-left: 4px solid;
    }
    
    .dimension-card h3 {
      font-size: var(--fs-lg);
      margin-bottom: var(--s-4);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .dimension-bar {
      height: 12px;
      background: var(--border-subtil);
      border-radius: var(--radius-pill);
      overflow: hidden;
      margin-bottom: var(--s-3);
    }
    
    .dimension-bar-fill {
      height: 100%;
      border-radius: var(--radius-pill);
      transition: width 0.8s var(--ease-spring);
    }
    
    .dimension-level {
      font-size: var(--fs-sm);
      font-weight: 600;
    }
    
    .sphere-card {
      background: var(--blanc-surface);
      border-radius: var(--radius-lg);
      padding: var(--s-6);
      margin-bottom: var(--s-6);
      box-shadow: var(--shadow-medium);
      border-left: 4px solid;
    }
    
    .sphere-card h3 {
      font-size: var(--fs-xl);
      margin-bottom: var(--s-4);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .convergence-indicator {
      display: inline-block;
      padding: var(--s-2) var(--s-3);
      border-radius: var(--radius-md);
      font-size: var(--fs-xs);
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .convergence-low { background: rgba(16,185,129,0.15); color: #065f46; }
    .convergence-medium { background: rgba(234,179,8,0.15); color: #854d0e; }
    .convergence-high { background: rgba(220,38,38,0.15); color: #7f1d1d; }
    .convergence-critical { background: rgba(127,29,29,0.25); color: #7f1d1d; font-weight: 900; }
    
    .interpretation-block {
      background: var(--creme-chaud);
      border-left: 4px solid var(--or-signature);
      border-radius: var(--radius-md);
      padding: var(--s-6);
      margin-bottom: var(--s-6);
    }
    
    .interpretation-block h4 {
      font-family: 'Inter', sans-serif;
      font-size: var(--fs-md);
      font-weight: 700;
      color: var(--noir-absolu);
      margin-bottom: var(--s-3);
    }
    
    .interpretation-block p {
      font-size: var(--fs-sm);
      line-height: var(--lh-relaxed);
      color: rgba(10,10,10,0.8);
      margin-bottom: 0;
    }
    
    .recommendations-list {
      background: var(--blanc-surface);
      border-radius: var(--radius-2xl);
      padding: var(--s-12);
      margin-bottom: var(--s-8);
      box-shadow: var(--shadow-large);
    }
    
    .recommendation-item {
      background: var(--creme-chaud);
      border-left: 4px solid var(--or-signature);
      border-radius: var(--radius-md);
      padding: var(--s-4);
      margin-bottom: var(--s-3);
      font-size: var(--fs-sm);
      line-height: var(--lh-relaxed);
    }
    
    .emergency-resources {
      background: #fee2e2;
      border: 2px solid #dc2626;
      border-radius: var(--radius-lg);
      padding: var(--s-6);
      margin-bottom: var(--s-8);
    }
    
    .emergency-resources h3 {
      color: #7f1d1d;
      font-size: var(--fs-xl);
      margin-bottom: var(--s-4);
    }
    
    .emergency-item {
      background: white;
      border-radius: var(--radius-md);
      padding: var(--s-4);
      margin-bottom: var(--s-3);
      display: flex;
      gap: var(--s-4);
      align-items: center;
    }
    
    .emergency-number {
      font-family: 'Fraunces', serif;
      font-size: var(--fs-2xl);
      font-weight: 700;
      color: #dc2626;
      flex-shrink: 0;
    }
    
    .emergency-desc {
      font-size: var(--fs-sm);
      color: var(--noir-doux);
      line-height: var(--lh-normal);
    }
    
    .site-footer {
      background: var(--noir-surface);
      color: var(--creme-principal);
      padding: var(--s-16) 0 var(--s-8);
      margin-top: var(--s-20);
      border-top: 1px solid rgba(199,168,109,0.2);
    }
    
    .footer-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 var(--s-6);
      display: grid;
      grid-template-columns: 1.5fr 1fr 1fr 1fr;
      gap: var(--s-12);
    }
    
    .footer-brand { padding-right: var(--s-8); }
    
    .footer-logo {
      font-family: 'Fraunces', Georgia, serif;
      font-size: var(--fs-2xl);
      font-weight: 700;
      color: var(--creme-principal);
      margin-bottom: var(--s-3);
      letter-spacing: 0.5px;
    }
    
    .footer-logo span { color: var(--or-signature); }
    
    .footer-tagline {
      font-size: var(--fs-sm);
      color: rgba(247,245,239,0.7);
      margin-bottom: var(--s-6);
      font-style: italic;
    }
    
    .footer-copyright {
      font-size: var(--fs-xs);
      color: rgba(247,245,239,0.5);
      margin-bottom: 0;
    }
    
    .footer-heading {
      font-family: 'Inter', sans-serif;
      font-size: var(--fs-sm);
      font-weight: 700;
      color: var(--or-signature);
      margin-bottom: var(--s-4);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .footer-links {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    
    .footer-links li { margin-bottom: var(--s-2); }
    
    .footer-links a {
      font-size: var(--fs-sm);
      color: rgba(247,245,239,0.8);
      text-decoration: none;
      transition: color var(--duration-fast) var(--ease-standard);
      display: inline-block;
    }
    
    .footer-links a:hover { color: var(--or-signature); }
    
    @media (max-width: 1024px) {
      .footer-container {
        grid-template-columns: 1fr 1fr;
        gap: var(--s-8);
      }
      
      .footer-brand {
        grid-column: 1 / -1;
        padding-right: 0;
        margin-bottom: var(--s-6);
      }
    }
    
    @media (max-width: 768px) {
      :root {
        --fs-3xl: 32px;
        --fs-2xl: 24px;
        --fs-xl: 21px;
      }
      
      .app-container { padding: var(--s-8) var(--s-4); }
      .card, .question-card { padding: var(--s-8); }
      .btn-group { flex-direction: column; }
      .btn-group button, .btn-group a { min-width: 100%; }
    }
    
    @media (max-width: 640px) {
      .footer-container { grid-template-columns: 1fr; }
      .site-footer {
        padding: var(--s-12) 0 var(--s-6);
        margin-top: var(--s-16);
      }
      .spheres-checkboxes { flex-direction: column; }
    }
    
    .text-center { text-align: center; }
  </style>
</head>
<body>
  
  <header class="site-header">
    <div class="header-container">
      <a href="../index.html" class="site-logo">
        NOÉSIS<span>.</span>
      </a>

      <button class="mobile-menu-toggle" onclick="toggleMobileMenu()" aria-label="Menu">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="3" y1="12" x2="21" y2="12"></line>
          <line x1="3" y1="6" x2="21" y2="6"></line>
          <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </button>

      <nav class="site-nav" id="main-nav">
        <a href="../index.html#accueil" class="nav-link">Accueil</a>
        <a href="../index.html#methode" class="nav-link">La Méthode</a>
        <a href="../index.html#decouvrir" class="nav-link">Découvrir</a>
        <a href="../Articles/articles-index.html" class="nav-link">Articles</a>
        <a href="./autotests.html" class="nav-link active">Auto-tests</a>
        <a href="../Podcasts/podcast.html" class="nav-link">Podcasts</a>
        <a href="../Livres/livres.html" class="nav-link">Livres</a>
        <a href="../Accompagnement/accompagnement.html" class="nav-link">Accompagnement</a>
        <a href="../index.html#engagement" class="nav-link">Engagement</a>
      </nav>
    </div>
  </header>
  
  <div class="app-container">
    
    <div class="progress-container" id="progress-container">
      <div class="progress-text">
        <span>Question <span id="progress-current">1</span> sur <span id="progress-total">30</span></span>
        <span id="progress-percentage">0%</span>
      </div>
      <div class="progress-bar">
        <div class="progress-bar-fill" id="progress-fill" style="width: 0%"></div>
      </div>
    </div>
    
    <div id="intro" class="screen active">
      <div class="card">
        <h1>
          <svg class="card-icon" viewBox="0 0 24 24">
            <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
            <path d="M2 17l10 5 10-5M2 12l10 5 10-5"></path>
          </svg>
          Cartographie Clinique des Violences Subies
        </h1>
        
        <p style="font-size: var(--fs-lg); color: var(--noir-doux); margin-top: var(--s-6);">
          Outil de repérage quasi-psychométrique conçu pour cartographier l'exposition aux violences selon cinq dimensions cliniques (psychologiques, physiques, sexuelles, économiques, institutionnelles) et cinq sphères de vie (intime, familiale, professionnelle, institutionnelle, autre).
        </p>
        
        <p style="font-size: var(--fs-md); color: var(--noir-doux);">
          Cette évaluation ne constitue pas un diagnostic mais un outil d'objectivation permettant de révéler l'architecture écologique de la violence — notamment les convergences traumatiques et saturations multi-sphériques souvent invisibles dans le récit linéaire.
        </p>
      </div>
      
      <div class="card">
        <h2>
          <svg class="card-icon" viewBox="0 0 24 24">
            <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
            <path d="M2 17l10 5 10-5M2 12l10 5 10-5"></path>
          </svg>
          Dimensions Évaluées
        </h2>
        <p>Ce questionnaire évalue cinq dimensions de violences, identifiées dans la recherche contemporaine comme structurant les dynamiques de domination et de trauma complexe relationnel.</p>
        
        <ul class="dimensions-list">
          <li class="dimension-item" style="color: var(--vio-psycho-color); background: var(--vio-psycho-bg)">
            <strong>Violences Psychologiques & Contrôle</strong>
            <p>Minimisation émotionnelle, gaslighting, menaces, isolement, surveillance intrusive. Capture la dissonance cognitive coercitive et l'adaptation pathologique permanente.</p>
          </li>
          
          <li class="dimension-item" style="color: var(--vio-physique-color); background: var(--vio-physique-bg)">
            <strong>Violences Physiques</strong>
            <p>Intimidation corporelle, destruction d'objets, agressions directes, menaces physiques. De l'escalade progressive à la normalisation de la violence « mineure ».</p>
          </li>
          
          <li class="dimension-item" style="color: var(--vio-sexuelle-color); background: var(--vio-sexuelle-bg)">
            <strong>Violences Sexuelles</strong>
            <p>Coercition, pressions affectives, actes non consentis, instrumentalisation de la sexualité. Mesure via description comportementale pour contourner le déni fréquent.</p>
          </li>
          
          <li class="dimension-item" style="color: var(--vio-eco-color); background: var(--vio-eco-bg)">
            <strong>Violences Économiques & Matérielles</strong>
            <p>Contrôle financier, sabotage de l'autonomie, dépendance organisée, précarisation. Verrou majeur de l'isolation cognitive systémique souvent sous-estimé.</p>
          </li>
          
          <li class="dimension-item" style="color: var(--vio-instit-color); background: var(--vio-instit-bg)">
            <strong>Violences Institutionnelles</strong>
            <p>Disqualification professionnelle, revictimisation procédurale, inversion de la charge de la preuve. Ce qui empêche la résilience en transformant les dispositifs d'aide en prolongements du système violent.</p>
          </li>
        </ul>
      </div>
      
      <div class="card">
        <h2>
          <svg class="card-icon" viewBox="0 0 24 24">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
            <line x1="9" y1="3" x2="9" y2="21"></line>
          </svg>
          Méthodologie
        </h2>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--s-6); margin-top: var(--s-6);">
          <div style="text-align: center;">
            <div style="width: 60px; height: 60px; margin: 0 auto var(--s-3); background: var(--or-subtil); border: 2px solid var(--or-signature); border-radius: var(--radius-lg); display: flex; align-items: center; justify-content: center;">
              <svg style="width: 30px; height: 30px; stroke: var(--or-signature); fill: none;" viewBox="0 0 24 24">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
              </svg>
            </div>
            <div style="font-weight: 700; font-size: var(--fs-lg); margin-bottom: var(--s-2);">30 Questions</div>
            <div style="font-size: var(--fs-sm); color: rgba(10,10,10,0.6);">Évaluation complète approfondie</div>
          </div>
          
          <div style="text-align: center;">
            <div style="width: 60px; height: 60px; margin: 0 auto var(--s-3); background: var(--or-subtil); border: 2px solid var(--or-signature); border-radius: var(--radius-lg); display: flex; align-items: center; justify-content: center;">
              <svg style="width: 30px; height: 30px; stroke: var(--or-signature); fill: none;" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12 6 12 12 16 14"></polyline>
              </svg>
            </div>
            <div style="font-weight: 700; font-size: var(--fs-lg); margin-bottom: var(--s-2);">12-18 Minutes</div>
            <div style="font-size: var(--fs-sm); color: rgba(10,10,10,0.6);">Temps estimé de passation</div>
          </div>
          
          <div style="text-align: center;">
            <div style="width: 60px; height: 60px; margin: 0 auto var(--s-3); background: var(--or-subtil); border: 2px solid var(--or-signature); border-radius: var(--radius-lg); display: flex; align-items: center; justify-content: center;">
              <svg style="width: 30px; height: 30px; stroke: var(--or-signature); fill: none;" viewBox="0 0 24 24">
                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
              </svg>
            </div>
            <div style="font-weight: 700; font-size: var(--fs-lg); margin-bottom: var(--s-2);">100% Anonyme</div>
            <div style="font-size: var(--fs-sm); color: rgba(10,10,10,0.6);">Données strictement confidentielles</div>
          </div>
          
          <div style="text-align: center;">
            <div style="width: 60px; height: 60px; margin: 0 auto var(--s-3); background: var(--or-subtil); border: 2px solid var(--or-signature); border-radius: var(--radius-lg); display: flex; align-items: center; justify-content: center;">
              <svg style="width: 30px; height: 30px; stroke: var(--or-signature); fill: none;" viewBox="0 0 24 24">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="7 10 12 15 17 10"></polyline>
                <line x1="12" y1="15" x2="12" y2="3"></line>
              </svg>
            </div>
            <div style="font-weight: 700; font-size: var(--fs-lg); margin-bottom: var(--s-2);">Export Complet</div>
            <div style="font-size: var(--fs-sm); color: rgba(10,10,10,0.6);">Rapport détaillé téléchargeable</div>
          </div>
        </div>
        
        <div style="margin-top: var(--s-8); padding: var(--s-6); background: var(--creme-chaud); border-radius: var(--radius-lg); border-left: 4px solid var(--or-signature);">
          <p style="font-size: var(--fs-sm); margin: 0;"><strong>Cadre théorique :</strong> Cet outil s'appuie sur les modèles neuropsychologiques des fonctions exécutives et de la régulation émotionnelle dans le TDAH adulte (ASRS, Conners), ainsi que sur les recherches contemporaines en trauma complexe relationnel et dynamiques d'emprise coercitive.</p>
        </div>
        
        <div style="margin-top: var(--s-4); padding: var(--s-6); background: rgba(220,38,38,0.05); border-radius: var(--radius-lg); border-left: 4px solid #dc2626;">
          <p style="font-size: var(--fs-sm); margin: 0; color: rgba(10,10,10,0.8);"><strong>Validité :</strong> Outil de sensibilisation non validé psychométriquement. Ne constitue pas un instrument diagnostique. Les résultats doivent être interprétés par un professionnel qualifié.</p>
        </div>
      </div>
      
      <div class="warning-box">
        <h3>
          <svg class="warning-icon" viewBox="0 0 24 24">
            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
            <line x1="12" y1="9" x2="12" y2="13"></line>
            <line x1="12" y1="17" x2="12.01" y2="17"></line>
          </svg>
          Avertissement Essentiel — Étape Zéro
        </h3>
        <p><strong>Cet outil est strictement informatif et éducatif.</strong> Il ne constitue en aucun cas un diagnostic clinique, un avis médical, ni un conseil juridique personnalisé. Il s'agit d'une <strong>étape zéro</strong> permettant l'objectivation préalable avant toute démarche formelle.</p>
        <p>Les résultats doivent être interprétés avec prudence et ne remplacent jamais une évaluation par un professionnel qualifié (psychologue spécialisé trauma, psychiatre, juriste en droit des victimes).</p>
        <p><strong>Si vous êtes en situation de danger immédiat, contactez les services d'urgence (17 en France) ou les lignes d'écoute spécialisées (3919 — Violences Femmes Info).</strong></p>
      </div>
      
      <div class="card">
        <h3>
          <svg class="card-icon" viewBox="0 0 24 24">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
            <polyline points="14 2 14 8 20 8"></polyline>
            <line x1="16" y1="13" x2="8" y2="13"></line>
            <line x1="16" y1="17" x2="8" y2="17"></line>
            <polyline points="10 9 9 9 8 9"></polyline>
          </svg>
          Contexte d'Évaluation
        </h3>
        
        <p style="font-size: var(--fs-sm); color: var(--noir-doux); margin-bottom: var(--s-6);">
          Ces informations permettent d'affiner l'interprétation de vos résultats. Elles restent strictement confidentielles et ne sont jamais transmises.
        </p>
        
        <div class="form-group">
          <label class="form-label" for="user-name">Prénom ou pseudonyme (facultatif)</label>
          <input type="text" id="user-name" class="form-input" placeholder="Ex: Marie">
        </div>
        
        <div class="form-group">
          <label class="form-label" for="user-age">Âge (facultatif)</label>
          <input type="number" id="user-age" class="form-input" min="13" max="120" placeholder="Ex: 28">
        </div>
        
        <div class="checkbox-group">
          <input type="checkbox" id="consent-checkbox" onchange="updateConsentButton()">
          <label for="consent-checkbox">
            J'ai lu et compris l'avertissement. Je confirme que je complète cet auto-test de manière volontaire et éclairée, et que je ne me trouve pas dans une situation nécessitant une assistance d'urgence immédiate. Je comprends que cet outil ne remplace pas une évaluation clinique formelle.
          </label>
        </div>
        
        <div style="margin-top: var(--s-8); text-align: center;">
          <button id="start-btn" class="btn-primary btn-start-evaluation" onclick="startTest()" disabled>
            Commencer l'Évaluation
          </button>
        </div>
      </div>
    </div>
    
    <div id="questionnaire" class="screen">
      <div id="question-container"></div>
      
      <div class="navigation-buttons">
        <button class="btn-secondary" onclick="prevQuestion()" id="prev-btn">
          ← Question Précédente
        </button>
        <button class="btn-primary" onclick="nextQuestion()" id="next-btn" disabled>
          Question Suivante →
        </button>
      </div>
    </div>
    
    <div id="results" class="screen">
      <div id="results-content"></div>
    </div>
    
  </div>
  
  <footer class="site-footer">
    <div class="footer-container">
      <div class="footer-brand">
        <div class="footer-logo">NOÉSIS<span>.</span></div>
        <p class="footer-tagline">Intelligence transdisciplinaire</p>
        <p class="footer-copyright">© 2025 NOÉSIS — Tous droits réservés</p>
      </div>
      
      <div class="footer-nav">
        <div class="footer-column">
          <h4 class="footer-heading">Navigation</h4>
          <ul class="footer-links">
            <li><a href="../index.html#accueil">Accueil</a></li>
            <li><a href="../index.html#methode">La Méthode</a></li>
            <li><a href="../index.html#decouvrir">Découvrir</a></li>
            <li><a href="../Articles/articles-index.html">Articles</a></li>
            <li><a href="./autotests.html">Auto-tests</a></li>
          </ul>
        </div>

        <div class="footer-column">
          <h4 class="footer-heading">Ressources</h4>
          <ul class="footer-links">
            <li><a href="../Podcasts/podcast.html">Podcasts</a></li>
            <li><a href="../Livres/livres.html">Livres</a></li>
            <li><a href="../Accompagnement/accompagnement.html">Accompagnement</a></li>
            <li><a href="../index.html#engagement">Engagement</a></li>
            <li><a href="../index.html#contact">Contact</a></li>
          </ul>
        </div>

        <div class="footer-column">
          <h4 class="footer-heading">Légal</h4>
          <ul class="footer-links">
            <li><a href="../plan-securite.html">Plan de Sécurité</a></li>
            <li><a href="../conditions-generales.html">Conditions Générales</a></li>
            <li><a href="../mentions-legales.html">Mentions Légales</a></li>
            <li><a href="../confidentialite.html">Confidentialité</a></li>
          </ul>
        </div>
      </div>
    </div>
  </footer>
  
  <script>
    const TEST_NAME = "Cartographie Clinique des Violences Subies";
    const TEST_VERSION = "1.0.0";
    
    const AXES = [
      {key: "vio-psycho", label: "Violences Psychologiques & Contrôle", color: "#dc2626"},
      {key: "vio-physique", label: "Violences Physiques", color: "#ea580c"},
      {key: "vio-sexuelle", label: "Violences Sexuelles", color: "#7c3aed"},
      {key: "vio-eco", label: "Violences Économiques & Matérielles", color: "#0891b2"},
      {key: "vio-instit", label: "Violences Institutionnelles", color: "#2563eb"}
    ];
    
    const SPHERES = [
      {key: "I", label: "Intime / Couple / Sexualité", color: "#dc2626"},
      {key: "F", label: "Familiale / Proches", color: "#ea580c"},
      {key: "P", label: "Professionnelle / Études", color: "#0891b2"},
      {key: "S", label: "Institutionnelle", color: "#2563eb"},
      {key: "A", label: "Autre contexte", color: "#64748b"}
    ];
    
    const SCALE = [
      {v: 0, l: "Jamais", d: "Jamais ou une seule fois de manière isolée"},
      {v: 1, l: "Quelques fois", d: "2 à 5 occurrences dans la durée"},
      {v: 2, l: "Régulièrement", d: "Au moins 1 fois/mois pendant 3+ mois"},
      {v: 3, l: "Souvent", d: "Au moins 1 fois/semaine pendant 3+ mois"},
      {v: 4, l: "Très souvent", d: "Quotidien ou actuellement en cours"}
    ];
    
    const QUESTIONS = [
      // DIMENSION 1 : Violences Psychologiques & Contrôle (6 items)
      {i: "q1", t: "On minimise régulièrement vos émotions, vos réactions ou vos besoins en vous disant que vous « exagérez », que vous êtes « trop sensible » ou que « ce n'est pas si grave ».", a: "vio-psycho"},
      {i: "q2", t: "Vous adaptez constamment votre comportement, vos propos ou vos activités par anticipation de la réaction de l'autre, par peur d'une crise ou d'une sanction (silence, reproches, menaces).", a: "vio-psycho"},
      {i: "q3", t: "On utilise des menaces de rupture, d'abandon, de représailles ou de sanction comme moyen de vous faire céder ou obéir.", a: "vio-psycho"},
      {i: "q4", t: "On remet en question votre perception de la réalité en niant des faits, en réécrivant l'histoire des événements ou en vous faisant douter de votre mémoire ou de votre jugement.", a: "vio-psycho"},
      {i: "q5", t: "On vous isole progressivement de vos proches, de vos ami·es ou de vos activités en critiquant ces liens, en créant des conflits ou en rendant difficile leur maintien.", a: "vio-psycho"},
      {i: "q6", t: "On exerce un contrôle sur vos déplacements, vos fréquentations, votre téléphone, vos réseaux sociaux ou votre emploi du temps de manière systématique et intrusive.", a: "vio-psycho"},
      
      // DIMENSION 2 : Violences Physiques (6 items)
      {i: "q7", t: "On adopte des comportements physiquement intimidants : gestes brusques, destruction d'objets, coups portés à proximité, blocage de votre déplacement.", a: "vio-physique"},
      {i: "q8", t: "Vous avez subi des violences physiques directes : bousculades, empoignades, gifles, coups, étranglements, séquestration.", a: "vio-physique"},
      {i: "q9", t: "On utilise la menace de violence physique comme moyen de contrôle même sans passage à l'acte systématique.", a: "vio-physique"},
      {i: "q10", t: "Après des épisodes de violence physique, on minimise, justifie ou nie ce qui s'est passé, vous rendant responsable de la « provocation ».", a: "vio-physique"},
      {i: "q11", t: "Vous avez dû dissimuler des traces de violence (bleus, blessures) ou mentir sur leur origine par peur, honte ou protection de l'agresseur.", a: "vio-physique"},
      {i: "q12", t: "La violence physique est présentée comme « normale », « méritée » ou « éducative » dans votre environnement.", a: "vio-physique"},
      
      // DIMENSION 3 : Violences Sexuelles (6 items)
      {i: "q13", t: "On vous impose ou vous presse d'avoir des pratiques sexuelles qui vous mettent mal à l'aise, que vous ne souhaitez pas ou auxquelles vous n'avez pas consenti clairement.", a: "vio-sexuelle"},
      {i: "q14", t: "Votre refus de relations ou d'actes sexuels déclenche reproches, menaces, culpabilisation, punitions affectives ou représailles.", a: "vio-sexuelle"},
      {i: "q15", t: "On vous instrumentalise sexuellement comme « preuve d'amour », monnaie d'échange, obligation relationnelle ou moyen de réconciliation après conflit.", a: "vio-sexuelle"},
      {i: "q16", t: "Vous avez subi des actes sexuels alors que vous étiez dans l'incapacité de consentir (sommeil, alcool, sidération, contrainte).", a: "vio-sexuelle"},
      {i: "q17", t: "On diffuse, menace de diffuser ou utilise contre vous des images, vidéos ou informations à caractère sexuel ou intime sans votre accord.", a: "vio-sexuelle"},
      {i: "q18", t: "Vous ressentez une obligation d'accepter des relations sexuelles pour « éviter pire » (conflit, violence, rupture, représailles).", a: "vio-sexuelle"},
      
      // DIMENSION 4 : Violences Économiques & Matérielles (6 items)
      {i: "q19", t: "On contrôle vos ressources financières : accès aux comptes, décisions d'achat, justification des dépenses, confiscation de revenus.", a: "vio-eco"},
      {i: "q20", t: "On sabote activement votre autonomie financière ou professionnelle (empêcher de travailler, créer obstacles à formation/emploi, décrédibiliser professionnellement).", a: "vio-eco"},
      {i: "q21", t: "On vous impose des dettes, des dépenses non voulues ou on vous rend responsable de difficultés financières créées par l'autre.", a: "vio-eco"},
      {i: "q22", t: "Vous êtes maintenu·e dans une dépendance matérielle organisée rendant difficile ou impossible un départ (logement, ressources, administratif).", a: "vio-eco"},
      {i: "q23", t: "On utilise l'argent, les biens matériels ou le logement comme levier de domination, de chantage ou de rétention.", a: "vio-eco"},
      {i: "q24", t: "Vous subissez une précarisation économique directement liée aux violences subies (perte emploi, dettes, dégradation situation matérielle).", a: "vio-eco"},
      
      // DIMENSION 5 : Violences Institutionnelles (6 items)
      {i: "q25", t: "Des professionnel·les (santé, justice, police, social, éducation) ont minimisé, banalisé ou disqualifié votre parole lorsque vous avez évoqué les violences.", a: "vio-instit"},
      {i: "q26", t: "Vous avez renoncé à demander de l'aide ou à engager des démarches par anticipation du traitement que vous recevriez (être mal reçu·e, non cru·e, jugé·e, revictimisé·e).", a: "vio-instit"},
      {i: "q27", t: "Des institutions ou professionnel·les vous ont retourné la responsabilité de la violence subie (« qu'avez-vous fait pour provoquer ça ? », « pourquoi vous restez ? »).", a: "vio-instit"},
      {i: "q28", t: "Vous avez subi des procédures judiciaires, administratives ou médicales qui vous ont exposé·e à davantage de violence, d'humiliation ou d'injustice.", a: "vio-instit"},
      {i: "q29", t: "On a utilisé contre vous le système institutionnel (menaces de plainte, instrumentalisation de la justice, pressions via services sociaux, allégations parentales mensongères).", a: "vio-instit"},
      {i: "q30", t: "Vous considérez que les institutions censées protéger sont devenues des lieux de danger, d'impuissance ou d'injustice dans votre trajectoire.", a: "vio-instit"}
    ];
    
    let state = {
      currentScreen: 'intro',
      currentQuestionIndex: 0,
      answers: {},
      spheres: {},
      anamnesis: {
        name: '',
        age: null
      },
      startTime: null,
      completionTime: null
    };
    
    function toggleMobileMenu() {
      const nav = document.getElementById('main-nav');
      nav.classList.toggle('active');
    }
    
    function showScreen(screenId) {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById(screenId).classList.add('active');
      state.currentScreen = screenId;
      window.scrollTo({top: 0, behavior: 'smooth'});
    }
    
    function updateConsentButton() {
      const consent = document.getElementById('consent-checkbox').checked;
      document.getElementById('start-btn').disabled = !consent;
    }
    
    function startTest() {
      state.anamnesis.name = document.getElementById('user-name').value || 'Anonyme';
      state.anamnesis.age = parseInt(document.getElementById('user-age').value) || null;
      
      state.startTime = Date.now();
      showScreen('questionnaire');
      document.getElementById('progress-container').classList.add('active');
      document.getElementById('progress-total').textContent = QUESTIONS.length;
      renderQuestion();
    }
    
    function renderQuestion() {
      const q = QUESTIONS[state.currentQuestionIndex];
      const currentAnswer = state.answers[q.i] || null;
      const currentSpheres = state.spheres[q.i] || [];
      
      document.getElementById('progress-current').textContent = state.currentQuestionIndex + 1;
      const percent = Math.round(((state.currentQuestionIndex + 1) / QUESTIONS.length) * 100);
      document.getElementById('progress-percentage').textContent = percent + '%';
      document.getElementById('progress-fill').style.width = percent + '%';
      
      document.getElementById('prev-btn').disabled = state.currentQuestionIndex === 0;
      
      const hasAnswer = currentAnswer !== null;
      const hasSphere = currentSpheres.length > 0 || currentAnswer === 0;
      document.getElementById('next-btn').disabled = !(hasAnswer && hasSphere);
      
      if (state.currentQuestionIndex === QUESTIONS.length - 1) {
        document.getElementById('next-btn').textContent = 'Terminer & Voir Résultats →';
      } else {
        document.getElementById('next-btn').textContent = 'Question Suivante →';
      }
      
      const html = `
        <div class="question-card">
          <div class="question-number">Question ${state.currentQuestionIndex + 1} sur ${QUESTIONS.length}</div>
          <div class="question-text">${q.t}</div>
          
          <div class="answer-options">
            ${SCALE.map(opt => `
              <div class="answer-option ${currentAnswer === opt.v ? 'selected' : ''}" onclick="selectAnswer(${opt.v})">
                <div class="answer-radio"></div>
                <div class="answer-label">
                  <strong>${opt.l}</strong>
                  <div style="font-size:var(--fs-sm);color:var(--noir-doux);margin-top:4px">${opt.d}</div>
                </div>
              </div>
            `).join('')}
          </div>
          
          <div class="spheres-selection" id="spheres-selection" style="${currentAnswer === 0 ? 'display:none' : ''}">
            <p class="spheres-label">Dans quel(s) contexte(s) de vie avez-vous vécu cette situation ?</p>
            <div class="spheres-checkboxes">
              ${SPHERES.map(sph => `
                <label>
                  <input 
                    type="checkbox" 
                    value="${sph.key}" 
                    ${currentSpheres.includes(sph.key) ? 'checked' : ''}
                    onchange="updateSpheres()">
                  ${sph.label}
                </label>
              `).join('')}
            </div>
          </div>
        </div>
      `;
      
      document.getElementById('question-container').innerHTML = html;
    }
    
    function selectAnswer(value) {
      state.answers[QUESTIONS[state.currentQuestionIndex].i] = value;
      
      if (value === 0) {
        state.spheres[QUESTIONS[state.currentQuestionIndex].i] = [];
      }
      
      renderQuestion();
      
      if (value === 0) {
        setTimeout(() => nextQuestion(), 300);
      }
    }
    
    function updateSpheres() {
      const checkboxes = document.querySelectorAll('.spheres-checkboxes input[type="checkbox"]');
      const selected = [];
      checkboxes.forEach(cb => {
        if (cb.checked) selected.push(cb.value);
      });
      state.spheres[QUESTIONS[state.currentQuestionIndex].i] = selected;
      renderQuestion();
    }
    
    function nextQuestion() {
      if (state.currentQuestionIndex < QUESTIONS.length - 1) {
        state.currentQuestionIndex++;
        renderQuestion();
      } else {
        state.completionTime = Date.now();
        showResults();
      }
    }
    
    function prevQuestion() {
      if (state.currentQuestionIndex > 0) {
        state.currentQuestionIndex--;
        renderQuestion();
      }
    }
    
    function calculateScores() {
      const dimensions = {};
      const spheres = {};
      const convergence = {};
      
      AXES.forEach(ax => dimensions[ax.key] = {score: 0, max: 0, pct: 0});
      SPHERES.forEach(sp => spheres[sp.key] = {score: 0, max: 0, pct: 0, dimensions: {}, count: 0});
      
      QUESTIONS.forEach(q => {
        const answer = state.answers[q.i] || 0;
        const selectedSpheres = state.spheres[q.i] || [];
        
        dimensions[q.a].score += answer;
        dimensions[q.a].max += 4;
        
        selectedSpheres.forEach(sph => {
          if (!spheres[sph].dimensions[q.a]) {
            spheres[sph].dimensions[q.a] = {score: 0, max: 0};
          }
          spheres[sph].dimensions[q.a].score += answer;
          spheres[sph].dimensions[q.a].max += 4;
          spheres[sph].score += answer;
          spheres[sph].max += 4;
          spheres[sph].count++;
        });
      });
      
      Object.keys(dimensions).forEach(k => {
        if (dimensions[k].max > 0) {
          dimensions[k].pct = Math.round((dimensions[k].score / dimensions[k].max) * 100);
        }
      });
      
      Object.keys(spheres).forEach(k => {
        if (spheres[k].max > 0) {
          spheres[k].pct = Math.round((spheres[k].score / spheres[k].max) * 100);
          
          convergence[k] = 0;
          Object.keys(spheres[k].dimensions).forEach(dim => {
            const dimPct = (spheres[k].dimensions[dim].score / spheres[k].dimensions[dim].max) * 100;
            if (dimPct > 50) convergence[k]++;
          });
        }
      });
      
      const saturation = Object.values(spheres).filter(s => s.pct >= 40).length;
      const saturationPct = Math.round((saturation / SPHERES.length) * 100);
      
      const maxConvergence = Math.max(...Object.values(convergence), 0);
      
      return {dimensions, spheres, convergence, saturation, saturationPct, maxConvergence};
    }
    
    function getInterpretationDimension(pct) {
      if (pct < 20) return {level: "Exposition nulle à faible", severity: "low", text: "Expériences ponctuelles non structurantes."};
      if (pct < 40) return {level: "Exposition modérée", severity: "medium", text: "Signaux d'alerte. Environnement relationnel instable. Début possible de normalisation des micro-violences."};
      if (pct < 60) return {level: "Exposition significative", severity: "high", text: "Configuration à risque de dissonance cognitive coercitive. Indicateurs d'adaptation pathologique aux violences."};
      if (pct < 80) return {level: "Exposition élevée", severity: "critical", text: "Risque majeur d'effondrement progressif de l'agentivité. Capture identitaire probable."};
      return {level: "Exposition massive", severity: "critical", text: "Configuration typique de trauma complexe relationnel avec atteinte profonde de la capacité réflexive."};
    }
    
    function getInterpretationSphere(key, pct, conv) {
      const interpretations = {
        "I": {
          low: "Relation actuelle ou passée non marquée par climat violent systémique.",
          medium: "Environnement relationnel intime instable avec dynamiques coercitives répétées. Risque de dissonance cognitive (justification de ce qui détruit).",
          high: "Configuration compatible avec emprise relationnelle caractérisée et capture identitaire progressive. Effondrement de l'agentivité intime probable.",
          critical: "Emprise relationnelle majeure avec convergence de plusieurs types de violences. Nécessite évaluation clinique approfondie et éventuel accompagnement juridique."
        },
        "P": {
          low: "Environnement professionnel globalement préservé.",
          medium: "Environnement de travail à risque. Normalisation progressive de micro-violences, loyauté forcée, peur diffuse de représailles.",
          high: "Contexte professionnel toxique caractérisé. Harcèlement systémique. Risque élevé d'isolement cognitif systémique.",
          critical: "Violences professionnelles majeures avec convergence. Souvent associé à décompensation psychique, arrêts maladie répétés, renoncement professionnel."
        },
        "S": {
          low: "Expériences ponctuelles de non-écoute mais non structurantes.",
          medium: "Trajectoire marquée par rencontres répétées avec dispositifs invalidants. Risque de renoncement durable à l'aide.",
          high: "Violences institutionnelles structurantes ayant dégradé durablement capacité à chercher aide. Verrouille résilience post-traumatique.",
          critical: "Violences institutionnelles massives. Institutions devenues lieux de danger. Urgence de reconstruction de liens avec professionnels bienveillants."
        },
        "F": {
          low: "Sphère familiale globalement préservée.",
          medium: "Violences familiales modérées ou soutien familial défaillant face aux violences subies ailleurs.",
          high: "Violences familiales significatives ou famille renforçant l'emprise plutôt que protégeant.",
          critical: "Violences familiales majeures avec convergence. Configuration où la sphère familiale amplifie l'effondrement de l'agentivité."
        },
        "A": {
          low: "Autres contextes préservés.",
          medium: "Violences modérées dans d'autres contextes (voisinage, rue, communauté).",
          high: "Violences significatives dans autres contextes contribuant à saturation traumatique.",
          critical: "Violences massives dans autres contextes. Contribution majeure à écosystème violent global."
        }
      };
      
      let severity = "low";
      if (pct >= 60 || conv >= 3) severity = "critical";
      else if (pct >= 40 || conv >= 2) severity = "high";
      else if (pct >= 25) severity = "medium";
      
      return {
        severity,
        text: interpretations[key][severity]
      };
    }
    
    function showResults() {
      showScreen('results');
      document.getElementById('progress-container').classList.remove('active');
      const scores = calculateScores();
      
      let html = `
        <div class="card">
          <h2>Profil d'Exposition aux Violences</h2>
          <p style="font-size:var(--fs-md);color:var(--noir-doux);margin-bottom:var(--s-8)">
            Cette cartographie révèle l'architecture écologique de votre exposition aux violences. L'analyse croise les types de violences subies et les sphères de vie concernées, permettant d'identifier les zones de convergence traumatique et les saturations multi-sphériques.
          </p>
        </div>
        
        <div class="card">
          <h2>Vue par Dimensions de Violence</h2>
          ${AXES.map(ax => {
            const dim = scores.dimensions[ax.key];
            const interp = getInterpretationDimension(dim.pct);
            return `
              <div class="dimension-card" style="border-color:${ax.color}">
                <h3>
                  <span>${ax.label}</span>
                  <span style="color:${ax.color}">${dim.pct}%</span>
                </h3>
                <div class="dimension-bar">
                  <div class="dimension-bar-fill" style="width:${dim.pct}%;background:${ax.color}"></div>
                </div>
                <div class="dimension-level" style="color:${ax.color}">
                  ${interp.level} — ${interp.text}
                </div>
              </div>
            `;
          }).join('')}
        </div>
        
        <div class="card">
          <h2>Vue par Sphères de Vie</h2>
          <p style="font-size:var(--fs-sm);color:var(--noir-doux);margin-bottom:var(--s-6)">
            L'indice de convergence mesure le nombre de types de violences présents dans une même sphère. Une convergence ≥ 3 dimensions indique un risque critique d'effondrement de l'agentivité dans cette sphère.
          </p>
          ${SPHERES.filter(sp => scores.spheres[sp.key].count > 0).map(sp => {
            const sph = scores.spheres[sp.key];
            const conv = scores.convergence[sp.key];
            const interp = getInterpretationSphere(sp.key, sph.pct, conv);
            let convClass = 'convergence-low';
            let convLabel = 'Convergence faible';
            if (conv >= 3) {
              convClass = 'convergence-critical';
              convLabel = `Convergence critique (${conv} dimensions)`;
            } else if (conv === 2) {
              convClass = 'convergence-high';
              convLabel = `Convergence élevée (${conv} dimensions)`;
            } else if (conv === 1) {
              convClass = 'convergence-medium';
              convLabel = `Convergence modérée (${conv} dimension)`;
            }
            
            return `
              <div class="sphere-card" style="border-color:${sp.color}">
                <h3>
                  <span>${sp.label}</span>
                  <span style="color:${sp.color}">${sph.pct}%</span>
                </h3>
                <div style="margin-bottom:var(--s-4)">
                  <span class="convergence-indicator ${convClass}">${convLabel}</span>
                </div>
                <div class="dimension-bar">
                  <div class="dimension-bar-fill" style="width:${sph.pct}%;background:${sp.color}"></div>
                </div>
                <p style="font-size:var(--fs-sm);color:var(--noir-doux);margin-top:var(--s-4);margin-bottom:0">
                  ${interp.text}
                </p>
              </div>
            `;
          }).join('')}
        </div>
        
        ${scores.saturation >= 3 ? `
          <div class="emergency-resources">
            <h3>⚠️ Écosystème Violent Global Détecté</h3>
            <p style="font-size:var(--fs-md);margin-bottom:var(--s-6);color:var(--noir-absolu)">
              Vos résultats révèlent une <strong>saturation multi-sphérique</strong> (${scores.saturation} sphères sur 5 avec exposition ≥ 40%). Cette configuration caractérise un écosystème violent global où vous ne disposez d'aucun refuge sûr. Il ne s'agit plus de « relation toxique isolée » mais d'une architecture traumatique systémique.
            </p>
            <p style="font-size:var(--fs-sm);margin-bottom:var(--s-4);color:var(--noir-doux)">
              <strong>Cela justifie une prise en charge clinique prioritaire et un accompagnement juridique si nécessaire.</strong>
            </p>
          </div>
        ` : ''}
        
        ${scores.maxConvergence >= 3 ? `
          <div class="emergency-resources">
            <h3>🔴 Convergence Traumatique Critique</h3>
            <p style="font-size:var(--fs-md);margin-bottom:var(--s-4);color:var(--noir-absolu)">
              Au moins une sphère de votre vie présente une <strong>convergence de ${scores.maxConvergence} types de violences</strong>. Cette accumulation multi-forme dans un même contexte est typique des configurations d'effondrement massif de l'agentivité et de capture identitaire progressive.
            </p>
            <p style="font-size:var(--fs-sm);color:var(--noir-doux)">
              Une évaluation clinique approfondie est fortement recommandée.
            </p>
          </div>
        ` : ''}
        
        <div class="card">
          <h2>Interprétation Clinique Générale</h2>
          
          ${scores.saturation >= 3 ? `
            <div class="interpretation-block">
              <h4>Configuration : Écosystème Violent Global</h4>
              <p>
                L'exposition aux violences traverse ${scores.saturation} sphères majeures de votre vie. Cette saturation multi-contextuelle empêche tout cloisonnement protecteur et vous prive de zones de ressourcement. La résilience post-traumatique devient structurellement compromise car chaque sphère renforce l'effondrement des autres. Cette architecture justifie une prise en charge globale et intensive.
              </p>
            </div>
          ` : scores.saturation === 2 ? `
            <div class="interpretation-block">
              <h4>Configuration : Bi-sphérique</h4>
              <p>
                Les violences touchent deux sphères majeures de votre vie. Particulièrement préoccupant si l'une des sphères est institutionnelle, car cela transforme les dispositifs de protection en prolongements du système violent et verrouille l'accès à l'aide.
              </p>
            </div>
          ` : `
            <div class="interpretation-block">
              <h4>Configuration : Mono-sphérique ou limitée</h4>
              <p>
                L'exposition aux violences reste concentrée sur une ou deux sphères. Bien que cette configuration permette un cloisonnement protecteur relatif avec des ressources potentielles dans les sphères préservées, toute violence répétée justifie une attention clinique et un accompagnement adapté.
              </p>
            </div>
          `}
          
          ${scores.maxConvergence >= 3 ? `
            <div class="interpretation-block">
              <h4>Convergence Multi-Dimensionnelle</h4>
              <p>
                La présence simultanée de plusieurs types de violences dans une même sphère (convergence ≥ 3 dimensions) caractérise les configurations les plus délétères. Cette accumulation multi-forme empêche toute adaptation viable : quand les violences psychologiques, physiques, sexuelles, économiques et institutionnelles se renforcent mutuellement, l'agentivité s'effondre de manière systémique. Chaque tentative d'échapper à un type de violence expose à un autre.
              </p>
            </div>
          ` : ''}
          
          <div class="interpretation-block">
            <h4>Rappel Fondamental</h4>
            <p>
              <strong>Cet outil constitue une étape zéro d'objectivation.</strong> Les scores ne mesurent pas votre « fragilité » mais la violence de l'environnement auquel vous avez été exposé·e. Des scores élevés ne signifient pas que vous êtes « cassé·e » mais que vous avez survécu à des configurations traumatiques majeures. Cette survie témoigne d'une résilience qui peut être soutenue et accompagnée par des professionnels formés au trauma complexe relationnel.
            </p>
          </div>
        </div>
        
        <div class="recommendations-list">
          <h3>Orientations & Recommandations</h3>
          
          ${Object.entries(scores.spheres)
            .filter(([k,v]) => v.pct >= 40)
            .map(([k,v]) => {
              const sphere = SPHERES.find(s => s.key === k);
              const recs = {
                "I": [
                  "Contactez le 3919 (Violences Femmes Info — 24/7, gratuit, anonyme) pour orientation et soutien spécialisé",
                  "Consultez un·e psychologue formé·e au trauma complexe relationnel et aux violences conjugales",
                  "Documentez les violences dans un lieu sûr (journal daté, captures, certificats médicaux)",
                  "Évaluez votre sécurité avec un·e professionnel·le et établissez un plan de protection si nécessaire",
                  "Contactez une association spécialisée pour accompagnement juridique (dépôt plainte, ordonnance protection)"
                ],
                "P": [
                  "Consultez la médecine du travail pour documenter la situation et obtenir un soutien médical",
                  "Prenez contact avec les représentants du personnel, syndicats ou CSE",
                  "Documentez précisément les faits (dates, témoins, mails, SMS)",
                  "Consultez un·e avocat·e spécialisé·e en droit du travail pour évaluer vos recours",
                  "Envisagez un arrêt maladie si nécessaire pour vous protéger et préparer vos démarches"
                ],
                "S": [
                  "Contactez le Défenseur des droits pour signaler les dysfonctionnements institutionnels",
                  "Rapprochez-vous d'associations d'aide aux victimes qui peuvent faire médiation avec les institutions",
                  "Documentez chaque interaction problématique (date, personne, propos tenus)",
                  "Demandez systématiquement les écrits et comptes-rendus lors de vos démarches",
                  "N'hésitez pas à changer de professionnel·le si vous n'êtes pas entendu·e"
                ],
                "F": [
                  "Évaluez votre sécurité et celle de vos proches, particulièrement si enfants concernés",
                  "Contactez le 119 (Enfance en Danger) si des mineurs sont victimes ou témoins",
                  "Consultez un·e psychologue spécialisé·e en violences intrafamiliales",
                  "Documentez les violences pour d'éventuelles démarches juridiques futures",
                  "Recherchez du soutien dans des sphères extérieures à la famille (ami·es, associations, professionnels)"
                ],
                "A": [
                  "Identifiez précisément les contextes concernés pour cibler les ressources appropriées",
                  "Documentez les situations pour d'éventuelles démarches",
                  "Consultez un·e professionnel·le pour évaluer l'impact cumulatif de ces violences",
                  "Recherchez des espaces sécurisants dans d'autres sphères de vie"
                ]
              };
              
              return `
                <div style="margin-bottom:var(--s-8)">
                  <h4 style="font-size:var(--fs-lg);font-weight:700;color:${sphere.color};margin-bottom:var(--s-4)">
                    Sphère ${sphere.label}
                  </h4>
                  ${recs[k].map(r => `<div class="recommendation-item">${r}</div>`).join('')}
                </div>
              `;
            }).join('')}
          
          <div style="margin-top:var(--s-8)">
            <h4 style="font-size:var(--fs-lg);font-weight:700;margin-bottom:var(--s-4)">Ressources d'Urgence</h4>
            <div class="emergency-item">
              <div class="emergency-number">3919</div>
              <div class="emergency-desc"><strong>Violences Femmes Info</strong><br>Écoute, information, orientation — 24h/24, 7j/7, gratuit, anonyme</div>
            </div>
            <div class="emergency-item">
              <div class="emergency-number">17</div>
              <div class="emergency-desc"><strong>Police / Gendarmerie</strong><br>Danger immédiat — Intervention d'urgence</div>
            </div>
            <div class="emergency-item">
              <div class="emergency-number">114</div>
              <div class="emergency-desc"><strong>Urgence SMS</strong><br>Numéro d'urgence par SMS si parole impossible</div>
            </div>
            <div class="emergency-item">
              <div class="emergency-number">119</div>
              <div class="emergency-desc"><strong>Enfance en Danger</strong><br>Si des enfants sont victimes ou témoins de violences</div>
            </div>
            <div class="emergency-item">
              <div class="emergency-number">3114</div>
              <div class="emergency-desc"><strong>Prévention Suicide</strong><br>Si pensées suicidaires ou détresse psychique majeure</div>
            </div>
          </div>
        </div>
        
        <div class="card">
          <h3>Exporter vos résultats</h3>
          <p style="font-size:var(--fs-sm);color:var(--noir-doux);margin-bottom:var(--s-6)">
            Vous pouvez exporter vos résultats pour les conserver, les partager avec un·e professionnel·le ou les utiliser dans vos démarches.
          </p>
          <div class="btn-group">
            <button class="btn-secondary" onclick="exportJSON()">
              📥 Télécharger JSON
            </button>
            <button class="btn-secondary" onclick="exportEmail()">
              📧 Envoyer par Email
            </button>
            <button class="btn-secondary" onclick="window.print()">
              🖨️ Imprimer PDF
            </button>
            <button class="btn-primary" onclick="resetTest()">
              🔄 Recommencer
            </button>
          </div>
        </div>
      `;
      
      document.getElementById('results-content').innerHTML = html;
    }
    
    function exportEmail() {
      const scores = calculateScores();
      const body = `Rapport NOÉSIS — ${TEST_NAME}
Participant·e : ${state.anamnesis.name}
Généré le ${new Date().toLocaleDateString('fr-FR')}

=== PROFIL D'EXPOSITION ===

DIMENSIONS :
${AXES.map(ax => `- ${ax.label} : ${scores.dimensions[ax.key].pct}%`).join('\n')}

SPHÈRES :
${SPHERES.filter(sp => scores.spheres[sp.key].count > 0).map(sp => 
  `- ${sp.label} : ${scores.spheres[sp.key].pct}% (convergence : ${scores.convergence[sp.key]} dimensions)`
).join('\n')}

INDICES ÉCOLOGIQUES :
- Saturation : ${scores.saturation} sphères ≥ 40%
- Convergence maximale : ${scores.maxConvergence} dimensions dans une même sphère

---
Ce rapport est généré par un outil informatif et éducatif.
Il ne constitue pas un diagnostic clinique.

NOÉSIS — Intelligence transdisciplinaire
© ${new Date().getFullYear()}`;
      
      window.location.href = `mailto:?subject=${encodeURIComponent('Rapport Cartographie Violences — ' + state.anamnesis.name)}&body=${encodeURIComponent(body)}`;
    }
    
    function exportJSON() {
      const scores = calculateScores();
      const data = {
        metadata: {
          test: TEST_NAME,
          version: TEST_VERSION,
          date: new Date().toISOString(),
          participant: state.anamnesis.name,
          age: state.anamnesis.age
        },
        responses: {
          answers: state.answers,
          spheres: state.spheres,
          completion: `${Object.keys(state.answers).length}/${QUESTIONS.length}`
        },
        scoring: {
          dimensions: scores.dimensions,
          spheres: scores.spheres,
          convergence: scores.convergence,
          saturation: scores.saturation,
          saturationPct: scores.saturationPct,
          maxConvergence: scores.maxConvergence
        }
      };
      
      const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `noesis-cartographie-violences-${Date.now()}.json`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }
    
    function resetTest() {
      if (confirm("Recommencer l'évaluation ? Toutes vos réponses seront perdues.")) {
        location.reload();
      }
    }
    
    window.addEventListener('DOMContentLoaded', () => {
      console.log(`${TEST_NAME} v${TEST_VERSION} — NOÉSIS © ${new Date().getFullYear()}`);
    });
  </script>
</body>
</html>
