<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Parentalit√© Toxique ‚Äî Auto√©valuation Multidimensionnelle | NO√âSIS</title>
  <meta name="description" content="√âvaluation structur√©e des dynamiques familiales toxiques : invalidation, contr√¥le, parentification, coercition √©motionnelle et impact fonctionnel sur 40 items valid√©s.">
  
  <!-- Open Graph -->
  <meta property="og:title" content="Parentalit√© Toxique ‚Äî Auto√©valuation NO√âSIS">
  <meta property="og:description" content="Outil d'√©valuation multidimensionnel pour rep√©rer les dynamiques de parentalit√© toxique et obtenir des recommandations personnalis√©es.">
  <meta property="og:type" content="website">
  
  <!-- Polices Google -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@300;400;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <style>
    /* ============================================
       VARIABLES CSS NO√âSIS ‚Äî PALETTE COMPL√àTE
       ============================================ */
    :root {
      /* Noirs */
      --noir-absolu: #0A0A0A;
      --noir-doux: #111111;
      --noir-surface: #1A1A1A;
      
      /* Cr√®mes */
      --creme-principal: #F7F5EF;
      --creme-chaud: #F9F7F1;
      --blanc-surface: #FFFFFF;
      
      /* Or (accent signature NO√âSIS) */
      --or-signature: #C7A86D;
      --or-riche: #D4B980;
      --or-sombre: #A89158;
      --or-subtil: rgba(199,168,109,.08);
      --or-leger: rgba(199,168,109,.15);
      --or-moyen: rgba(199,168,109,.25);
      
      /* Variables Th√©matiques ‚Äî Parentalit√© Toxique */
      --invalidation-color: #dc2626;
      --invalidation-bg: rgba(220,38,38,0.08);
      --controle-color: #7c3aed;
      --controle-bg: rgba(124,58,237,0.08);
      --parentification-color: #ea580c;
      --parentification-bg: rgba(234,88,12,0.08);
      --instabilite-color: #0284c7;
      --instabilite-bg: rgba(2,132,199,0.08);
      --impact-color: #059669;
      --impact-bg: rgba(5,150,105,0.08);
      
      /* Typographie */
      --fs-xs: 12px; --fs-sm: 14px; --fs-md: 18px;
      --fs-lg: 21px; --fs-xl: 24px; --fs-2xl: 32px;
      --fs-3xl: 42px; --fs-4xl: 56px;
      --lh-tight: 1.2; --lh-normal: 1.5; --lh-relaxed: 1.7;
      
      /* Spacing √©chelle 8px */
      --s-2: 8px; --s-3: 12px; --s-4: 16px; --s-6: 24px;
      --s-8: 32px; --s-12: 48px; --s-16: 64px; --s-20: 80px;
      
      /* Ombres */
      --shadow-soft: 0 2px 8px rgba(10,10,10,.08), 0 1px 2px rgba(10,10,10,.12);
      --shadow-medium: 0 4px 16px rgba(10,10,10,.1), 0 2px 4px rgba(10,10,10,.15);
      --shadow-large: 0 8px 32px rgba(10,10,10,.12), 0 2px 8px rgba(10,10,10,.18);
      
      /* Bordures */
      --border-subtil: rgba(10,10,10,.08);
      --border-leger: rgba(10,10,10,.12);
      --border-visible: rgba(10,10,10,.18);
      
      /* Rayons */
      --radius-sm: 4px; --radius-md: 8px; --radius-lg: 12px;
      --radius-xl: 16px; --radius-2xl: 24px; --radius-pill: 9999px;
      
      /* Transitions */
      --ease-standard: cubic-bezier(0.4, 0.0, 0.2, 1);
      --ease-spring: cubic-bezier(0.16, 1, 0.3, 1);
      --duration-fast: 150ms; --duration-normal: 250ms; --duration-slow: 350ms;
    }
    
    /* ============================================
       RESET & BASE
       ============================================ */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    html {
      scroll-behavior: smooth;
    }
    
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      font-size: var(--fs-md);
      line-height: var(--lh-normal);
      color: var(--noir-absolu);
      background: var(--creme-principal);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    
    h1, h2, h3, h4 {
      font-family: 'Fraunces', serif;
      font-weight: 600;
      line-height: var(--lh-tight);
      color: var(--noir-absolu);
    }
    
    button {
      font-family: inherit;
      cursor: pointer;
      border: none;
      background: none;
    }
    
    input, select, textarea {
      font-family: inherit;
      font-size: inherit;
    }
    
    /* ============================================
       LAYOUT
       ============================================ */
    .app-container {
      max-width: 900px;
      margin: 0 auto;
      padding: var(--s-12) var(--s-6);
    }
    
    .screen {
      display: none;
      animation: fadeIn var(--duration-slow) var(--ease-standard);
    }
    
    .screen.active {
      display: block;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(8px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* ============================================
       COMPONENTS ‚Äî INTRO
       ============================================ */
    .intro-header {
      text-align: center;
      margin-bottom: var(--s-16);
    }
    
    .icon-container {
      width: 80px;
      height: 80px;
      margin: 0 auto var(--s-6);
      background: linear-gradient(135deg, var(--or-signature), var(--or-riche));
      border-radius: var(--radius-2xl);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: var(--shadow-medium);
    }
    
    .icon-svg {
      width: 40px;
      height: 40px;
      color: var(--blanc-surface);
    }
    
    .intro-title {
      font-size: var(--fs-3xl);
      margin-bottom: var(--s-3);
      letter-spacing: -0.02em;
    }
    
    .intro-subtitle {
      font-size: var(--fs-lg);
      color: rgba(10,10,10,0.65);
      font-weight: 500;
    }
    
    /* Card */
    .card {
      background: var(--blanc-surface);
      border-radius: var(--radius-xl);
      padding: var(--s-8);
      margin-bottom: var(--s-8);
      box-shadow: var(--shadow-soft);
      border: 1px solid var(--border-subtil);
    }
    
    .card h2 {
      font-size: var(--fs-xl);
      margin-bottom: var(--s-6);
      display: flex;
      align-items: center;
      gap: var(--s-3);
    }
    
    .card-icon {
      width: 24px;
      height: 24px;
      color: var(--or-signature);
      flex-shrink: 0;
    }
    
    .card p {
      line-height: var(--lh-relaxed);
      color: rgba(10,10,10,0.8);
      margin-bottom: var(--s-4);
    }
    
    .card p:last-child {
      margin-bottom: 0;
    }
    
    /* Dimensions List */
    .dimensions-list {
      display: flex;
      flex-direction: column;
      gap: var(--s-4);
    }
    
    .dimension-item {
      padding: var(--s-4);
      border-left: 3px solid var(--or-signature);
      background: var(--or-subtil);
      border-radius: var(--radius-md);
    }
    
    .dimension-item h3 {
      font-size: var(--fs-md);
      font-weight: 600;
      margin-bottom: var(--s-2);
      color: var(--noir-absolu);
    }
    
    .dimension-item p {
      font-size: var(--fs-sm);
      color: rgba(10,10,10,0.7);
      margin: 0;
      line-height: var(--lh-normal);
    }
    
    /* Methodology Grid */
    .methodology-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: var(--s-6);
      margin-top: var(--s-6);
    }
    
    .methodology-item {
      text-align: center;
      padding: var(--s-6);
      background: var(--creme-principal);
      border-radius: var(--radius-lg);
      border: 1px solid var(--border-subtil);
    }
    
    .methodology-icon {
      font-size: 32px;
      margin-bottom: var(--s-3);
    }
    
    .methodology-label {
      font-size: var(--fs-md);
      font-weight: 600;
      color: var(--noir-absolu);
      margin-bottom: var(--s-2);
    }
    
    .methodology-description {
      font-size: var(--fs-sm);
      color: rgba(10,10,10,0.65);
    }
    
    /* Warning Box */
    .warning-box {
      background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
      border: 2px solid #F59E0B;
      border-radius: var(--radius-xl);
      padding: var(--s-6);
      margin-bottom: var(--s-8);
    }
    
    .warning-box h3 {
      font-size: var(--fs-lg);
      color: #92400E;
      margin-bottom: var(--s-4);
      display: flex;
      align-items: center;
      gap: var(--s-2);
    }
    
    .warning-icon {
      width: 24px;
      height: 24px;
      color: #F59E0B;
      flex-shrink: 0;
    }
    
    .warning-box p {
      font-size: var(--fs-sm);
      line-height: var(--lh-relaxed);
      color: #78350F;
      margin-bottom: var(--s-3);
    }
    
    .warning-box p:last-child {
      margin-bottom: 0;
    }
    
    /* Form */
    .form-group {
      margin-bottom: var(--s-6);
    }
    
    .form-group label {
      display: block;
      font-size: var(--fs-sm);
      font-weight: 600;
      color: var(--noir-absolu);
      margin-bottom: var(--s-2);
    }
    
    .form-group input[type="text"],
    .form-group input[type="number"],
    .form-group select {
      width: 100%;
      padding: var(--s-3) var(--s-4);
      border: 1px solid var(--border-leger);
      border-radius: var(--radius-md);
      font-size: var(--fs-md);
      transition: border-color var(--duration-fast) var(--ease-standard);
    }
    
    .form-group input:focus,
    .form-group select:focus {
      outline: none;
      border-color: var(--or-signature);
      box-shadow: 0 0 0 3px var(--or-subtil);
    }
    
    .form-group input[type="checkbox"] {
      margin-right: var(--s-2);
    }
    
    .form-group label[for] {
      cursor: pointer;
    }
    
    /* Buttons */
    .btn {
      padding: var(--s-4) var(--s-8);
      border-radius: var(--radius-lg);
      font-size: var(--fs-md);
      font-weight: 600;
      transition: all var(--duration-normal) var(--ease-standard);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: var(--s-2);
    }
    
    .btn-primary {
      background: linear-gradient(135deg, var(--or-signature), var(--or-riche));
      color: var(--blanc-surface);
      box-shadow: var(--shadow-soft);
    }
    
    .btn-primary:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: var(--shadow-medium);
    }
    
    .btn-primary:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    .btn-secondary {
      background: var(--blanc-surface);
      color: var(--noir-absolu);
      border: 2px solid var(--or-signature);
    }
    
    .btn-secondary:hover {
      background: var(--or-subtil);
      transform: translateY(-2px);
    }
    
    .btn-large {
      width: 100%;
      padding: var(--s-6);
      font-size: var(--fs-lg);
    }
    
    /* ============================================
       COMPONENTS ‚Äî TEST
       ============================================ */
    .progress-header {
      margin-bottom: var(--s-8);
    }
    
    .progress-info {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--s-3);
      font-size: var(--fs-sm);
      font-weight: 500;
      color: rgba(10,10,10,0.7);
    }
    
    .progress-bar-container {
      width: 100%;
      height: 8px;
      background: var(--creme-chaud);
      border-radius: var(--radius-pill);
      overflow: hidden;
      box-shadow: inset 0 1px 3px rgba(10,10,10,0.1);
    }
    
    .progress-bar-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--or-signature), var(--or-riche));
      border-radius: var(--radius-pill);
      transition: width var(--duration-slow) var(--ease-spring);
    }
    
    .question-container {
      background: var(--blanc-surface);
      border-radius: var(--radius-xl);
      padding: var(--s-12);
      margin-bottom: var(--s-8);
      box-shadow: var(--shadow-medium);
      border: 1px solid var(--border-subtil);
    }
    
    .question-number {
      font-size: var(--fs-sm);
      font-weight: 600;
      color: var(--or-signature);
      margin-bottom: var(--s-2);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    
    .dimension-badge {
      display: inline-block;
      padding: var(--s-2) var(--s-3);
      background: var(--or-leger);
      color: var(--or-sombre);
      font-size: var(--fs-xs);
      font-weight: 600;
      border-radius: var(--radius-pill);
      margin-bottom: var(--s-6);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    
    .question-text {
      font-size: var(--fs-xl);
      line-height: var(--lh-normal);
      color: var(--noir-absolu);
      margin-bottom: var(--s-8);
      font-family: 'Fraunces', serif;
      font-weight: 400;
    }
    
    .answer-options {
      display: flex;
      flex-direction: column;
      gap: var(--s-4);
    }
    
    .answer-option {
      padding: var(--s-6);
      background: var(--creme-principal);
      border: 2px solid var(--border-subtil);
      border-radius: var(--radius-lg);
      cursor: pointer;
      transition: all var(--duration-normal) var(--ease-standard);
      position: relative;
    }
    
    .answer-option:hover {
      border-color: var(--or-signature);
      background: var(--or-subtil);
      transform: translateX(4px);
    }
    
    .answer-option.selected {
      border-color: var(--or-signature);
      background: var(--or-leger);
      box-shadow: var(--shadow-soft);
    }
    
    .answer-label {
      font-size: var(--fs-md);
      font-weight: 600;
      color: var(--noir-absolu);
      margin-bottom: var(--s-2);
    }
    
    .answer-sublabel {
      font-size: var(--fs-sm);
      color: rgba(10,10,10,0.65);
      line-height: var(--lh-normal);
    }
    
    /* Navigation Footer */
    .nav-footer {
      display: flex;
      justify-content: space-between;
      gap: var(--s-4);
      margin-top: var(--s-8);
    }
    
    .nav-footer .btn {
      flex: 1;
    }
    
    /* OBLIGATOIRE : Masquer bouton Suivant */
    #next-btn {
      display: none;
    }
    
    /* ============================================
       COMPONENTS ‚Äî RESULTS
       ============================================ */
    .results-header {
      text-align: center;
      margin-bottom: var(--s-16);
      padding-bottom: var(--s-8);
      border-bottom: 2px solid var(--or-signature);
    }
    
    .results-icon-container {
      width: 96px;
      height: 96px;
      margin: 0 auto var(--s-6);
      background: linear-gradient(135deg, var(--or-signature), var(--or-riche));
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: var(--shadow-large);
    }
    
    .results-icon {
      width: 48px;
      height: 48px;
      color: var(--blanc-surface);
    }
    
    .results-title {
      font-size: var(--fs-3xl);
      margin-bottom: var(--s-3);
      letter-spacing: -0.02em;
    }
    
    .results-date {
      font-size: var(--fs-sm);
      color: rgba(10,10,10,0.6);
      font-weight: 500;
    }
    
    /* Score Hero */
    .score-hero {
      background: linear-gradient(135deg, var(--blanc-surface) 0%, var(--creme-chaud) 100%);
      border: 2px solid var(--or-signature);
      border-radius: var(--radius-2xl);
      padding: var(--s-12);
      margin-bottom: var(--s-12);
      box-shadow: var(--shadow-large);
      text-align: center;
    }
    
    .score-container {
      margin-bottom: var(--s-8);
    }
    
    .score-display {
      font-family: 'Fraunces', serif;
      font-size: 72px;
      font-weight: 700;
      color: var(--or-signature);
      line-height: 1;
      margin-bottom: var(--s-3);
    }
    
    .score-max {
      font-size: 36px;
      color: rgba(10,10,10,0.3);
    }
    
    .score-label {
      font-size: var(--fs-md);
      font-weight: 600;
      color: rgba(10,10,10,0.7);
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }
    
    .level-badge-container {
      margin-top: var(--s-6);
    }
    
    .level-badge {
      display: inline-block;
      padding: var(--s-3) var(--s-8);
      border-radius: var(--radius-pill);
      font-size: var(--fs-lg);
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: var(--s-4);
    }
    
    .level-badge.minimal {
      background: #D1FAE5;
      color: #065F46;
    }
    
    .level-badge.low {
      background: #DBEAFE;
      color: #1E40AF;
    }
    
    .level-badge.moderate {
      background: #FED7AA;
      color: #92400E;
    }
    
    .level-badge.high {
      background: #FECACA;
      color: #991B1B;
    }
    
    .score-message {
      font-size: var(--fs-md);
      line-height: var(--lh-relaxed);
      color: rgba(10,10,10,0.8);
      max-width: 600px;
      margin: 0 auto;
    }
    
    /* Profile Grid */
    .profile-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: var(--s-4);
      margin-top: var(--s-6);
    }
    
    .profile-item {
      padding: var(--s-4);
      background: var(--creme-principal);
      border-radius: var(--radius-md);
      border: 1px solid var(--border-subtil);
    }
    
    .profile-label {
      font-size: var(--fs-xs);
      font-weight: 600;
      color: rgba(10,10,10,0.6);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: var(--s-2);
    }
    
    .profile-value {
      font-size: var(--fs-md);
      font-weight: 600;
      color: var(--noir-absolu);
    }
    
    /* Dimension Analysis */
    .dimension-analysis {
      display: flex;
      flex-direction: column;
      gap: var(--s-6);
      margin-top: var(--s-6);
    }
    
    .dimension-card {
      padding: var(--s-6);
      background: var(--blanc-surface);
      border-left: 4px solid var(--or-signature);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-soft);
    }
    
    .dimension-card.invalidation {
      border-left-color: var(--invalidation-color);
      background: linear-gradient(90deg, var(--invalidation-bg) 0%, var(--blanc-surface) 100%);
    }
    
    .dimension-card.controle {
      border-left-color: var(--controle-color);
      background: linear-gradient(90deg, var(--controle-bg) 0%, var(--blanc-surface) 100%);
    }
    
    .dimension-card.parentification {
      border-left-color: var(--parentification-color);
      background: linear-gradient(90deg, var(--parentification-bg) 0%, var(--blanc-surface) 100%);
    }
    
    .dimension-card.instabilite {
      border-left-color: var(--instabilite-color);
      background: linear-gradient(90deg, var(--instabilite-bg) 0%, var(--blanc-surface) 100%);
    }
    
    .dimension-card.impact {
      border-left-color: var(--impact-color);
      background: linear-gradient(90deg, var(--impact-bg) 0%, var(--blanc-surface) 100%);
    }
    
    .dimension-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--s-4);
    }
    
    .dimension-name {
      font-size: var(--fs-lg);
      font-weight: 600;
      color: var(--noir-absolu);
    }
    
    .dimension-score-display {
      font-size: var(--fs-xl);
      font-weight: 700;
      color: var(--or-signature);
    }
    
    .dimension-bar-container {
      width: 100%;
      height: 12px;
      background: var(--creme-principal);
      border-radius: var(--radius-pill);
      overflow: hidden;
      margin-bottom: var(--s-4);
      box-shadow: inset 0 1px 3px rgba(10,10,10,0.1);
    }
    
    .dimension-bar-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--or-signature), var(--or-riche));
      border-radius: var(--radius-pill);
      transition: width var(--duration-slow) var(--ease-spring);
    }
    
    .dimension-interpretation {
      font-size: var(--fs-sm);
      line-height: var(--lh-relaxed);
      color: rgba(10,10,10,0.75);
    }
    
    /* Recommendations */
    .recommendations-section {
      margin-top: var(--s-12);
    }
    
    .recommendations-section h2 {
      font-size: var(--fs-2xl);
      margin-bottom: var(--s-8);
      text-align: center;
    }
    
    .recommendation-list {
      display: flex;
      flex-direction: column;
      gap: var(--s-4);
    }
    
    .recommendation-item {
      padding: var(--s-6);
      background: var(--blanc-surface);
      border-left: 3px solid var(--or-signature);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-soft);
    }
    
    .recommendation-item p {
      font-size: var(--fs-md);
      line-height: var(--lh-relaxed);
      color: rgba(10,10,10,0.85);
      margin: 0;
    }
    
    /* Export Actions */
    .export-actions {
      display: flex;
      flex-wrap: wrap;
      gap: var(--s-4);
      margin-top: var(--s-12);
      margin-bottom: var(--s-12);
    }
    
    .export-actions .btn {
      flex: 1;
      min-width: 200px;
    }
    
    /* Disclaimer Box */
    .disclaimer-box {
      background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
      border: 2px solid #F59E0B;
      border-radius: var(--radius-xl);
      padding: var(--s-8);
      margin-top: var(--s-12);
    }
    
    .disclaimer-box h4 {
      font-size: var(--fs-lg);
      color: #92400E;
      margin-bottom: var(--s-4);
    }
    
    .disclaimer-box p {
      font-size: var(--fs-sm);
      line-height: var(--lh-relaxed);
      color: #78350F;
      margin-bottom: var(--s-3);
    }
    
    .disclaimer-box p:last-child {
      margin-bottom: 0;
    }
    
    .emergency-contact {
      margin-top: var(--s-6);
      padding-top: var(--s-6);
      border-top: 1px solid #F59E0B;
      font-weight: 600;
    }
    
    /* ============================================
       RESPONSIVE
       ============================================ */
    @media (max-width: 1024px) {
      .intro-title {
        font-size: var(--fs-2xl);
      }
      
      .card {
        padding: var(--s-6);
      }
      
      .question-text {
        font-size: var(--fs-lg);
      }
    }
    
    @media (max-width: 768px) {
      .app-container {
        padding: var(--s-6) var(--s-4);
      }
      
      .intro-title {
        font-size: var(--fs-xl);
      }
      
      .question-text {
        font-size: var(--fs-lg);
      }
      
      .nav-footer {
        flex-direction: column;
      }
      
      .nav-footer .btn {
        max-width: 100%;
      }
      
      .methodology-grid {
        grid-template-columns: 1fr;
      }
      
      .export-actions {
        flex-direction: column;
      }
      
      .export-actions .btn {
        min-width: 100%;
      }
      
      .score-display {
        font-size: 56px;
      }
      
      .score-max {
        font-size: 28px;
      }
    }
    
    @media (max-width: 480px) {
      .intro-title {
        font-size: var(--fs-lg);
      }
      
      .question-text {
        font-size: var(--fs-md);
      }
      
      .dimension-badge {
        font-size: 10px;
      }
      
      .score-display {
        font-size: 48px;
      }
    }
    
    /* ============================================
       PRINT
       ============================================ */
    @media print {
      body {
        background: white;
      }
      
      .nav-footer,
      .export-actions {
        display: none;
      }
    }

    /* ========================================
       NAVIGATION NOESIS
       ======================================== */
    nav {
        position: sticky;
        top: 0;
        background: var(--creme-principal);
        backdrop-filter: blur(20px) saturate(180%);
        border-bottom: 1px solid rgba(10, 10, 10, 0.08);
        padding: 20px 0;
        z-index: 2000;
        box-shadow: 0 1px 4px rgba(10, 10, 10, 0.08);
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    nav.scrolled {
        padding: 14px 0;
        background: var(--creme-principal);
        border-bottom: 1px solid rgba(10, 10, 10, 0.12);
        box-shadow: 0 2px 12px rgba(10, 10, 10, 0.12);
    }

    nav .container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        position: relative;
    }

    .logo {
        font-family: 'Cormorant Garamond', serif;
        font-size: 28px;
        font-weight: 700;
        letter-spacing: 0.25em;
        text-transform: uppercase;
        color: var(--noir-absolu);
        text-decoration: none;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        font-variant: small-caps;
        position: relative;
        display: flex;
        align-items: center;
    }

    nav.scrolled .logo {
        font-size: 24px;
    }

    .logo-text {
        position: relative;
    }

    .logo-text::before {
        content: '';
        position: absolute;
        width: 100%;
        height: 1px;
        bottom: -4px;
        left: 0;
        background: linear-gradient(90deg,
            transparent 0%,
            var(--or-signature) 50%,
            transparent 100%);
        opacity: 0;
        transition: opacity 0.4s ease;
    }

    .logo:hover {
        color: var(--or-riche);
        letter-spacing: 0.28em;
    }

    .logo:hover .logo-text::before {
        opacity: 1;
    }

    nav ul {
        display: flex;
        gap: 2px;
        list-style: none;
        align-items: center;
        background-color: var(--blanc-surface);
        border: 1px solid rgba(10, 10, 10, 0.12);
        border-radius: 50px;
        padding: 6px;
        box-shadow: 0 1px 3px rgba(10, 10, 10, 0.08);
    }

    nav li {
        position: relative;
    }

    nav a:not(.logo) {
        font-family: 'Source Sans Pro', sans-serif;
        font-size: 13px;
        font-weight: 600;
        color: var(--text-primary);
        text-decoration: none;
        position: relative;
        padding: 10px 18px;
        border-radius: 40px;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        display: inline-block;
        letter-spacing: 0.02em;
        white-space: nowrap;
    }

    nav a:not(.logo)::before {
        content: '';
        position: absolute;
        inset: 0;
        border-radius: 40px;
        background: linear-gradient(135deg,
            var(--or-signature) 0%,
            var(--or-riche) 100%);
        opacity: 0;
        transition: opacity 0.3s ease;
        z-index: -1;
    }

    nav a:not(.logo):hover {
        color: var(--noir-absolu);
        transform: translateY(-1px);
        box-shadow:
            0 4px 12px rgba(199, 168, 109, 0.3),
            0 2px 4px rgba(199, 168, 109, 0.2);
    }

    nav a:not(.logo):hover::before {
        opacity: 1;
    }

    nav a:not(.logo).active {
        color: var(--noir-absolu);
        background: linear-gradient(135deg,
            var(--or-signature) 0%,
            var(--or-riche) 100%);
        box-shadow:
            0 4px 12px rgba(199, 168, 109, 0.35),
            0 2px 4px rgba(199, 168, 109, 0.25);
    }

    /* Boutons sociaux dans nav */
    .nav-social {
        display: flex;
        align-items: center;
        gap: 4px;
        margin-left: 16px;
        padding-left: 16px;
        border-left: 1px solid rgba(10, 10, 10, 0.12);
    }

    .nav-social-link {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 44px;
        height: 44px;
        border-radius: 50%;
        background: transparent;
        color: var(--text-primary);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        text-decoration: none;
        position: relative;
    }

    .nav-social-link svg {
        width: 20px;
        height: 20px;
        stroke-width: 1.5;
    }

    .nav-social-link::before {
        content: '';
        position: absolute;
        inset: 0;
        border-radius: 50%;
        background: linear-gradient(135deg,
            var(--or-signature) 0%,
            var(--or-riche) 100%);
        opacity: 0;
        transition: opacity 0.3s ease;
        z-index: -1;
    }

    .nav-social-link:hover {
        color: var(--noir-absolu);
        transform: translateY(-1px);
        box-shadow:
            0 4px 12px rgba(199, 168, 109, 0.3),
            0 2px 4px rgba(199, 168, 109, 0.2);
    }

    .nav-social-link:hover::before {
        opacity: 1;
    }

    /* ============================================
       MENU HAMBURGER MOBILE
       ============================================ */
    .menu-toggle {
        display: none;
        flex-direction: column;
        gap: 6px;
        background: transparent;
        border: none;
        cursor: pointer;
        padding: 8px;
        z-index: 2002;
        position: relative;
        transition: all 0.3s ease;
    }

    .menu-toggle span {
        width: 28px;
        height: 2px;
        background: var(--or-signature);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        border-radius: 2px;
    }

    .menu-toggle.active span:nth-child(1) {
        transform: rotate(45deg) translate(8px, 8px);
    }

    .menu-toggle.active span:nth-child(2) {
        opacity: 0;
    }

    .menu-toggle.active span:nth-child(3) {
        transform: rotate(-45deg) translate(7px, -7px);
    }

    /* Responsive Navigation */
    @media (max-width: 1024px) {
        nav .container {
            padding: 0 24px;
            position: relative;
        }

        .menu-toggle {
            display: flex;
            position: relative;
            z-index: 2002;
        }

        nav ul {
            position: fixed;
            top: 0;
            right: -100%;
            height: 100vh;
            width: 320px;
            max-width: 85vw;
            flex-direction: column;
            background: linear-gradient(180deg,
                var(--noir-absolu) 0%,
                var(--noir-surface) 100%);
            padding: 100px 32px 40px;
            gap: 0;
            border-radius: 0;
            border: none;
            border-left: 1px solid rgba(199, 168, 109, 0.2);
            box-shadow:
                -4px 0 24px rgba(0, 0, 0, 0.8),
                -8px 0 48px rgba(0, 0, 0, 0.5);
            transition: right 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            overflow-y: auto;
        }

        nav ul.active {
            right: 0;
        }

        nav li {
            width: 100%;
            margin-bottom: 12px;
        }

        nav a:not(.logo) {
            display: block;
            width: 100%;
            padding: 16px 20px;
            font-size: 15px;
            text-align: left;
            touch-action: manipulation;
            border-radius: 8px;
        }

        .nav-social {
            margin-left: 0;
            padding-left: 0;
            padding-top: 24px;
            margin-top: 24px;
            border-left: none;
            border-top: 1px solid rgba(199, 168, 109, 0.2);
            justify-content: flex-start;
            gap: 12px;
        }

        .nav-social-link {
            width: 42px;
            height: 42px;
        }

        .nav-social-link svg {
            width: 20px;
            height: 20px;
        }

        /* Overlay pour fermer le menu */
        .menu-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: rgba(10, 10, 10, 0.8);
            backdrop-filter: blur(4px);
            z-index: 1999;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .menu-overlay.active {
            display: block;
            opacity: 1;
        }
    }

    @media (max-width: 768px) {
        nav {
            padding: 16px 0;
        }

        nav.scrolled {
            padding: 12px 0;
        }

        .logo {
            font-size: 22px;
        }

        nav.scrolled .logo {
            font-size: 20px;
        }

        nav ul {
            width: 280px;
            padding: 80px 24px 32px;
        }
    }
  </style>
</head>
<body>
  <nav id="navbar">
    <div class="container">
      <a href="../index.html#accueil" class="logo">
        <span class="logo-text">NOESIS</span>
      </a>

      <!-- Bouton hamburger mobile -->
      <button class="menu-toggle" id="menuToggle" aria-label="Menu de navigation">
        <span></span>
        <span></span>
        <span></span>
      </button>

      <ul id="navMenu">
        <li><a href="../index.html#accueil">Accueil</a></li>
        <li><a href="../index.html#methode">La M√©thode</a></li>
        <li><a href="../index.html#decouvrir">D√©couvrir</a></li>
        <li><a href="../Articles/articles-index.html">Articles</a></li>
        <li><a href="../autotests/autotests.html" class="active">Auto-tests</a></li>
        <li><a href="../Podcasts/podcast.html">Podcasts</a></li>
        <li><a href="../Livres/livres.html">Livres</a></li>
        <li><a href="../Accompagnement/accompagnement.html">Accompagnement</a></li>
        <li><a href="../index.html#engagement">Engagement</a></li>
        <li class="nav-social">
          <a href="https://www.instagram.com/noesis_analyse" target="_blank" rel="noopener noreferrer" class="nav-social-link" aria-label="Instagram NOESIS">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <rect x="2" y="2" width="20" height="20" rx="5" ry="5"/>
              <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/>
              <line x1="17.5" y1="6.5" x2="17.51" y2="6.5"/>
            </svg>
          </a>
          <a href="https://www.linkedin.com/in/noesisanalyse" target="_blank" rel="noopener noreferrer" class="nav-social-link" aria-label="LinkedIn NOESIS">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"/>
              <rect x="2" y="9" width="4" height="12"/>
              <circle cx="4" cy="4" r="2"/>
            </svg>
          </a>
          <a href="/cdn-cgi/l/email-protection#4c25232922342e2432293d233f0c2b212d2520622f2321" class="nav-social-link" aria-label="Email NOESIS">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
              <polyline points="22,6 12,13 2,6"/>
            </svg>
          </a>
        </li>
      </ul>
    </div>
  </nav>

  <!-- Overlay menu mobile -->
  <div class="menu-overlay" id="menuOverlay"></div>

<!-- ============================================
       √âCRAN 1 : INTRODUCTION
       ============================================ -->
  <div id="intro-screen" class="screen active">
    <div class="app-container">
      
      <div class="intro-header">
        <div class="icon-container">
          <svg class="icon-svg" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-width="2">
            <path d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"/>
          </svg>
        </div>
        <h1 class="intro-title">Parentalit√© Toxique</h1>
        <p class="intro-subtitle">√âvaluation des Dynamiques Familiales ‚Äî Approche multidimensionnelle</p>
      </div>
      
      <div class="card">
        <h2>
          <svg class="card-icon" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-width="2">
            <path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
          </svg>
          Objectif de l'Outil
        </h2>
        <p>
          Cet autotest √©value les dynamiques relationnelles potentiellement toxiques au sein de votre famille. 
          Il identifie cinq dimensions cl√©s : invalidation √©motionnelle, contr√¥le excessif, parentification, 
          instabilit√© affective et impact fonctionnel. L'objectif est de vous offrir un √©clairage structur√© 
          sur votre v√©cu relationnel et de vous orienter vers des ressources adapt√©es.
        </p>
      </div>
      
      <div class="card">
        <h2>
          <svg class="card-icon" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-width="2">
            <path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"/>
          </svg>
          Dimensions √âvalu√©es
        </h2>
        <div class="dimensions-list">
          <div class="dimension-item" style="border-left-color: var(--invalidation-color);">
            <h3>Invalidation & D√©nigrement</h3>
            <p>Minimisation des √©motions, moqueries, r√©√©criture des faits, d√©cr√©dibilisation</p>
          </div>
          <div class="dimension-item" style="border-left-color: var(--controle-color);">
            <h3>Contr√¥le & Intrusion</h3>
            <p>Surveillance excessive, violation des fronti√®res, d√©cisions impos√©es sans consentement</p>
          </div>
          <div class="dimension-item" style="border-left-color: var(--parentification-color);">
            <h3>Parentification</h3>
            <p>Inversion des r√¥les, charge √©motionnelle d√©plac√©e sur l'enfant, responsabilit√©s adultes impos√©es</p>
          </div>
          <div class="dimension-item" style="border-left-color: var(--instabilite-color);">
            <h3>Instabilit√© √âmotionnelle</h3>
            <p>Alternance impr√©visible chaleur/froid, chantage affectif, silence punitif, triangulation</p>
          </div>
          <div class="dimension-item" style="border-left-color: var(--impact-color);">
            <h3>Impact Fonctionnel</h3>
            <p>Cons√©quences sur le sommeil, les √©tudes, le travail, la sant√© mentale et la capacit√© d'attachement</p>
          </div>
        </div>
      </div>
      
      <div class="card">
        <h2>
          <svg class="card-icon" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-width="2">
            <path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
          </svg>
          M√©thodologie
        </h2>
        <div class="methodology-grid">
          <div class="methodology-item">
            <div class="methodology-icon">üìä</div>
            <div class="methodology-label">40 Questions</div>
            <div class="methodology-description">√âvaluation approfondie</div>
          </div>
          <div class="methodology-item">
            <div class="methodology-icon">‚è±Ô∏è</div>
            <div class="methodology-label">7-10 Minutes</div>
            <div class="methodology-description">Temps estim√©</div>
          </div>
          <div class="methodology-item">
            <div class="methodology-icon">üîí</div>
            <div class="methodology-label">Anonyme</div>
            <div class="methodology-description">Donn√©es confidentielles</div>
          </div>
          <div class="methodology-item">
            <div class="methodology-icon">üìÑ</div>
            <div class="methodology-label">Export PDF</div>
            <div class="methodology-description">Rapport d√©taill√©</div>
          </div>
        </div>
      </div>
      
      <div class="warning-box">
        <h3>
          <svg class="warning-icon" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-width="2">
            <path d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
          </svg>
          Avertissement Important
        </h3>
        <p>
          Cet outil constitue une <strong>aide √† l'auto-observation</strong> et ne remplace en aucun cas 
          une consultation avec un professionnel qualifi√© (psychologue, travailleur social, th√©rapeute familial).
        </p>
        <p>
          Les r√©sultats refl√®tent votre <strong>perception subjective</strong> des dynamiques familiales 
          et n√©cessitent une interpr√©tation contextuelle.
        </p>
        <p>
          <strong>Si vous √™tes en situation de danger imm√©diat</strong> (violence physique, menaces, maltraitance), 
          contactez les services d'urgence (17 ou 112) ou le 119 (Enfance en Danger).
        </p>
      </div>
      
      <div class="card">
        <h2>Informations Contextuelles</h2>
        
        <div class="form-group">
          <label for="user-name">Nom ou Pseudonyme (optionnel)</label>
          <input type="text" id="user-name" placeholder="Ex : Alex M.">
        </div>
        
        <div class="form-group">
          <label for="user-age">√Çge</label>
          <input type="number" id="user-age" min="16" max="99" placeholder="Ex : 24">
        </div>
        
        <div class="form-group">
          <label for="relationship-type">Lien familial √©valu√©</label>
          <select id="relationship-type">
            <option value="">-- S√©lectionner --</option>
            <option value="mere">M√®re</option>
            <option value="pere">P√®re</option>
            <option value="beau-parent">Beau-parent</option>
            <option value="tuteur">Tuteur/Tutrice</option>
            <option value="grand-parent">Grand-parent</option>
            <option value="autre">Autre figure parentale</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="living-situation">Situation actuelle</label>
          <select id="living-situation">
            <option value="">-- S√©lectionner --</option>
            <option value="cohabitation">Cohabitation</option>
            <option value="distance">Contact √† distance</option>
            <option value="recomposee">Famille recompos√©e</option>
            <option value="separe">S√©par√©(e) g√©ographiquement</option>
            <option value="rupture">Rupture de contact</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="duration">Depuis combien de temps ces dynamiques durent-elles ?</label>
          <select id="duration">
            <option value="">-- S√©lectionner --</option>
            <option value="recent">Moins de 6 mois</option>
            <option value="moyen">6 mois √† 2 ans</option>
            <option value="long">2 √† 5 ans</option>
            <option value="chronique">Plus de 5 ans / Depuis l'enfance</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>
            <input type="checkbox" id="consent-check">
            <span>
              J'ai lu l'avertissement et je comprends que cet outil ne constitue pas 
              un diagnostic clinique. Je consens √† poursuivre l'auto-√©valuation.
            </span>
          </label>
        </div>
        
        <button class="btn btn-primary btn-large" id="start-btn" disabled>
          D√©marrer l'√âvaluation
        </button>
      </div>
      
    </div>
  </div>

  <!-- ============================================
       √âCRAN 2 : TEST (QUESTIONS)
       ============================================ -->
  <div id="test-screen" class="screen">
    <div class="app-container">
      
      <div class="progress-header">
        <div class="progress-info">
          <span id="question-number-display">Question 1 / 40</span>
          <span id="questions-remaining">40 questions restantes</span>
        </div>
        <div class="progress-bar-container">
          <div class="progress-bar-fill" id="progress-bar"></div>
        </div>
      </div>
      
      <div class="question-container">
        <div class="question-number" id="question-number">Question 1</div>
        <div class="dimension-badge" id="question-dimension-badge">Dimension</div>
        <h2 class="question-text" id="question-text"></h2>
        
        <div class="answer-options" id="answer-options"></div>
      </div>
      
      <div class="nav-footer">
        <button id="prev-btn" class="btn btn-secondary" onclick="prevQuestion()">
          ‚Üê Pr√©c√©dent
        </button>
        <button id="next-btn" class="btn btn-primary" onclick="nextQuestion()">
          Suivant ‚Üí
        </button>
      </div>
      
    </div>
  </div>

  <!-- ============================================
       √âCRAN 3 : R√âSULTATS
       ============================================ -->
  <div id="results-screen" class="screen">
    <div class="app-container">
      
      <div class="results-header">
        <div class="results-icon-container">
          <svg class="results-icon" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-width="2">
            <path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
          </svg>
        </div>
        <h1 class="results-title">Parentalit√© Toxique ‚Äî Analyse Personnalis√©e</h1>
        <p class="results-date" id="results-date"></p>
      </div>
      
      <div class="score-hero">
        <div class="score-container">
          <div class="score-display">
            <span class="score-value" id="total-score-display">0</span>
            <span class="score-max">/ 120</span>
          </div>
          <div class="score-label">Score Total</div>
        </div>
        
        <div class="level-badge-container">
          <div class="level-badge" id="global-level-badge"></div>
          <p class="score-message" id="score-message"></p>
        </div>
      </div>
      
      <div class="card">
        <h2>Profil & Contexte</h2>
        <div class="profile-grid" id="profile-grid"></div>
        <div style="margin-top: var(--s-6);">
          <p style="font-size: var(--fs-sm); color: rgba(10,10,10,0.7);">
            <strong>Indice de Risque Composite :</strong> 
            <span id="risk-index-value" style="font-weight: 600; color: var(--or-signature);"></span> / 100
          </p>
          <p style="font-size: var(--fs-xs); color: rgba(10,10,10,0.6); margin-top: var(--s-2);">
            L'indice de risque composite int√®gre les scores dimensionnels, la dur√©e d'exposition, 
            et la pr√©sence de facteurs aggravants. Un indice √©lev√© (‚â•70) sugg√®re un impact significatif 
            sur le bien-√™tre psychologique et n√©cessite une attention particuli√®re.
          </p>
        </div>
      </div>
      
      <div class="card">
        <h2>Analyse par Dimension</h2>
        <div class="dimension-analysis" id="dimension-analysis"></div>
      </div>
      
      <div class="card" style="background: linear-gradient(135deg, #F7F5EF 0%, #F9F7F1 100%); 
                                 border: 2px solid var(--or-signature);">
        <h2 style="display: flex; align-items: center; gap: var(--s-3);">
          <svg class="card-icon" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-width="2">
            <path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
          </svg>
          Analyse Approfondie du Profil
        </h2>
        <div id="profile-analysis-container"></div>
      </div>
      
      <div class="recommendations-section">
        <h2>Recommandations Personnalis√©es</h2>
        <div class="recommendation-list" id="recommendation-list"></div>
      </div>
      
      <div class="export-actions">
        <button class="btn btn-primary" id="pdf-btn" onclick="generatePDF()">üìÑ T√©l√©charger PDF</button>
        <button class="btn btn-secondary" id="email-btn" onclick="sendResultsByEmail()">‚úâÔ∏è Envoyer par Email</button>
        <button class="btn btn-secondary" id="json-btn" onclick="downloadJSON()">üìä Exporter JSON</button>
        <button class="btn btn-secondary" id="reset-btn" onclick="resetTest()">üîÑ Recommencer</button>
      </div>
      
      <div class="disclaimer-box">
        <h4>Nature et Limites de l'Outil</h4>
        <p>
          Ce questionnaire constitue un <strong>outil de sensibilisation et de pr√©-√©valuation</strong>, 
          con√ßu selon des standards m√©thodologiques rigoureux mais <strong>non valid√© psychom√©triquement</strong>.
        </p>
        <p>
          Les r√©sultats refl√®tent votre <strong>perception subjective</strong> et 
          <strong>ne constituent en aucun cas un diagnostic clinique</strong>.
        </p>
        <p>
          En cas de scores √©lev√©s ou de d√©tresse significative, nous recommandons fortement de 
          <strong>consulter un professionnel qualifi√©</strong> (psychologue, travailleur social, th√©rapeute familial).
        </p>
        <p class="emergency-contact">
          <strong>Ressources France :</strong><br>
          ‚Ä¢ 119 ‚Äî Enfance en Danger (24/7, gratuit, confidentiel)<br>
          ‚Ä¢ 3114 ‚Äî Pr√©vention suicide (24/7)<br>
          ‚Ä¢ 17 / 112 ‚Äî Urgences Police/Secours<br>
          ‚Ä¢ CIDFF (Centres d'Information sur les Droits des Femmes et des Familles)<br>
          ‚Ä¢ Associations locales d'aide aux victimes de violences intrafamiliales
        </p>
      </div>
      
    </div>
  </div>

  <script>
    /* ============================================
       STATE GLOBAL
       ============================================ */
    const state = {
      currentScreen: 'intro',
      currentQuestionIndex: 0,
      answers: {},
      anamnesis: {
        name: '',
        age: null,
        relationshipType: '',
        livingSituation: '',
        duration: ''
      }
    };

    /* ============================================
       DATA ‚Äî QUESTIONS (40 items)
       ============================================ */
    const QUESTIONS = [
      // D1 ‚Äî Invalidation & D√©nigrement (8 items)
      { id: 1, dim: "invalidation", text: "Au cours des 3 derniers mois, √† quelle fr√©quence vos √©motions ont-elles √©t√© minimis√©es avec des remarques comme ¬´ tu exag√®res ¬ª ou ¬´ tu es trop sensible ¬ª ?" },
      { id: 2, dim: "invalidation", text: "Au cours des 3 derniers mois, √† quelle fr√©quence cette personne s'est-elle moqu√©e de vos int√©r√™ts, de vos valeurs ou de vos choix de vie ?" },
      { id: 3, dim: "invalidation", text: "Au cours des 3 derniers mois, √† quelle fr√©quence cette personne a-t-elle r√©√©crit des √©v√©nements pass√©s pour vous faire douter de votre propre m√©moire ?" },
      { id: 4, dim: "invalidation", text: "Au cours des 3 derniers mois, √† quelle fr√©quence votre parole a-t-elle √©t√© d√©cr√©dibilis√©e devant d'autres membres de la famille ou en public ?" },
      { id: 5, dim: "invalidation", text: "Au cours des 3 derniers mois, √† quelle fr√©quence vous a-t-on fait honte concernant vos limites personnelles ou vos vuln√©rabilit√©s ?" },
      { id: 6, dim: "invalidation", text: "Au cours des 3 derniers mois, √† quelle fr√©quence cette personne vous a-t-elle attribu√© des √©tiquettes n√©gatives (¬´ fragile ¬ª, ¬´ ingrat(e) ¬ª, ¬´ √©go√Øste ¬ª) ?" },
      { id: 7, dim: "invalidation", text: "Au cours des 3 derniers mois, √† quelle fr√©quence vos ressentis l√©gitimes ont-ils √©t√© banalis√©s par l'humour ou l'ironie ?" },
      { id: 8, dim: "invalidation", text: "Au cours des 3 derniers mois, √† quelle fr√©quence cette personne a-t-elle ni√© ou minimis√© l'impact de ses comportements blessants sur vous ?" },
      
      // D2 ‚Äî Contr√¥le & Intrusion (8 items)
      { id: 9, dim: "controle", text: "Au cours des 3 derniers mois, √† quelle fr√©quence cette personne a-t-elle fouill√© vos affaires personnelles ou consult√© vos appareils √©lectroniques sans votre consentement ?" },
      { id: 10, dim: "controle", text: "Au cours des 3 derniers mois, √† quelle fr√©quence vous a-t-on impos√© des choix importants (amis fr√©quent√©s, √©tudes, travail, sant√©) sans tenir compte de votre avis ?" },
      { id: 11, dim: "controle", text: "Au cours des 3 derniers mois, √† quelle fr√©quence vos d√©placements, vos horaires ou vos d√©penses ont-ils fait l'objet d'une surveillance excessive ?" },
      { id: 12, dim: "controle", text: "Au cours des 3 derniers mois, √† quelle fr√©quence a-t-on exig√© de vous des comptes d√©taill√©s sur votre vie personnelle sans raison l√©gitime ?" },
      { id: 13, dim: "controle", text: "Au cours des 3 derniers mois, √† quelle fr√©quence votre intimit√© physique a-t-elle √©t√© viol√©e (entr√©e sans frapper, lecture de journal intime, ouverture de courrier personnel) ?" },
      { id: 14, dim: "controle", text: "Au cours des 3 derniers mois, √† quelle fr√©quence cette personne a-t-elle pris des d√©cisions √† votre place sur des sujets qui vous concernent directement ?" },
      { id: 15, dim: "controle", text: "Au cours des 3 derniers mois, √† quelle fr√©quence avez-vous √©t√© puni(e) ou sanctionn√©(e) pour avoir refus√© une intrusion dans votre vie priv√©e ?" },
      { id: 16, dim: "controle", text: "Au cours des 3 derniers mois, √† quelle fr√©quence cette personne a-t-elle utilis√© des menaces (retrait de soutien financier, expulsion du domicile) pour maintenir son contr√¥le ?" },
      
      // D3 ‚Äî Parentification (8 items)
      { id: 17, dim: "parentification", text: "Au cours des 3 derniers mois, √† quelle fr√©quence vous a-t-on confi√© la charge √©motionnelle de cette personne (√©couter ses probl√®mes de couple, g√©rer ses angoisses) ?" },
      { id: 18, dim: "parentification", text: "Au cours des 3 derniers mois, √† quelle fr√©quence a-t-on attendu de vous que vous g√©riez des t√¢ches d'adulte (d√©marches administratives, gestion financi√®re, soins √† un parent) ?" },
      { id: 19, dim: "parentification", text: "Au cours des 3 derniers mois, √† quelle fr√©quence cette personne vous a-t-elle demand√© conseil pour r√©soudre des probl√®mes qui rel√®vent de la responsabilit√© d'un adulte ?" },
      { id: 20, dim: "parentification", text: "Au cours des 3 derniers mois, √† quelle fr√©quence avez-vous d√ª rassurer ou consoler cette personne apr√®s ses conflits, ses ruptures ou ses difficult√©s personnelles ?" },
      { id: 21, dim: "parentification", text: "Au cours des 3 derniers mois, √† quelle fr√©quence vous a-t-on rendu responsable du bien-√™tre √©motionnel ou de la stabilit√© de la famille ?" },
      { id: 22, dim: "parentification", text: "Au cours des 3 derniers mois, √† quelle fr√©quence vous a-t-on plac√©(e) en position de m√©diateur(trice) entre adultes (parents s√©par√©s, conflit familial) ?" },
      { id: 23, dim: "parentification", text: "Au cours des 3 derniers mois, √† quelle fr√©quence avez-vous senti que vous deviez ¬´ payer ¬ª de votre affection ou de votre disponibilit√© pour maintenir le lien ?" },
      { id: 24, dim: "parentification", text: "Au cours des 3 derniers mois, √† quelle fr√©quence cette personne s'est-elle comport√©e comme si elle d√©pendait √©motionnellement de vous, inversant ainsi les r√¥les parent-enfant ?" },
      
      // D4 ‚Äî Instabilit√© √âmotionnelle & Coercition (8 items)
      { id: 25, dim: "instabilite", text: "Au cours des 3 derniers mois, √† quelle fr√©quence cette personne vous a-t-elle retir√© son affection ou son attention lorsque vous posiez une limite ?" },
      { id: 26, dim: "instabilite", text: "Au cours des 3 derniers mois, √† quelle fr√©quence vous a-t-on menac√© de couper les liens si vous vous affirmiez ou refusiez quelque chose ?" },
      { id: 27, dim: "instabilite", text: "Au cours des 3 derniers mois, √† quelle fr√©quence cette personne a-t-elle altern√© de fa√ßon impr√©visible entre chaleur affective et hostilit√© ?" },
      { id: 28, dim: "instabilite", text: "Au cours des 3 derniers mois, √† quelle fr√©quence vous a-t-on mont√© contre un autre membre de la famille (fr√®re, s≈ìur, autre parent) pour cr√©er des alliances ou des conflits ?" },
      { id: 29, dim: "instabilite", text: "Au cours des 3 derniers mois, √† quelle fr√©quence cette personne a-t-elle instrumentalis√© un secret familial ou une information intime pour vous faire taire ?" },
      { id: 30, dim: "instabilite", text: "Au cours des 3 derniers mois, √† quelle fr√©quence l'amour ou la reconnaissance de cette personne ont-ils sembl√© conditionn√©s √† votre ob√©issance ou votre soumission ?" },
      { id: 31, dim: "instabilite", text: "Au cours des 3 derniers mois, √† quelle fr√©quence cette personne a-t-elle ridiculis√© ou tourn√© en d√©rision vos tentatives de poser des limites, les qualifiant de ¬´ manque de respect ¬ª ?" },
      { id: 32, dim: "instabilite", text: "Au cours des 3 derniers mois, √† quelle fr√©quence avez-vous v√©cu des p√©riodes de silence punitif (plusieurs heures ou jours sans communication) apr√®s un d√©saccord ?" },
      
      // D5 ‚Äî Impact Fonctionnel (8 items)
      { id: 33, dim: "impact", text: "Au cours des 3 derniers mois, √† quelle fr√©quence avez-vous rumin√© pendant de longues p√©riodes apr√®s un √©change avec cette personne ?" },
      { id: 34, dim: "impact", text: "Au cours des 3 derniers mois, √† quelle fr√©quence votre sommeil s'est-il d√©t√©rior√© (difficult√© d'endormissement, r√©veils nocturnes, cauchemars) en lien avec cette relation ?" },
      { id: 35, dim: "impact", text: "Au cours des 3 derniers mois, √† quelle fr√©quence vos √©tudes, votre travail ou vos projets personnels ont-ils √©t√© affect√©s par l'√©puisement √©motionnel li√© √† cette relation ?" },
      { id: 36, dim: "impact", text: "Au cours des 3 derniers mois, √† quelle fr√©quence votre corps a-t-il r√©agi physiquement (maux de ventre, tachycardie, tensions musculaires) avant ou pendant un contact avec cette personne ?" },
      { id: 37, dim: "impact", text: "Au cours des 3 derniers mois, √† quelle fr√©quence vous √™tes-vous auto-censur√©(e) pour √©viter des repr√©sailles √©motionnelles ou des conflits ?" },
      { id: 38, dim: "impact", text: "Au cours des 3 derniers mois, √† quelle fr√©quence vous √™tes-vous senti(e) coupable √† l'id√©e de vous prot√©ger ou de prendre de la distance ?" },
      { id: 39, dim: "impact", text: "Au cours des 3 derniers mois, √† quelle fr√©quence avez-vous √©vit√© certains lieux, √©v√©nements familiaux ou sujets de conversation pour ne pas d√©clencher de conflit ?" },
      { id: 40, dim: "impact", text: "Au cours des 3 derniers mois, √† quelle fr√©quence avez-vous ressenti un sentiment de confusion quant √† votre propre valeur ou identit√©, en lien avec cette relation ?" }
    ];

    /* ============================================
       DATA ‚Äî √âCHELLE LIKERT 0-4
       ============================================ */
    const SCALE_OPTIONS = [
      { value: 0, label: "Jamais", sublabel: "Absence totale de cette manifestation" },
      { value: 1, label: "Rarement", sublabel: "Quelques occurrences isol√©es" },
      { value: 2, label: "Parfois", sublabel: "Manifestations occasionnelles" },
      { value: 3, label: "Souvent", sublabel: "Manifestations r√©guli√®res, impact notable" },
      { value: 4, label: "Tr√®s souvent", sublabel: "Pr√©sence quasi constante, impact majeur" }
    ];

    /* ============================================
       DATA ‚Äî DIMENSIONS
       ============================================ */
    const DIMENSIONS = [
      {
        key: "invalidation",
        label: "Invalidation",
        fullLabel: "Invalidation & D√©nigrement",
        description: "Minimisation des √©motions, moqueries, d√©cr√©dibilisation, honte",
        color: "var(--invalidation-color)",
        bg: "var(--invalidation-bg)"
      },
      {
        key: "controle",
        label: "Contr√¥le",
        fullLabel: "Contr√¥le & Intrusion",
        description: "Surveillance excessive, violation des fronti√®res, d√©cisions impos√©es",
        color: "var(--controle-color)",
        bg: "var(--controle-bg)"
      },
      {
        key: "parentification",
        label: "Parentification",
        fullLabel: "Parentification",
        description: "Inversion des r√¥les, charge √©motionnelle d√©plac√©e, responsabilit√©s adultes",
        color: "var(--parentification-color)",
        bg: "var(--parentification-bg)"
      },
      {
        key: "instabilite",
        label: "Instabilit√©",
        fullLabel: "Instabilit√© √âmotionnelle & Coercition",
        description: "Alternance chaleur/froid, chantage affectif, silence punitif",
        color: "var(--instabilite-color)",
        bg: "var(--instabilite-bg)"
      },
      {
        key: "impact",
        label: "Impact",
        fullLabel: "Impact Fonctionnel",
        description: "Cons√©quences sur sommeil, √©tudes, travail, sant√© mentale, attachement",
        color: "var(--impact-color)",
        bg: "var(--impact-bg)"
      }
    ];

    /* ============================================
       DATA ‚Äî BANDES DE R√âSULTATS
       ============================================ */
    const RESULT_BANDS = [
      {
        min: 0, max: 30,
        level: "Absence de Dynamiques Toxiques",
        severity: "minimal",
        interpretation: "Les indicateurs √©valu√©s sont absents ou n√©gligeables. Votre relation semble pr√©server un respect mutuel et des fronti√®res saines.",
        color: "#059669",
        recommendations: [
          "Maintenir un √©quilibre relationnel sain en continuant √† communiquer vos besoins et limites de mani√®re assertive.",
          "Cultiver des relations familiales bas√©es sur le respect mutuel, l'√©coute active et la reconnaissance des √©motions.",
          "Rester attentif(ve) aux variations dans le temps, particuli√®rement en p√©riodes de stress ou de transition familiale.",
          "D√©velopper des strat√©gies pr√©ventives de gestion des conflits pour pr√©server la qualit√© du lien."
        ]
      },
      {
        min: 31, max: 60,
        level: "Pr√©sence L√©g√®re",
        severity: "low",
        interpretation: "Manifestations l√©g√®res de dynamiques dysfonctionnelles, sans impact fonctionnel majeur. Surveillance pr√©ventive recommand√©e.",
        color: "#0284c7",
        recommendations: [
          "Identifier les contextes sp√©cifiques o√π les difficult√©s se manifestent (stress, sujets sensibles, pr√©sence de tiers).",
          "Mettre en place des outils simples de communication assertive (¬´ Je me sens... quand... j'aimerais... ¬ª).",
          "√âtablir des limites claires et coh√©rentes sur les sujets qui g√©n√®rent des tensions r√©p√©t√©es.",
          "Pratiquer des techniques de gestion du stress (respiration, pauses, journaling) pour pr√©server votre √©quilibre √©motionnel.",
          "Envisager une m√©diation familiale ou des s√©ances de th√©rapie br√®ve si les tensions s'intensifient.",
          "Constituer un r√©seau de soutien externe (ami(e)s, famille √©largie) pour ne pas d√©pendre uniquement de cette relation."
        ]
      },
      {
        min: 61, max: 90,
        level: "Pr√©sence Mod√©r√©e √† S√©v√®re",
        severity: "moderate",
        interpretation: "Manifestations significatives avec impact fonctionnel notable. Strat√©gies de protection et consultation professionnelle recommand√©es.",
        color: "#f59e0b",
        recommendations: [
          "Consulter un(e) psychologue sp√©cialis√©(e) en dynamiques familiales, trauma complexe ou attachement pour une √©valuation approfondie.",
          "Explorer des strat√©gies de d√©-parentification si applicable : restituer symboliquement les responsabilit√©s √©motionnelles √† l'adulte.",
          "Am√©nager votre environnement relationnel : limiter les contacts si cohabitation, structurer les √©changes (dur√©e, fr√©quence, sujets √©vit√©s).",
          "Pratiquer la technique du ¬´ grey rock ¬ª (interactions neutres, sans engagement √©motionnel) pour r√©duire les conflits.",
          "Tenir un journal de faits (dates, contextes, phrases exactes) pour objectiver les dynamiques et sortir du doute.",
          "Envisager un soutien juridique si violation de droits (vie priv√©e, sant√©, autonomie d√©cisionnelle).",
          "Rejoindre un groupe de soutien ou une association d'aide aux victimes de violences psychologiques intrafamiliales.",
          "√âlaborer un plan de s√©curit√© √©motionnelle : personnes-ressources, lieux refuge, strat√©gies d'apaisement."
        ]
      },
      {
        min: 91, max: 160,
        level: "Pr√©sence Tr√®s S√©v√®re",
        severity: "high",
        interpretation: "Niveau √©lev√© de toxicit√© n√©cessitant une attention urgente. Impact majeur sur le bien-√™tre psychologique et fonctionnel. Prise en charge sp√©cialis√©e fortement recommand√©e.",
        color: "#dc2626",
        recommendations: [
          "Consulter en urgence un(e) professionnel(le) qualifi√©(e) : psychologue clinicien(ne), psychiatre, travailleur(se) social(e), th√©rapeute sp√©cialis√©(e) en trauma.",
          "R√©aliser un bilan psychologique complet pour √©valuer l'impact sur l'estime de soi, les capacit√©s d'attachement et la sant√© mentale.",
          "Envisager une prise en charge multimodale : psychoth√©rapie (TCC, EMDR, th√©rapie d'attachement), √©ventuellement m√©dicamenteuse si comorbidit√©s.",
          "√âlaborer un plan de s√©paration progressive ou de rupture de contact si la relation met en danger votre int√©grit√© psychologique.",
          "Solliciter des am√©nagements contextuels : aide au logement, soutien financier, accompagnement juridique (protection de l'enfance si mineur, aide aux victimes si majeur).",
          "Rejoindre un groupe de soutien sp√©cialis√© (victimes de violences psychologiques, parentalit√© toxique, pervers narcissiques).",
          "√âvaluer les comorbidit√©s fr√©quentes : anxi√©t√© g√©n√©ralis√©e, d√©pression, stress post-traumatique complexe, troubles du sommeil, conduites addictives.",
          "Reconstruire progressivement un r√©seau social s√ªr, distinct de l'environnement familial toxique.",
          "Contacter le 119 (Enfance en Danger) si vous √™tes mineur(e) ou si un mineur est concern√©.",
          "Contacter le 3114 (pr√©vention suicide) ou les urgences (17/112) en cas de crise aigu√´."
        ]
      }
    ];

    /* ============================================
       FONCTIONS NAVIGATION
       ============================================ */
    function showScreen(screenName) {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById(screenName + '-screen').classList.add('active');
      state.currentScreen = screenName;
      window.scrollTo(0, 0);
    }

    function startTest() {
      // Collecter anamn√®se
      state.anamnesis.name = document.getElementById('user-name').value.trim() || 'Anonyme';
      state.anamnesis.age = parseInt(document.getElementById('user-age').value) || null;
      state.anamnesis.relationshipType = document.getElementById('relationship-type').value;
      state.anamnesis.livingSituation = document.getElementById('living-situation').value;
      state.anamnesis.duration = document.getElementById('duration').value;
      
      state.currentQuestionIndex = 0;
      state.answers = {};
      showScreen('test');
      renderQuestion();
    }

    function renderQuestion() {
      const q = QUESTIONS[state.currentQuestionIndex];
      const dim = DIMENSIONS.find(d => d.key === q.dim);
      
      // Update progress
      const progress = ((state.currentQuestionIndex + 1) / QUESTIONS.length) * 100;
      document.getElementById('progress-bar').style.width = progress + '%';
      document.getElementById('question-number-display').textContent = `Question ${state.currentQuestionIndex + 1} / ${QUESTIONS.length}`;
      document.getElementById('questions-remaining').textContent = `${QUESTIONS.length - state.currentQuestionIndex} questions restantes`;
      
      // Update question
      document.getElementById('question-number').textContent = `Question ${state.currentQuestionIndex + 1}`;
      document.getElementById('question-dimension-badge').textContent = dim.label;
      document.getElementById('question-dimension-badge').style.background = dim.bg;
      document.getElementById('question-dimension-badge').style.color = dim.color;
      document.getElementById('question-text').textContent = q.text;
      
      // Render options
      const optionsContainer = document.getElementById('answer-options');
      optionsContainer.innerHTML = SCALE_OPTIONS.map(opt => `
        <div class="answer-option ${state.answers[q.id] === opt.value ? 'selected' : ''}" 
             onclick="selectAnswer(${opt.value})">
          <div class="answer-label">${opt.label}</div>
          <div class="answer-sublabel">${opt.sublabel}</div>
        </div>
      `).join('');
      
      // Update prev button
      document.getElementById('prev-btn').disabled = state.currentQuestionIndex === 0;
    }

    function selectAnswer(value) {
      state.answers[QUESTIONS[state.currentQuestionIndex].id] = value;
      renderQuestion();
      
      // Progression automatique apr√®s 400ms
      setTimeout(() => {
        nextQuestion();
      }, 400);
    }

    function nextQuestion() {
      if (state.currentQuestionIndex < QUESTIONS.length - 1) {
        state.currentQuestionIndex++;
        renderQuestion();
      } else {
        showResults();
      }
    }

    function prevQuestion() {
      if (state.currentQuestionIndex > 0) {
        state.currentQuestionIndex--;
        renderQuestion();
      }
    }

    /* ============================================
       FONCTIONS SCORING
       ============================================ */
    function calculateScores() {
      const dimensions = {};
      let total = 0;
      
      DIMENSIONS.forEach(dim => {
        const questionsForDim = QUESTIONS.filter(q => q.dim === dim.key);
        const score = questionsForDim.reduce((sum, q) => {
          const answer = state.answers[q.id] || 0;
          return sum + answer;
        }, 0);
        const maxScore = questionsForDim.length * 4;
        const percentage = Math.round((score / maxScore) * 100);
        
        dimensions[dim.key] = { score, maxScore, percentage };
        total += score;
      });
      
      const maxTotal = QUESTIONS.length * 4;
      const riskIndex = calculateRiskIndex({ dimensions, total, maxTotal }, state.anamnesis);
      
      return { dimensions, total, maxTotal, riskIndex };
    }

    function getResultBand(totalScore, maxTotal) {
      const percentage = (totalScore / maxTotal) * 100;
      return RESULT_BANDS.find(band => percentage >= band.min && percentage <= band.max);
    }

    function calculateRiskIndex(scores, anamnesis) {
      let index = 0;
      
      // Base score total (50% poids)
      const totalPercentage = (scores.total / scores.maxTotal) * 100;
      index += totalPercentage * 0.5;
      
      // Modulateurs contextuels
      if (anamnesis.duration === 'chronique') index += 15;
      else if (anamnesis.duration === 'long') index += 10;
      else if (anamnesis.duration === 'moyen') index += 5;
      
      if (anamnesis.livingSituation === 'cohabitation') index += 10;
      else if (anamnesis.livingSituation === 'recomposee') index += 5;
      
      // Poids dimensions critiques (25% poids)
      const controlePercentage = scores.dimensions.controle.percentage;
      const instabilitePercentage = scores.dimensions.instabilite.percentage;
      const maxCritical = Math.max(controlePercentage, instabilitePercentage);
      index += maxCritical * 0.25;
      
      // Qualit√© r√©ponses : d√©tecter patterns uniformes (p√©nalit√©)
      const answersArray = Object.values(state.answers);
      const allSame = answersArray.every(v => v === answersArray[0]);
      if (allSame) index -= 20;
      
      return Math.max(0, Math.min(100, Math.round(index)));
    }

    /* ============================================
       FONCTION ANALYSE APPROFONDIE (OBLIGATOIRE)
       ============================================ */
    function generateProfileAnalysis(scores) {
      const analysis = {
        dominantDimensions: [],
        profilePattern: '',
        specificInsights: [],
        functionalImpact: '',
        developmentalConsiderations: '',
        interactionPatterns: ''
      };
      
      // 1. Identifier dimensions dominantes
      const dimArray = Object.entries(scores.dimensions)
        .map(([key, data]) => ({
          key,
          ...data,
          label: DIMENSIONS.find(d => d.key === key).fullLabel
        }))
        .sort((a, b) => b.percentage - a.percentage);
      
      analysis.dominantDimensions = dimArray.filter(d => d.percentage >= 60);
      
      // 2. D√©terminer pattern profil
      const high = dimArray.filter(d => d.percentage >= 70).map(d => d.key);
      const moderate = dimArray.filter(d => d.percentage >= 40 && d.percentage < 70).map(d => d.key);
      const low = dimArray.filter(d => d.percentage < 40).map(d => d.key);
      
      if (high.length >= 3) {
        analysis.profilePattern = 'Profil Global S√©v√®re';
        analysis.specificInsights.push(
          "Vos r√©sultats r√©v√®lent une pr√©sentation multidimensionnelle marqu√©e de parentalit√© toxique, avec des manifestations significatives dans la majorit√© des domaines √©valu√©s. Cette constellation de difficult√©s sugg√®re un impact fonctionnel √©tendu n√©cessitant une attention particuli√®re et un accompagnement professionnel."
        );
      } else if (high.includes('parentification') && high.includes('invalidation')) {
        analysis.profilePattern = 'Profil ¬´ Gardien √âmotionnel Invalid√© ¬ª';
        analysis.specificInsights.push(
          "Votre profil se caract√©rise par une double contrainte : on exige de vous que vous portiez la charge √©motionnelle de l'adulte (parentification) tout en invalidant syst√©matiquement vos propres besoins et ressentis. Cette configuration g√©n√®re confusion identitaire et culpabilit√© chronique, car vous √™tes √† la fois ¬´ indispensable ¬ª et ¬´ ill√©gitime ¬ª dans vos demandes."
        );
      } else if (high.includes('controle') && high.includes('instabilite')) {
        analysis.profilePattern = 'Profil ¬´ Forteresse Sous Surveillance ¬ª';
        analysis.specificInsights.push(
          "Votre profil r√©v√®le une combinaison d'intrusions massives dans votre vie priv√©e et d'instabilit√© √©motionnelle impr√©visible. Vous vivez sous surveillance constante tout en devant naviguer dans un climat affectif volatile. Cette association cr√©e un √©tat d'hypervigilance chronique et √©rode progressivement votre sentiment de s√©curit√© int√©rieure."
        );
      } else if (high.includes('instabilite') && moderate.includes('invalidation')) {
        analysis.profilePattern = 'Profil ¬´ Grand √âcart Affectif ¬ª';
        analysis.specificInsights.push(
          "Votre profil se caract√©rise par une alternance impr√©visible entre chaleur affective et rejet, amplifi√©e par l'invalidation r√©guli√®re de vos √©motions. Vous marchez constamment sur des ≈ìufs, tentant de d√©coder les signaux pour √©viter les repr√©sailles √©motionnelles. Cette instabilit√© chronique compromet votre capacit√© √† d√©velopper un attachement s√©cure."
        );
      } else if (dimArray[0].percentage - dimArray[dimArray.length-1].percentage > 40) {
        analysis.profilePattern = 'Profil H√©t√©rog√®ne';
        analysis.specificInsights.push(
          `Votre profil pr√©sente une h√©t√©rog√©n√©it√© marqu√©e, avec une pr√©dominance nette de la dimension ${dimArray[0].label} (${dimArray[0].percentage}%). Cette dispersion sugg√®re que les manifestations toxiques s'expriment de mani√®re s√©lective plut√¥t que g√©n√©ralis√©e, ce qui peut parfois rendre la situation plus difficile √† nommer et √† valider.`
        );
      } else {
        analysis.profilePattern = 'Profil √âquilibr√©';
        analysis.specificInsights.push(
          "Votre profil se caract√©rise par une distribution relativement homog√®ne des manifestations √† travers les diff√©rentes dimensions. Cette pr√©sentation sugg√®re un impact fonctionnel mod√©r√© mais √©tendu, affectant plusieurs sph√®res de votre bien-√™tre sans concentration excessive sur une dimension sp√©cifique."
        );
      }
      
      // 3. Impact fonctionnel
      const impactPercentage = scores.dimensions.impact.percentage;
      if (impactPercentage >= 70) {
        analysis.functionalImpact = `Votre score √©lev√© en Impact Fonctionnel (${impactPercentage}%) r√©v√®le que ces dynamiques affectent significativement votre quotidien : sommeil, concentration, capacit√© de travail, sant√© mentale. L'√©puisement √©motionnel chronique compromet votre capacit√© √† vous projeter sereinement dans l'avenir. Il est crucial de mettre en place des strat√©gies de protection imm√©diate et de consulter un professionnel pour √©viter l'aggravation des sympt√¥mes.`;
      } else if (impactPercentage >= 40) {
        analysis.functionalImpact = `Votre score en Impact Fonctionnel (${impactPercentage}%) indique que ces dynamiques commencent √† affecter votre fonctionnement quotidien de mani√®re notable. Vous ressentez probablement fatigue chronique, ruminations, tensions corporelles. C'est un signal d'alerte important : votre organisme vous signale qu'il est temps de prendre soin de vous et d'envisager des ajustements dans la relation.`;
      } else {
        analysis.functionalImpact = `Votre score en Impact Fonctionnel (${impactPercentage}%) sugg√®re que, malgr√© les difficult√©s relationnelles, vous parvenez encore √† pr√©server certaines capacit√©s d'adaptation. Toutefois, cette r√©silience ne doit pas masquer la n√©cessit√© d'agir pr√©ventivement pour √©viter l'√©puisement progressif.`;
      }
      
      // 4. Consid√©rations d√©veloppementales
      if (state.anamnesis.duration === 'chronique') {
        analysis.developmentalConsiderations = "Le caract√®re chronique de ces dynamiques (pr√©sentes depuis l'enfance ou depuis plus de 5 ans) sugg√®re un impact d√©veloppemental potentiellement profond. L'exposition prolong√©e √† la parentalit√© toxique peut affecter la construction identitaire, les sch√©mas d'attachement, la capacit√© √† poser des limites et l'estime de soi. Un travail th√©rapeutique focalis√© sur les traumas relationnels complexes peut s'av√©rer particuli√®rement b√©n√©fique.";
      } else if (state.anamnesis.age && state.anamnesis.age < 25) {
        analysis.developmentalConsiderations = "Votre √¢ge se situe dans une p√©riode de construction identitaire cruciale (adolescence/jeune adulte). Les dynamiques toxiques √† cette √©tape peuvent perturber l'autonomisation psychique, l'individuation et la capacit√© √† √©tablir des relations adultes saines. Il est essentiel de b√©n√©ficier d'un accompagnement pour naviguer cette transition tout en vous prot√©geant des atteintes √† votre d√©veloppement.";
      }
      
      // 5. Patterns d'interaction entre dimensions
      if (scores.dimensions.parentification.percentage > 65 && scores.dimensions.invalidation.percentage > 65) {
        analysis.interactionPatterns = "L'association Parentification-Invalidation cr√©e un effet amplificateur particuli√®rement toxique : on exige de vous que vous portiez la charge √©motionnelle de l'adulte tout en invalidant vos propres besoins. Cette double contrainte g√©n√®re confusion, culpabilit√© et difficult√© √† identifier vos propres limites l√©gitimes. Des approches th√©rapeutiques int√©grant la d√©-parentification et la validation √©motionnelle sont particuli√®rement indiqu√©es.";
      } else if (scores.dimensions.controle.percentage > 70 && scores.dimensions.instabilite.percentage > 70) {
        analysis.interactionPatterns = "La combinaison Contr√¥le-Instabilit√© constitue un facteur de vuln√©rabilit√© majeur : vous √™tes √† la fois sous surveillance constante ET expos√©(e) √† une impr√©visibilit√© √©motionnelle chronique. Cette configuration maintient un √©tat d'hypervigilance permanent qui √©puise vos ressources psychiques et compromet votre sentiment de s√©curit√© int√©rieure.";
      }
      
      // 6. Insights sp√©cifiques par dimension dominante
      analysis.dominantDimensions.forEach(dim => {
        if (dim.key === 'controle' && dim.percentage >= 75) {
          analysis.specificInsights.push(
            "‚ö†Ô∏è Votre niveau tr√®s √©lev√© de Contr√¥le & Intrusion r√©v√®le une violation massive de vos fronti√®res personnelles. Ces intrusions r√©p√©t√©es compromettent votre capacit√© √† d√©velopper un sentiment d'intimit√© et d'autonomie. Il est imp√©ratif d'√©tablir des limites strictes (verrouillage appareils, espace priv√© inviolable) et d'envisager une mise √† distance si la cohabitation maintient ce pattern."
          );
        }
        if (dim.key === 'instabilite' && dim.percentage >= 75) {
          analysis.specificInsights.push(
            "‚ö†Ô∏è Votre niveau tr√®s √©lev√© d'Instabilit√© √âmotionnelle & Coercition indique que vous vivez dans un climat affectif impr√©visible g√©n√©rant anxi√©t√© chronique et confusion. L'alternance chaleur/froid combin√©e au chantage affectif cr√©e un attachement dit ¬´ d√©sorganis√© ¬ª, o√π vous √™tes √† la fois attir√©e par la figure d'attachement (quand elle est chaleureuse) et effray√©e par elle (quand elle est hostile). Cela n√©cessite un travail th√©rapeutique sp√©cialis√© sur l'attachement."
          );
        }
      });
      
      // 7. Alerte comorbidit√©s
      if (scores.riskIndex > 70 && scores.dimensions.impact.percentage > 60) {
        analysis.specificInsights.push(
          "‚ö†Ô∏è Votre profil sugg√®re un risque √©lev√© de comorbidit√©s psychologiques : anxi√©t√© g√©n√©ralis√©e, sympt√¥mes d√©pressifs, stress post-traumatique complexe, troubles du sommeil, conduites d'√©vitement. Une √©valuation clinique compl√®te est fortement recommand√©e pour identifier et traiter ces dimensions."
        );
      }
      
      return analysis;
    }

    /* ============================================
       FONCTION INTERPR√âTATION DIMENSION
       ============================================ */
    function getDimensionInterpretation(dimKey, percentage) {
      if (percentage < 25) {
        return "Les indicateurs de cette dimension sont faibles ou absents. Votre fonctionnement dans ce domaine semble pr√©serv√©.";
      } else if (percentage < 50) {
        return "Pr√©sence l√©g√®re de difficult√©s dans cette dimension, sans retentissement majeur. Une vigilance pr√©ventive peut s'av√©rer utile.";
      } else if (percentage < 75) {
        return "Manifestations significatives dans cette dimension avec impact notable. Des strat√©gies compensatoires et un soutien externe sont recommand√©s.";
      } else {
        return "Niveau √©lev√© de difficult√©s dans cette dimension n√©cessitant attention prioritaire. Consultation professionnelle fortement recommand√©e.";
      }
    }

    /* ============================================
       FONCTION RENDU R√âSULTATS
       ============================================ */
    function renderResults() {
      const scores = calculateScores();
      const resultBand = getResultBand(scores.total, scores.maxTotal);
      
      // Date
      const now = new Date();
      const dateStr = now.toLocaleDateString('fr-FR', { 
        weekday: 'long', 
        year: 'numeric', 
        month: 'long', 
        day: 'numeric' 
      });
      const timeStr = now.toLocaleTimeString('fr-FR', { 
        hour: '2-digit', 
        minute: '2-digit' 
      });
      document.getElementById('results-date').textContent = `√âvaluation r√©alis√©e le ${dateStr} √† ${timeStr}`;
      
      // Hero Score
      document.getElementById('total-score-display').textContent = scores.total;
      document.getElementById('global-level-badge').textContent = resultBand.level;
      document.getElementById('global-level-badge').className = 'level-badge ' + resultBand.severity;
      document.getElementById('score-message').textContent = resultBand.interpretation;
      
      // Profil Anamnestique
      const relationshipLabels = {
        'mere': 'M√®re',
        'pere': 'P√®re',
        'beau-parent': 'Beau-parent',
        'tuteur': 'Tuteur/Tutrice',
        'grand-parent': 'Grand-parent',
        'autre': 'Autre figure parentale'
      };
      
      const situationLabels = {
        'cohabitation': 'Cohabitation',
        'distance': 'Contact √† distance',
        'recomposee': 'Famille recompos√©e',
        'separe': 'S√©par√©(e) g√©ographiquement',
        'rupture': 'Rupture de contact'
      };
      
      const durationLabels = {
        'recent': 'Moins de 6 mois',
        'moyen': '6 mois √† 2 ans',
        'long': '2 √† 5 ans',
        'chronique': 'Plus de 5 ans / Depuis l\'enfance'
      };
      
      const profileGrid = document.getElementById('profile-grid');
      profileGrid.innerHTML = `
        <div class="profile-item">
          <div class="profile-label">Identifiant</div>
          <div class="profile-value">${state.anamnesis.name}</div>
        </div>
        <div class="profile-item">
          <div class="profile-label">√Çge</div>
          <div class="profile-value">${state.anamnesis.age || 'Non pr√©cis√©'}</div>
        </div>
        <div class="profile-item">
          <div class="profile-label">Lien √©valu√©</div>
          <div class="profile-value">${relationshipLabels[state.anamnesis.relationshipType] || 'Non pr√©cis√©'}</div>
        </div>
        <div class="profile-item">
          <div class="profile-label">Situation</div>
          <div class="profile-value">${situationLabels[state.anamnesis.livingSituation] || 'Non pr√©cis√©'}</div>
        </div>
        <div class="profile-item">
          <div class="profile-label">Dur√©e</div>
          <div class="profile-value">${durationLabels[state.anamnesis.duration] || 'Non pr√©cis√©'}</div>
        </div>
      `;
      
      document.getElementById('risk-index-value').textContent = scores.riskIndex;
      
      // Analyse Dimensionnelle
      const dimensionAnalysis = document.getElementById('dimension-analysis');
      dimensionAnalysis.innerHTML = Object.entries(scores.dimensions).map(([key, data]) => {
        const dim = DIMENSIONS.find(d => d.key === key);
        const interpretation = getDimensionInterpretation(key, data.percentage);
        
        return `
          <div class="dimension-card ${key}">
            <div class="dimension-header">
              <span class="dimension-name">${dim.fullLabel}</span>
              <span class="dimension-score-display">${data.percentage}%</span>
            </div>
            <div class="dimension-bar-container">
              <div class="dimension-bar-fill" style="width: ${data.percentage}%; background: ${dim.color};"></div>
            </div>
            <p class="dimension-interpretation">${interpretation}</p>
          </div>
        `;
      }).join('');
      
      // ANALYSE APPROFONDIE (OBLIGATOIRE)
      const profileAnalysis = generateProfileAnalysis(scores);
      const analysisContainer = document.getElementById('profile-analysis-container');
      analysisContainer.innerHTML = `
        <div style="background: white; border: 2px solid var(--or-signature); 
                    border-radius: var(--radius-xl); padding: var(--s-6); margin-bottom: var(--s-6);">
          <h3 style="font-size: var(--fs-lg); color: var(--or-signature); margin-bottom: var(--s-3);">
            ${profileAnalysis.profilePattern}
          </h3>
        </div>
        
        ${profileAnalysis.specificInsights.length > 0 ? `
          <div style="margin-bottom: var(--s-6);">
            <h4 style="font-size: var(--fs-md); font-weight: 600; margin-bottom: var(--s-4);">
              Observations Cliniques
            </h4>
            ${profileAnalysis.specificInsights.map(insight => `
              <div style="margin-bottom: var(--s-4); padding: var(--s-4); 
                          background: white; border-left: 3px solid var(--or-signature); 
                          border-radius: var(--radius-md);">
                <p style="font-size: var(--fs-sm); line-height: var(--lh-relaxed); 
                          margin: 0; text-align: justify;">
                  ${insight}
                </p>
              </div>
            `).join('')}
          </div>
        ` : ''}
        
        ${profileAnalysis.functionalImpact ? `
          <div style="margin-bottom: var(--s-6);">
            <h4 style="font-size: var(--fs-md); font-weight: 600; margin-bottom: var(--s-3);">
              Impact Fonctionnel
            </h4>
            <p style="font-size: var(--fs-sm); line-height: var(--lh-relaxed); 
                      text-align: justify; padding: var(--s-4); 
                      background: white; border-radius: var(--radius-md);">
              ${profileAnalysis.functionalImpact}
            </p>
          </div>
        ` : ''}
        
        ${profileAnalysis.developmentalConsiderations ? `
          <div style="margin-bottom: var(--s-6);">
            <h4 style="font-size: var(--fs-md); font-weight: 600; margin-bottom: var(--s-3);">
              Consid√©rations D√©veloppementales
            </h4>
            <p style="font-size: var(--fs-sm); line-height: var(--lh-relaxed); 
                      text-align: justify; padding: var(--s-4); 
                      background: white; border-radius: var(--radius-md);">
              ${profileAnalysis.developmentalConsiderations}
            </p>
          </div>
        ` : ''}
        
        ${profileAnalysis.interactionPatterns ? `
          <div style="margin-bottom: var(--s-6);">
            <h4 style="font-size: var(--fs-md); font-weight: 600; margin-bottom: var(--s-3);">
              Interactions entre Dimensions
            </h4>
            <p style="font-size: var(--fs-sm); line-height: var(--lh-relaxed); 
                      text-align: justify; padding: var(--s-4); 
                      background: white; border-radius: var(--radius-md);">
              ${profileAnalysis.interactionPatterns}
            </p>
          </div>
        ` : ''}
        
        ${profileAnalysis.dominantDimensions.length > 0 ? `
          <div style="background: #FFFBEB; border: 2px solid #F59E0B; 
                      border-radius: var(--radius-lg); padding: var(--s-4);">
            <p style="font-size: var(--fs-sm); font-weight: 600; 
                      color: #92400E; margin-bottom: var(--s-2);">
              üìä Dimensions Pr√©dominantes (‚â•60%)
            </p>
            <p style="font-size: var(--fs-sm); color: #78350F; margin: 0;">
              ${profileAnalysis.dominantDimensions.map(d => 
                `<strong>${d.label}</strong> (${d.percentage}%)`
              ).join(' ‚Ä¢ ')}
            </p>
          </div>
        ` : ''}
      `;
      
      // Recommandations
      const recommendationList = document.getElementById('recommendation-list');
      recommendationList.innerHTML = resultBand.recommendations.map(rec => `
        <div class="recommendation-item">
          <p>${rec}</p>
        </div>
      `).join('');
    }

    /* ============================================
       FONCTIONS EXPORT
       ============================================ */
    function generatePDF() {
      const scores = calculateScores();
      const resultBand = getResultBand(scores.total, scores.maxTotal);
      const profileAnalysis = generateProfileAnalysis(scores);
      
      const relationshipLabels = {
        'mere': 'M√®re', 'pere': 'P√®re', 'beau-parent': 'Beau-parent',
        'tuteur': 'Tuteur/Tutrice', 'grand-parent': 'Grand-parent', 'autre': 'Autre'
      };
      
      const situationLabels = {
        'cohabitation': 'Cohabitation', 'distance': '√Ä distance',
        'recomposee': 'Famille recompos√©e', 'separe': 'S√©par√©(e)',
        'rupture': 'Rupture de contact'
      };
      
      const durationLabels = {
        'recent': '<6 mois', 'moyen': '6-24 mois',
        'long': '2-5 ans', 'chronique': '>5 ans / Enfance'
      };
      
      const printWindow = window.open('', '', 'width=210mm,height=297mm');
      
      printWindow.document.write(`
        <!DOCTYPE html>
        <html lang="fr">
        <head>
          <meta charset="UTF-8">
          <title>Rapport Parentalit√© Toxique ‚Äî ${state.anamnesis.name} ‚Äî NO√âSIS</title>
          <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@400;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
          
          <style>
            @page { size: A4 portrait; margin: 25mm 20mm; }
            * { margin: 0; padding: 0; box-sizing: border-box; }
            body {
              font-family: 'Inter', sans-serif;
              font-size: 10.5pt;
              line-height: 1.6;
              color: #0A0A0A;
              background: #FFFFFF;
            }
            h1, h2, h3 { 
              font-family: 'Fraunces', serif; 
              font-weight: 600; 
              color: #0A0A0A; 
              page-break-after: avoid; 
            }
            h1 { font-size: 22pt; margin-bottom: 8pt; letter-spacing: -0.02em; }
            h2 { 
              font-size: 16pt; 
              margin-top: 24pt; 
              margin-bottom: 12pt; 
              border-bottom: 1.5pt solid #C7A86D; 
              padding-bottom: 6pt; 
            }
            h3 { font-size: 13pt; margin-top: 18pt; margin-bottom: 8pt; color: #C7A86D; }
            h4 { font-size: 11.5pt; margin-top: 14pt; margin-bottom: 6pt; font-weight: 600; }
            p { margin-bottom: 10pt; text-align: justify; hyphens: auto; }
            strong { font-weight: 600; color: #0A0A0A; }
            
            .header {
              text-align: center;
              padding-bottom: 18pt;
              margin-bottom: 24pt;
              border-bottom: 2pt solid #C7A86D;
            }
            .logo { 
              font-family: 'Fraunces', serif; 
              font-size: 28pt; 
              font-weight: 700; 
              letter-spacing: 0.05em; 
              color: #C7A86D; 
              margin-bottom: 6pt; 
            }
            .document-title { 
              font-size: 11pt; 
              font-weight: 500; 
              color: rgba(10,10,10,0.7); 
              text-transform: uppercase; 
              letter-spacing: 0.08em; 
            }
            .metadata { 
              margin-top: 8pt; 
              font-size: 9pt; 
              color: rgba(10,10,10,0.5); 
            }
            
            .section { 
              margin-bottom: 24pt; 
              page-break-inside: avoid; 
            }
            
            .score-container {
              background: linear-gradient(135deg, #F7F5EF 0%, #F9F7F1 100%);
              border: 2pt solid #C7A86D;
              border-radius: 12pt;
              padding: 20pt;
              text-align: center;
              margin-bottom: 24pt;
            }
            
            .score-main {
              font-family: 'Fraunces', serif;
              font-size: 48pt;
              font-weight: 700;
              color: #C7A86D;
              line-height: 1;
              margin-bottom: 8pt;
            }
            
            .score-label {
              font-size: 10pt;
              font-weight: 600;
              color: rgba(10,10,10,0.6);
              text-transform: uppercase;
              letter-spacing: 0.08em;
              margin-bottom: 14pt;
            }
            
            .level-badge {
              display: inline-block;
              padding: 6pt 16pt;
              border-radius: 999pt;
              font-size: 11pt;
              font-weight: 700;
              text-transform: uppercase;
              letter-spacing: 0.05em;
              margin-bottom: 12pt;
            }
            
            .level-badge.minimal { background: #D1FAE5; color: #065F46; }
            .level-badge.low { background: #DBEAFE; color: #1E40AF; }
            .level-badge.moderate { background: #FED7AA; color: #92400E; }
            .level-badge.high { background: #FECACA; color: #991B1B; }
            
            .interpretation-text {
              font-size: 10pt;
              line-height: 1.6;
              color: rgba(10,10,10,0.75);
              margin-top: 8pt;
            }
            
            .profile-table {
              width: 100%;
              border-collapse: collapse;
              margin-bottom: 16pt;
            }
            
            .profile-table td {
              padding: 8pt 12pt;
              border: 1pt solid rgba(10,10,10,0.12);
              font-size: 10pt;
            }
            
            .profile-table td:first-child {
              font-weight: 600;
              background: #F7F5EF;
              width: 35%;
            }
            
            .dimension-grid {
              display: grid;
              grid-template-columns: 1fr;
              gap: 16pt;
              margin-top: 16pt;
            }
            
            .dimension-card {
              padding: 14pt;
              background: #FAFAFA;
              border-left: 3pt solid #C7A86D;
              border-radius: 8pt;
              page-break-inside: avoid;
            }
            
            .dimension-header {
              display: flex;
              justify-content: space-between;
              align-items: center;
              margin-bottom: 10pt;
            }
            
            .dimension-name {
              font-size: 11pt;
              font-weight: 600;
              color: #0A0A0A;
            }
            
            .dimension-score {
              font-size: 13pt;
              font-weight: 700;
              color: #C7A86D;
            }
            
            .dimension-bar {
              width: 100%;
              height: 10pt;
              background: #E5E5E5;
              border-radius: 999pt;
              overflow: hidden;
              margin-bottom: 10pt;
            }
            
            .dimension-bar-fill {
              height: 100%;
              background: linear-gradient(90deg, #C7A86D, #D4B980);
              border-radius: 999pt;
            }
            
            .dimension-description {
              font-size: 9.5pt;
              line-height: 1.5;
              color: rgba(10,10,10,0.7);
            }
            
            .analysis-box {
              background: #F7F5EF;
              border: 2pt solid #C7A86D;
              border-radius: 10pt;
              padding: 16pt;
              margin-bottom: 16pt;
              page-break-inside: avoid;
            }
            
            .analysis-box h3 {
              margin-top: 0;
              font-size: 12pt;
              color: #C7A86D;
            }
            
            .insight-item {
              margin-bottom: 12pt;
              padding-left: 12pt;
              border-left: 2pt solid #C7A86D;
            }
            
            .recommendation-list {
              list-style: none;
              counter-reset: rec-counter;
              margin-top: 16pt;
            }
            
            .recommendation-list li {
              counter-increment: rec-counter;
              margin-bottom: 12pt;
              padding-left: 32pt;
              position: relative;
              page-break-inside: avoid;
            }
            
            .recommendation-list li:before {
              content: counter(rec-counter);
              position: absolute;
              left: 0;
              top: 0;
              width: 24pt;
              height: 24pt;
              background: #C7A86D;
              color: white;
              border-radius: 50%;
              display: flex;
              align-items: center;
              justify-content: center;
              font-weight: 700;
              font-size: 10pt;
            }
            
            .warning-box {
              background: #FEF3C7;
              border: 2pt solid #F59E0B;
              border-radius: 10pt;
              padding: 16pt;
              margin-top: 24pt;
              page-break-inside: avoid;
            }
            
            .warning-box h4 {
              color: #92400E;
              margin-top: 0;
            }
            
            .warning-box p {
              font-size: 9.5pt;
              color: #78350F;
            }
            
            .footer {
              margin-top: 48pt;
              padding-top: 16pt;
              border-top: 1pt solid rgba(10,10,10,0.2);
              text-align: center;
              font-size: 9pt;
              color: rgba(10,10,10,0.5);
            }
            
            .footer-logo {
              font-family: 'Fraunces', serif;
              font-size: 18pt;
              font-weight: 700;
              letter-spacing: 0.05em;
              color: #C7A86D;
              margin-bottom: 8pt;
            }
            
            @media print {
              body { print-color-adjust: exact; -webkit-print-color-adjust: exact; }
              .section { page-break-inside: avoid; }
              h2 { page-break-after: avoid; }
            }
        
    /* ========================================
       NAVIGATION NOESIS
       ======================================== */
    nav {
        position: sticky;
        top: 0;
        background: var(--creme-principal);
        backdrop-filter: blur(20px) saturate(180%);
        border-bottom: 1px solid rgba(10, 10, 10, 0.08);
        padding: 20px 0;
        z-index: 2000;
        box-shadow: 0 1px 4px rgba(10, 10, 10, 0.08);
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    nav.scrolled {
        padding: 14px 0;
        background: var(--creme-principal);
        border-bottom: 1px solid rgba(10, 10, 10, 0.12);
        box-shadow: 0 2px 12px rgba(10, 10, 10, 0.12);
    }

    nav .container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        position: relative;
    }

    .logo {
        font-family: 'Cormorant Garamond', serif;
        font-size: 28px;
        font-weight: 700;
        letter-spacing: 0.25em;
        text-transform: uppercase;
        color: var(--noir-absolu);
        text-decoration: none;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        font-variant: small-caps;
        position: relative;
        display: flex;
        align-items: center;
    }

    nav.scrolled .logo {
        font-size: 24px;
    }

    .logo-text {
        position: relative;
    }

    .logo-text::before {
        content: '';
        position: absolute;
        width: 100%;
        height: 1px;
        bottom: -4px;
        left: 0;
        background: linear-gradient(90deg,
            transparent 0%,
            var(--or-signature) 50%,
            transparent 100%);
        opacity: 0;
        transition: opacity 0.4s ease;
    }

    .logo:hover {
        color: var(--or-riche);
        letter-spacing: 0.28em;
    }

    .logo:hover .logo-text::before {
        opacity: 1;
    }

    nav ul {
        display: flex;
        gap: 2px;
        list-style: none;
        align-items: center;
        background-color: var(--blanc-surface);
        border: 1px solid rgba(10, 10, 10, 0.12);
        border-radius: 50px;
        padding: 6px;
        box-shadow: 0 1px 3px rgba(10, 10, 10, 0.08);
    }

    nav li {
        position: relative;
    }

    nav a:not(.logo) {
        font-family: 'Source Sans Pro', sans-serif;
        font-size: 13px;
        font-weight: 600;
        color: var(--text-primary);
        text-decoration: none;
        position: relative;
        padding: 10px 18px;
        border-radius: 40px;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        display: inline-block;
        letter-spacing: 0.02em;
        white-space: nowrap;
    }

    nav a:not(.logo)::before {
        content: '';
        position: absolute;
        inset: 0;
        border-radius: 40px;
        background: linear-gradient(135deg,
            var(--or-signature) 0%,
            var(--or-riche) 100%);
        opacity: 0;
        transition: opacity 0.3s ease;
        z-index: -1;
    }

    nav a:not(.logo):hover {
        color: var(--noir-absolu);
        transform: translateY(-1px);
        box-shadow:
            0 4px 12px rgba(199, 168, 109, 0.3),
            0 2px 4px rgba(199, 168, 109, 0.2);
    }

    nav a:not(.logo):hover::before {
        opacity: 1;
    }

    nav a:not(.logo).active {
        color: var(--noir-absolu);
        background: linear-gradient(135deg,
            var(--or-signature) 0%,
            var(--or-riche) 100%);
        box-shadow:
            0 4px 12px rgba(199, 168, 109, 0.35),
            0 2px 4px rgba(199, 168, 109, 0.25);
    }

    /* Boutons sociaux dans nav */
    .nav-social {
        display: flex;
        align-items: center;
        gap: 4px;
        margin-left: 16px;
        padding-left: 16px;
        border-left: 1px solid rgba(10, 10, 10, 0.12);
    }

    .nav-social-link {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 44px;
        height: 44px;
        border-radius: 50%;
        background: transparent;
        color: var(--text-primary);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        text-decoration: none;
        position: relative;
    }

    .nav-social-link svg {
        width: 20px;
        height: 20px;
        stroke-width: 1.5;
    }

    .nav-social-link::before {
        content: '';
        position: absolute;
        inset: 0;
        border-radius: 50%;
        background: linear-gradient(135deg,
            var(--or-signature) 0%,
            var(--or-riche) 100%);
        opacity: 0;
        transition: opacity 0.3s ease;
        z-index: -1;
    }

    .nav-social-link:hover {
        color: var(--noir-absolu);
        transform: translateY(-1px);
        box-shadow:
            0 4px 12px rgba(199, 168, 109, 0.3),
            0 2px 4px rgba(199, 168, 109, 0.2);
    }

    .nav-social-link:hover::before {
        opacity: 1;
    }

    /* ============================================
       MENU HAMBURGER MOBILE
       ============================================ */
    .menu-toggle {
        display: none;
        flex-direction: column;
        gap: 6px;
        background: transparent;
        border: none;
        cursor: pointer;
        padding: 8px;
        z-index: 2002;
        position: relative;
        transition: all 0.3s ease;
    }

    .menu-toggle span {
        width: 28px;
        height: 2px;
        background: var(--or-signature);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        border-radius: 2px;
    }

    .menu-toggle.active span:nth-child(1) {
        transform: rotate(45deg) translate(8px, 8px);
    }

    .menu-toggle.active span:nth-child(2) {
        opacity: 0;
    }

    .menu-toggle.active span:nth-child(3) {
        transform: rotate(-45deg) translate(7px, -7px);
    }

    /* Responsive Navigation */
    @media (max-width: 1024px) {
        nav .container {
            padding: 0 24px;
            position: relative;
        }

        .menu-toggle {
            display: flex;
            position: relative;
            z-index: 2002;
        }

        nav ul {
            position: fixed;
            top: 0;
            right: -100%;
            height: 100vh;
            width: 320px;
            max-width: 85vw;
            flex-direction: column;
            background: linear-gradient(180deg,
                var(--noir-absolu) 0%,
                var(--noir-surface) 100%);
            padding: 100px 32px 40px;
            gap: 0;
            border-radius: 0;
            border: none;
            border-left: 1px solid rgba(199, 168, 109, 0.2);
            box-shadow:
                -4px 0 24px rgba(0, 0, 0, 0.8),
                -8px 0 48px rgba(0, 0, 0, 0.5);
            transition: right 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            overflow-y: auto;
        }

        nav ul.active {
            right: 0;
        }

        nav li {
            width: 100%;
            margin-bottom: 12px;
        }

        nav a:not(.logo) {
            display: block;
            width: 100%;
            padding: 16px 20px;
            font-size: 15px;
            text-align: left;
            touch-action: manipulation;
            border-radius: 8px;
        }

        .nav-social {
            margin-left: 0;
            padding-left: 0;
            padding-top: 24px;
            margin-top: 24px;
            border-left: none;
            border-top: 1px solid rgba(199, 168, 109, 0.2);
            justify-content: flex-start;
            gap: 12px;
        }

        .nav-social-link {
            width: 42px;
            height: 42px;
        }

        .nav-social-link svg {
            width: 20px;
            height: 20px;
        }

        /* Overlay pour fermer le menu */
        .menu-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: rgba(10, 10, 10, 0.8);
            backdrop-filter: blur(4px);
            z-index: 1999;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .menu-overlay.active {
            display: block;
            opacity: 1;
        }
    }

    @media (max-width: 768px) {
        nav {
            padding: 16px 0;
        }

        nav.scrolled {
            padding: 12px 0;
        }

        .logo {
            font-size: 22px;
        }

        nav.scrolled .logo {
            font-size: 20px;
        }

        nav ul {
            width: 280px;
            padding: 80px 24px 32px;
        }
    }
  </style>
        </head>
        <body>
  <!-- Header -->
          <div class="header">
            <div class="logo">NO√âSIS</div>
            <div class="document-title">Rapport d'√âvaluation ‚Äî Parentalit√© Toxique</div>
            <div class="metadata">
              Participant : ${state.anamnesis.name} ‚Ä¢ 
              G√©n√©r√© le ${new Date().toLocaleDateString('fr-FR', { 
                weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' 
              })} √† ${new Date().toLocaleTimeString('fr-FR', { 
                hour: '2-digit', minute: '2-digit' 
              })}
            </div>
          </div>
          
          <!-- Score Principal -->
          <div class="section">
            <div class="score-container">
              <div class="score-main">
                ${scores.total}<span style="font-size: 24pt; color: rgba(10,10,10,0.3);">/${scores.maxTotal}</span>
              </div>
              <div class="score-label">Score Total</div>
              <div class="level-badge ${resultBand.severity}">${resultBand.level}</div>
              <p class="interpretation-text">${resultBand.interpretation}</p>
            </div>
          </div>
          
          <!-- Profil & Contexte -->
          <div class="section">
            <h2>Profil & Contexte</h2>
            <table class="profile-table">
              <tr>
                <td>Identifiant</td>
                <td>${state.anamnesis.name}</td>
              </tr>
              <tr>
                <td>√Çge</td>
                <td>${state.anamnesis.age || 'Non pr√©cis√©'}</td>
              </tr>
              <tr>
                <td>Lien √©valu√©</td>
                <td>${relationshipLabels[state.anamnesis.relationshipType] || 'Non pr√©cis√©'}</td>
              </tr>
              <tr>
                <td>Situation</td>
                <td>${situationLabels[state.anamnesis.livingSituation] || 'Non pr√©cis√©'}</td>
              </tr>
              <tr>
                <td>Dur√©e d'exposition</td>
                <td>${durationLabels[state.anamnesis.duration] || 'Non pr√©cis√©'}</td>
              </tr>
              <tr>
                <td>Indice de Risque Composite</td>
                <td><strong>${scores.riskIndex} / 100</strong></td>
              </tr>
            </table>
            <p style="font-size: 9pt; color: rgba(10,10,10,0.6);">
              L'indice de risque composite int√®gre les scores dimensionnels, la dur√©e d'exposition, 
              et la pr√©sence de facteurs contextuels aggravants.
            </p>
          </div>
          
          <!-- Analyse par Dimension -->
          <div class="section">
            <h2>Analyse par Dimension</h2>
            <div class="dimension-grid">
              ${Object.entries(scores.dimensions).map(([key, data]) => {
                const dim = DIMENSIONS.find(d => d.key === key);
                const interpretation = getDimensionInterpretation(key, data.percentage);
                return `
                  <div class="dimension-card">
                    <div class="dimension-header">
                      <span class="dimension-name">${dim.fullLabel}</span>
                      <span class="dimension-score">${data.score}/${data.maxScore} (${data.percentage}%)</span>
                    </div>
                    <div class="dimension-bar">
                      <div class="dimension-bar-fill" style="width: ${data.percentage}%"></div>
                    </div>
                    <p class="dimension-description">${interpretation}</p>
                  </div>
                `;
              }).join('')}
            </div>
          </div>
          
          <!-- ANALYSE APPROFONDIE DU PROFIL -->
          <div class="section">
            <h2>Analyse Approfondie du Profil</h2>
            
            <div class="analysis-box">
              <h3>${profileAnalysis.profilePattern}</h3>
            </div>
            
            ${profileAnalysis.specificInsights.length > 0 ? `
              <div style="margin-bottom: 18pt;">
                <h4>Observations Cliniques</h4>
                ${profileAnalysis.specificInsights.map(insight => `
                  <div class="insight-item">
                    <p style="margin-bottom: 0; font-size: 10pt; text-align: justify;">
                      ${insight}
                    </p>
                  </div>
                `).join('')}
              </div>
            ` : ''}
            
            ${profileAnalysis.functionalImpact ? `
              <div style="margin-bottom: 18pt;">
                <h4>Impact Fonctionnel</h4>
                <p style="font-size: 10pt; text-align: justify;">${profileAnalysis.functionalImpact}</p>
              </div>
            ` : ''}
            
            ${profileAnalysis.developmentalConsiderations ? `
              <div style="margin-bottom: 18pt;">
                <h4>Consid√©rations D√©veloppementales</h4>
                <p style="font-size: 10pt; text-align: justify;">${profileAnalysis.developmentalConsiderations}</p>
              </div>
            ` : ''}
            
            ${profileAnalysis.interactionPatterns ? `
              <div style="margin-bottom: 18pt;">
                <h4>Interactions entre Dimensions</h4>
                <p style="font-size: 10pt; text-align: justify;">${profileAnalysis.interactionPatterns}</p>
              </div>
            ` : ''}
            
            ${profileAnalysis.dominantDimensions.length > 0 ? `
              <div style="background: #FFFBEB; border: 1pt solid #F59E0B; 
                          border-radius: 6pt; padding: 12pt; margin-top: 16pt;">
                <p style="font-size: 10pt; font-weight: 600; color: #92400E; margin-bottom: 6pt;">
                  üìä Dimensions Pr√©dominantes (‚â•60%)
                </p>
                <p style="font-size: 9.5pt; color: #78350F; margin-bottom: 0;">
                  ${profileAnalysis.dominantDimensions.map(d => 
                    `${d.label} (${d.percentage}%)`
                  ).join(' ‚Ä¢ ')}
                </p>
              </div>
            ` : ''}
          </div>
          
          <!-- D√âTAIL DES R√âPONSES -->
          <div class="section">
            <h2>D√©tail des R√©ponses</h2>
            <p style="font-size: 9.5pt; color: rgba(10,10,10,0.7); margin-bottom: 14pt;">
              Cette section pr√©sente l'ensemble des questions pos√©es et vos r√©ponses respectives, 
              organis√©es par dimension.
            </p>
            ${DIMENSIONS.map(dim => {
              const questionsForDim = QUESTIONS.filter(q => q.dim === dim.key);
              return `
                <div style="margin-bottom: 20pt; page-break-inside: avoid;">
                  <h3 style="color: ${dim.color}; margin-bottom: 10pt;">${dim.fullLabel}</h3>
                  ${questionsForDim.map((q, idx) => {
                    const answer = state.answers[q.id];
                    const answerLabel = SCALE_OPTIONS.find(opt => opt.value === answer);
                    return `
                      <div style="margin-bottom: 12pt; padding-left: 12pt; 
                                  border-left: 2pt solid #E5E5E5; page-break-inside: avoid;">
                        <p style="font-size: 10pt; font-weight: 600; margin-bottom: 4pt; 
                                  color: rgba(10,10,10,0.8);">
                          Question ${QUESTIONS.indexOf(q) + 1} : ${q.text}
                        </p>
                        <p style="font-size: 9.5pt; margin-bottom: 2pt;">
                          <strong style="color: #C7A86D;">R√©ponse :</strong> 
                          ${answerLabel ? answerLabel.label : 'Non r√©pondu'}
                          ${answerLabel && answerLabel.sublabel ? 
                            `<span style="color: rgba(10,10,10,0.6); font-size: 9pt;">
                              (${answerLabel.sublabel})
                            </span>` : ''}
                        </p>
                      </div>
                    `;
                  }).join('')}
                </div>
              `;
            }).join('')}
          </div>
          
          <!-- Recommandations -->
          <div class="section">
            <h2>Recommandations Personnalis√©es</h2>
            <ol class="recommendation-list">
              ${resultBand.recommendations.map(rec => 
                `<li style="font-size: 10pt; line-height: 1.6; text-align: justify;">${rec}</li>`
              ).join('')}
            </ol>
          </div>
          
          <!-- Warning Box -->
          <div class="warning-box">
            <h4>‚ö† Avertissement Important</h4>
            <p>
              Ce questionnaire constitue un outil de sensibilisation et ne remplace en aucun cas 
              une consultation avec un professionnel qualifi√©. Les r√©sultats refl√®tent votre 
              perception subjective et n√©cessitent interpr√©tation contextuelle.
            </p>
            <p style="margin-top: 8pt;">
              <strong>Ressources France :</strong><br>
              ‚Ä¢ 119 ‚Äî Enfance en Danger (24/7, gratuit)<br>
              ‚Ä¢ 3114 ‚Äî Pr√©vention suicide (24/7)<br>
              ‚Ä¢ 17 / 112 ‚Äî Urgences / Police<br>
              ‚Ä¢ CIDFF (Centres Droits des Femmes et Familles)<br>
              ‚Ä¢ Associations d'aide aux victimes de violences intrafamiliales
            </p>
          </div>
          
          <!-- Footer -->
          <div class="footer">
            <div class="footer-logo">NO√âSIS</div>
            <p>Intelligence transdisciplinaire au service de la lucidit√©</p>
            <p style="margin-top: 8pt;">¬© ${new Date().getFullYear()} NO√âSIS ‚Äî Tous droits r√©serv√©s</p>
            <p style="margin-top: 6pt; font-size: 8pt;">
              Outil de sensibilisation et pr√©-√©valuation ‚Äî Non valid√© psychom√©triquement<br>
              Ne remplace pas une consultation avec un professionnel qualifi√©<br>
              Confidentialit√© : aucune donn√©e collect√©e sans action explicite
            </p>
          </div>
          
        </body>
        </html>
      `);
      
      printWindow.document.close();
      
      setTimeout(() => {
        printWindow.print();
      }, 800);
    }

    function downloadJSON() {
      const scores = calculateScores();
      const resultBand = getResultBand(scores.total, scores.maxTotal);
      
      const data = {
        metadata: {
          test: "Parentalit√© Toxique",
          version: "1.0 - NO√âSIS",
          theoreticalFramework: "√âvaluation multidimensionnelle des dynamiques familiales toxiques",
          date: new Date().toISOString(),
          participant: state.anamnesis.name || 'Anonyme'
        },
        anamnesis: state.anamnesis,
        responses: {
          answers: state.answers,
          completion: `${Object.keys(state.answers).length}/${QUESTIONS.length}`
        },
        scoring: {
          total: scores.total,
          maxTotal: scores.maxTotal,
          percentage: Math.round((scores.total/scores.maxTotal)*100),
          riskIndex: scores.riskIndex,
          dimensions: scores.dimensions,
          resultBand: {
            level: resultBand.level,
            severity: resultBand.severity,
            interpretation: resultBand.interpretation
          }
        },
        detailedResponses: QUESTIONS.map(q => ({
          id: q.id,
          dimension: q.dim,
          text: q.text,
          response: {
            value: state.answers[q.id],
            label: SCALE_OPTIONS.find(opt => opt.value === state.answers[q.id])?.label,
            sublabel: SCALE_OPTIONS.find(opt => opt.value === state.answers[q.id])?.sublabel
          }
        }))
      };
      
      const blob = new Blob([JSON.stringify(data, null, 2)], { 
        type: 'application/json;charset=utf-8' 
      });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `noesis-parentalite-toxique-${Date.now()}.json`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    function sendResultsByEmail() {
      const scores = calculateScores();
      const resultBand = getResultBand(scores.total, scores.maxTotal);
      
      const emailBody = `
Rapport NO√âSIS ‚Äî Parentalit√© Toxique
Participant : ${state.anamnesis.name || 'Anonyme'}
G√©n√©r√© le ${new Date().toLocaleDateString('fr-FR')}

SCORE TOTAL : ${scores.total}/${scores.maxTotal} (${Math.round((scores.total/scores.maxTotal)*100)}%)
NIVEAU : ${resultBand.level}
INDICE DE RISQUE COMPOSITE : ${scores.riskIndex} / 100

ANALYSE DIMENSIONNELLE :
${Object.entries(scores.dimensions).map(([key, data]) => {
  const dim = DIMENSIONS.find(d => d.key === key);
  return `‚Ä¢ ${dim.fullLabel} : ${data.percentage}%`;
}).join('\n')}

PROFIL :
‚Ä¢ √Çge : ${state.anamnesis.age || 'Non pr√©cis√©'}
‚Ä¢ Lien √©valu√© : ${state.anamnesis.relationshipType || 'Non pr√©cis√©'}
‚Ä¢ Situation : ${state.anamnesis.livingSituation || 'Non pr√©cis√©'}
‚Ä¢ Dur√©e : ${state.anamnesis.duration || 'Non pr√©cis√©'}

Pour consulter le rapport complet avec analyses approfondies et recommandations personnalis√©es, 
veuillez t√©l√©charger la version PDF depuis l'interface NO√âSIS.

---
NO√âSIS ‚Äî Intelligence transdisciplinaire
¬© ${new Date().getFullYear()} ‚Äî Tous droits r√©serv√©s
      `.trim();
      
      const subject = `Rapport Parentalit√© Toxique ‚Äî ${state.anamnesis.name || 'Anonyme'} ‚Äî NO√âSIS`;
      const mailtoLink = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(emailBody)}`;
      
      window.location.href = mailtoLink;
    }

    function resetTest() {
      if (confirm("√ätes-vous s√ªr¬∑e de vouloir recommencer ? Toutes vos r√©ponses seront perdues.")) {
        location.reload();
      }
    }

    /* ============================================
       INITIALISATION
       ============================================ */
    document.addEventListener('DOMContentLoaded', function() {
      // Enable start button when consent is checked
      document.getElementById('consent-check').addEventListener('change', function() {
        document.getElementById('start-btn').disabled = !this.checked;
      });
      
      // Start button
      document.getElementById('start-btn').addEventListener('click', startTest);
    });

    /* ========================================
       MENU HAMBURGER MOBILE - NAVIGATION
       ======================================== */
    // Navbar scroll effect
    window.addEventListener('scroll', () => {
      const navbar = document.getElementById('navbar');
      if (navbar && window.scrollY > 100) {
        navbar.classList.add('scrolled');
      } else if (navbar) {
        navbar.classList.remove('scrolled');
      }
    });

    // Menu hamburger mobile
    const menuToggle = document.getElementById('menuToggle');
    const navMenu = document.getElementById('navMenu');
    const menuOverlay = document.getElementById('menuOverlay');
    const body = document.body;

    function toggleMenu() {
      if (menuToggle && navMenu) {
        menuToggle.classList.toggle('active');
        navMenu.classList.toggle('active');
        if (menuOverlay) {
          menuOverlay.classList.toggle('active');
        }
        body.style.overflow = navMenu.classList.contains('active') ? 'hidden' : '';
      }
    }

    if (menuToggle) {
      menuToggle.addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        toggleMenu();
      });
    }

    if (menuOverlay) {
      menuOverlay.addEventListener('click', toggleMenu);
    }

    // Fermer le menu quand on clique sur un lien
    if (navMenu) {
      const navLinks = navMenu.querySelectorAll('a');
      navLinks.forEach(link => {
        link.addEventListener('click', () => {
          if (window.innerWidth <= 1024) {
            setTimeout(toggleMenu, 100);
          }
        });
      });
    }

  </script>

</body>
</html>
