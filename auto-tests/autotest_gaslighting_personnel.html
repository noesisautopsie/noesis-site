<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Autotest Gaslighting Personnel ‚Äî D√©tection Emprise & Manipulation | NO√âSIS</title>
  <meta name="description" content="Outil d'auto-√©valuation rigoureux pour d√©tecter les dynamiques de gaslighting dans les relations personnelles. Analyse multidimensionnelle, plan de s√©curit√© et ressources d'urgence.">
  
  <!-- Open Graph -->
  <meta property="og:title" content="Autotest Gaslighting Personnel ‚Äî NO√âSIS">
  <meta property="og:description" content="D√©tection rigoureuse du gaslighting : distorsion de r√©alit√©, d√©stabilisation √©motionnelle, isolement. Outil de protection avec ressources d'urgence.">
  <meta property="og:type" content="website">
  
  <!-- Polices Google -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@300;400;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <style>
    /* ==================== VARIABLES CSS NO√âSIS ==================== */
    :root {
      /* Palette Chromatique NO√âSIS */
      --noir-absolu: #0A0A0A;
      --noir-doux: #111111;
      --noir-surface: #1A1A1A;
      --creme-principal: #F7F5EF;
      --creme-chaud: #F9F7F1;
      --blanc-surface: #FFFFFF;
      --or-signature: #C7A86D;
      --or-riche: #D4B980;
      --or-sombre: #A89158;
      --or-subtil: rgba(199,168,109,.08);
      --or-leger: rgba(199,168,109,.15);
      --or-moyen: rgba(199,168,109,.25);
      
      /* Dimensions Th√©matiques Gaslighting */
      --distorsion-color: #dc2626;
      --distorsion-bg: rgba(220,38,38,0.08);
      --destabilisation-color: #ea580c;
      --destabilisation-bg: rgba(234,88,12,0.08);
      --isolement-color: #B81E30;
      --isolement-bg: rgba(184,30,48,0.08);
      --renversement-color: #7c3aed;
      --renversement-bg: rgba(124,58,237,0.08);
      --impact-color: #0284c7;
      --impact-bg: rgba(2,132,199,0.08);
      
      /* Typographie */
      --fs-xs: 12px; --fs-sm: 14px; --fs-md: 18px;
      --fs-lg: 21px; --fs-xl: 24px; --fs-2xl: 32px;
      --fs-3xl: 42px; --fs-4xl: 56px;
      --lh-tight: 1.2; --lh-normal: 1.5; --lh-relaxed: 1.7;
      
      /* Spacing (√©chelle 8px) */
      --s-2: 8px; --s-3: 12px; --s-4: 16px; --s-6: 24px;
      --s-8: 32px; --s-12: 48px; --s-16: 64px; --s-20: 80px;
      
      /* Ombres */
      --shadow-soft: 0 2px 8px rgba(10,10,10,.08), 0 1px 2px rgba(10,10,10,.12);
      --shadow-medium: 0 4px 16px rgba(10,10,10,.1), 0 2px 4px rgba(10,10,10,.15);
      --shadow-large: 0 8px 32px rgba(10,10,10,.12), 0 2px 8px rgba(10,10,10,.18);
      
      /* Bordures */
      --border-subtil: rgba(10,10,10,.08);
      --border-leger: rgba(10,10,10,.12);
      --border-visible: rgba(10,10,10,.18);
      
      /* Rayons */
      --radius-sm: 4px; --radius-md: 8px; --radius-lg: 12px;
      --radius-xl: 16px; --radius-2xl: 24px; --radius-pill: 9999px;
      
      /* Transitions */
      --ease-standard: cubic-bezier(0.4, 0.0, 0.2, 1);
      --ease-spring: cubic-bezier(0.16, 1, 0.3, 1);
      --duration-fast: 150ms; --duration-normal: 250ms; --duration-slow: 350ms;
    }
    
    /* ==================== RESET & BASE ==================== */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Inter', sans-serif;
      font-size: var(--fs-md);
      line-height: var(--lh-relaxed);
      color: var(--noir-absolu);
      background: var(--creme-principal);
      -webkit-font-smoothing: antialiased;
    }
    
    h1, h2, h3, h4, h5 {
      font-family: 'Fraunces', serif;
      font-weight: 600;
      line-height: var(--lh-tight);
    }
    
    /* ==================== LAYOUT ==================== */
    .app-container {
      max-width: 900px;
      margin: 0 auto;
      padding: var(--s-12) var(--s-6);
    }
    
    .screen {
      display: none;
    }
    
    .screen.active {
      display: block;
      animation: fadeIn var(--duration-normal) var(--ease-standard);
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(8px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* ==================== √âCRAN INTRO ==================== */
    .intro-header {
      text-align: center;
      margin-bottom: var(--s-12);
    }
    
    .icon-container {
      width: 80px;
      height: 80px;
      margin: 0 auto var(--s-4);
      background: linear-gradient(135deg, var(--or-subtil), var(--or-leger));
      border: 2px solid var(--or-signature);
      border-radius: var(--radius-xl);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .icon-svg {
      width: 40px;
      height: 40px;
      stroke: var(--or-signature);
      fill: none;
    }
    
    .intro-title {
      font-size: var(--fs-3xl);
      color: var(--noir-absolu);
      margin-bottom: var(--s-3);
    }
    
    .intro-subtitle {
      font-size: var(--fs-md);
      color: rgba(10,10,10,0.6);
      font-weight: 400;
    }
    
    /* Cartes */
    .card {
      background: var(--blanc-surface);
      border-radius: var(--radius-2xl);
      padding: var(--s-12);
      margin-bottom: var(--s-8);
      box-shadow: var(--shadow-large);
    }
    
    .card h2 {
      font-size: var(--fs-xl);
      margin-bottom: var(--s-6);
      display: flex;
      align-items: center;
      gap: var(--s-3);
    }
    
    .card-icon {
      width: 24px;
      height: 24px;
      stroke: var(--or-signature);
    }
    
    .card p {
      font-size: var(--fs-md);
      line-height: var(--lh-relaxed);
      color: rgba(10,10,10,0.8);
      margin-bottom: var(--s-4);
    }
    
    .card p:last-child {
      margin-bottom: 0;
    }
    
    /* Warning Box */
    .warning-box {
      background: #FEF2F2;
      border-left: 4px solid #dc2626;
      border-radius: var(--radius-md);
      padding: var(--s-6);
      margin-bottom: var(--s-8);
    }
    
    .warning-box h3 {
      font-size: var(--fs-lg);
      margin-bottom: var(--s-3);
      display: flex;
      align-items: center;
      gap: var(--s-2);
      color: #991b1b;
    }
    
    .warning-icon {
      width: 20px;
      height: 20px;
      stroke: #dc2626;
      fill: none;
    }
    
    .warning-box p {
      font-size: var(--fs-sm);
      line-height: var(--lh-relaxed);
      color: rgba(10,10,10,0.75);
      margin-bottom: var(--s-3);
    }
    
    .warning-box p:last-child {
      margin-bottom: 0;
    }
    
    .emergency-contact {
      background: #dc2626;
      color: white;
      padding: var(--s-4);
      border-radius: var(--radius-md);
      font-weight: 600;
      margin-top: var(--s-4);
    }
    
    .emergency-contact a {
      color: white;
      text-decoration: underline;
    }
    
    /* Dimensions List */
    .dimensions-list {
      display: grid;
      gap: var(--s-4);
    }
    
    .dimension-item {
      background: var(--creme-chaud);
      border-left: 3px solid var(--distorsion-color);
      border-radius: var(--radius-md);
      padding: var(--s-4);
      transition: transform var(--duration-normal) var(--ease-standard);
    }
    
    .dimension-item:hover {
      transform: translateX(4px);
    }
    
    .dimension-item.distorsion { border-left-color: var(--distorsion-color); }
    .dimension-item.destabilisation { border-left-color: var(--destabilisation-color); }
    .dimension-item.isolement { border-left-color: var(--isolement-color); }
    .dimension-item.renversement { border-left-color: var(--renversement-color); }
    .dimension-item.impact { border-left-color: var(--impact-color); }
    
    .dimension-item h3 {
      font-size: var(--fs-md);
      font-weight: 600;
      margin-bottom: var(--s-2);
    }
    
    .dimension-item p {
      font-size: var(--fs-sm);
      color: rgba(10,10,10,0.7);
      line-height: var(--lh-normal);
    }
    
    /* Methodology Grid */
    .methodology-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: var(--s-4);
      margin-top: var(--s-6);
    }
    
    .methodology-item {
      text-align: center;
      padding: var(--s-4);
      background: var(--creme-chaud);
      border-radius: var(--radius-lg);
    }
    
    .methodology-icon {
      width: 32px;
      height: 32px;
      margin: 0 auto var(--s-3);
      stroke: var(--or-signature);
    }
    
    .methodology-label {
      font-size: var(--fs-md);
      font-weight: 600;
      margin-bottom: var(--s-2);
    }
    
    .methodology-description {
      font-size: var(--fs-sm);
      color: rgba(10,10,10,0.6);
    }
    
    /* Form Groups */
    .form-group {
      margin-bottom: var(--s-6);
    }
    
    .form-group label {
      display: block;
      font-weight: 600;
      margin-bottom: var(--s-2);
      font-size: var(--fs-sm);
    }
    
    .form-group input,
    .form-group select {
      width: 100%;
      padding: var(--s-3);
      border: 1.5px solid var(--border-leger);
      border-radius: var(--radius-md);
      font-size: var(--fs-sm);
      font-family: inherit;
      transition: border-color var(--duration-normal) var(--ease-standard);
    }
    
    .form-group input:focus,
    .form-group select:focus {
      outline: none;
      border-color: var(--or-signature);
    }
    
    .form-group input[type="checkbox"] {
      width: auto;
      margin-right: var(--s-2);
    }
    
    .form-group label span {
      font-size: var(--fs-sm);
      font-weight: 400;
      line-height: var(--lh-relaxed);
    }
    
    /* Boutons */
    .btn {
      padding: var(--s-4) var(--s-12);
      border: none;
      border-radius: var(--radius-pill);
      font-family: 'Inter', sans-serif;
      font-size: var(--fs-md);
      font-weight: 600;
      cursor: pointer;
      transition: all var(--duration-normal) var(--ease-standard);
      display: inline-block;
      text-align: center;
      text-decoration: none;
    }
    
    .btn-primary {
      background: var(--or-signature);
      color: white;
    }
    
    .btn-primary:hover:not(:disabled) {
      background: var(--or-riche);
      transform: scale(1.02);
      box-shadow: var(--shadow-medium);
    }
    
    .btn-primary:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    .btn-secondary {
      background: transparent;
      color: var(--or-sombre);
      border: 1.5px solid var(--or-signature);
    }
    
    .btn-secondary:hover {
      background: var(--or-subtil);
    }
    
    .btn-large {
      width: 100%;
      padding: var(--s-4) var(--s-6);
    }
    
    /* ==================== √âCRAN TEST ==================== */
    .progress-header {
      background: var(--blanc-surface);
      border-radius: var(--radius-xl);
      padding: var(--s-6);
      margin-bottom: var(--s-8);
      box-shadow: var(--shadow-soft);
    }
    
    .progress-info {
      display: flex;
      justify-content: space-between;
      margin-bottom: var(--s-3);
      font-size: var(--fs-sm);
      font-weight: 600;
    }
    
    .progress-bar-container {
      width: 100%;
      height: 8px;
      background: var(--creme-principal);
      border-radius: var(--radius-pill);
      overflow: hidden;
    }
    
    .progress-bar-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--or-signature), var(--or-riche));
      border-radius: var(--radius-pill);
      transition: width var(--duration-slow) var(--ease-spring);
      width: 0%;
    }
    
    /* Question Container */
    .question-container {
      background: var(--blanc-surface);
      border-radius: var(--radius-2xl);
      padding: var(--s-12);
      box-shadow: var(--shadow-large);
      margin-bottom: var(--s-8);
    }
    
    .question-number {
      font-size: var(--fs-sm);
      font-weight: 600;
      color: rgba(10,10,10,0.5);
      margin-bottom: var(--s-2);
    }
    
    .dimension-badge {
      display: inline-block;
      padding: var(--s-2) var(--s-4);
      background: var(--distorsion-bg);
      color: var(--distorsion-color);
      border-radius: var(--radius-pill);
      font-size: var(--fs-xs);
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: var(--s-4);
    }
    
    .dimension-badge.destabilisation { background: var(--destabilisation-bg); color: var(--destabilisation-color); }
    .dimension-badge.isolement { background: var(--isolement-bg); color: var(--isolement-color); }
    .dimension-badge.renversement { background: var(--renversement-bg); color: var(--renversement-color); }
    .dimension-badge.impact { background: var(--impact-bg); color: var(--impact-color); }
    
    .question-text {
      font-size: var(--fs-xl);
      line-height: var(--lh-normal);
      margin-bottom: var(--s-8);
      color: var(--noir-absolu);
    }
    
    /* √âchelle de R√©ponses */
    .answer-options {
      display: grid;
      gap: var(--s-3);
    }
    
    .answer-option {
      padding: var(--s-4);
      background: var(--creme-chaud);
      border: 2px solid transparent;
      border-radius: var(--radius-lg);
      cursor: pointer;
      transition: all var(--duration-normal) var(--ease-standard);
    }
    
    .answer-option:hover {
      border-color: var(--or-leger);
      background: var(--blanc-surface);
    }
    
    .answer-option.selected {
      border-color: var(--or-signature);
      background: var(--or-subtil);
    }
    
    .answer-main {
      font-size: var(--fs-md);
      font-weight: 600;
      margin-bottom: var(--s-2);
    }
    
    .answer-sublabel {
      font-size: var(--fs-sm);
      color: rgba(10,10,10,0.6);
    }
    
    /* Navigation Footer */
    .nav-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: var(--s-4);
    }
    
    #next-btn {
      display: none; /* PROGRESSION AUTOMATIQUE */
    }
    
    /* ==================== √âCRAN R√âSULTATS ==================== */
    .results-header {
      text-align: center;
      margin-bottom: var(--s-12);
    }
    
    .results-icon-container {
      width: 80px;
      height: 80px;
      margin: 0 auto var(--s-4);
      background: linear-gradient(135deg, var(--or-subtil), var(--or-leger));
      border: 2px solid var(--or-signature);
      border-radius: var(--radius-xl);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .results-icon {
      width: 40px;
      height: 40px;
      stroke: var(--or-signature);
      fill: none;
    }
    
    .results-title {
      font-size: var(--fs-3xl);
      margin-bottom: var(--s-3);
    }
    
    .results-date {
      font-size: var(--fs-sm);
      color: rgba(10,10,10,0.6);
    }
    
    /* Score Hero */
    .score-hero {
      background: linear-gradient(135deg, var(--blanc-surface), var(--creme-chaud));
      border: 2px solid var(--or-signature);
      border-radius: var(--radius-2xl);
      padding: var(--s-12);
      margin-bottom: var(--s-8);
      box-shadow: var(--shadow-large);
    }
    
    .score-container {
      text-align: center;
      margin-bottom: var(--s-6);
    }
    
    .score-display {
      font-family: 'Fraunces', serif;
      font-size: var(--fs-4xl);
      font-weight: 700;
      color: var(--or-signature);
      margin-bottom: var(--s-2);
    }
    
    .score-max {
      font-size: var(--fs-xl);
      color: rgba(10,10,10,0.3);
    }
    
    .score-label {
      font-size: var(--fs-sm);
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: rgba(10,10,10,0.6);
    }
    
    .level-badge-container {
      text-align: center;
    }
    
    .level-badge {
      display: inline-block;
      padding: var(--s-3) var(--s-8);
      border-radius: var(--radius-pill);
      font-size: var(--fs-md);
      font-weight: 600;
      margin-bottom: var(--s-4);
    }
    
    .level-badge.bas {
      background: rgba(5,150,105,0.15);
      color: #059669;
    }
    
    .level-badge.modere {
      background: rgba(245,158,11,0.15);
      color: #f59e0b;
    }
    
    .level-badge.eleve {
      background: rgba(234,88,12,0.15);
      color: #ea580c;
    }
    
    .level-badge.tres-eleve {
      background: rgba(220,38,38,0.15);
      color: #dc2626;
    }
    
    .score-message {
      font-size: var(--fs-md);
      line-height: var(--lh-relaxed);
      color: rgba(10,10,10,0.8);
    }
    
    /* Red Flags Alert */
    .red-flags-alert {
      background: #FEF2F2;
      border: 2px solid #dc2626;
      border-radius: var(--radius-xl);
      padding: var(--s-8);
      margin-bottom: var(--s-8);
    }
    
    .red-flags-alert h3 {
      color: #991b1b;
      font-size: var(--fs-xl);
      margin-bottom: var(--s-4);
      display: flex;
      align-items: center;
      gap: var(--s-3);
    }
    
    .red-flags-alert p {
      font-size: var(--fs-md);
      line-height: var(--lh-relaxed);
      color: rgba(10,10,10,0.8);
      margin-bottom: var(--s-3);
    }
    
    .red-flags-list {
      list-style: none;
      margin-bottom: var(--s-4);
    }
    
    .red-flags-list li {
      padding: var(--s-3);
      background: white;
      border-left: 3px solid #dc2626;
      border-radius: var(--radius-md);
      margin-bottom: var(--s-2);
      font-size: var(--fs-sm);
      font-weight: 600;
    }
    
    /* Profil Grid */
    .profile-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: var(--s-4);
      margin-bottom: var(--s-6);
    }
    
    .profile-item {
      background: var(--creme-chaud);
      padding: var(--s-4);
      border-radius: var(--radius-md);
    }
    
    .profile-label {
      font-size: var(--fs-xs);
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: rgba(10,10,10,0.6);
      margin-bottom: var(--s-2);
    }
    
    .profile-value {
      font-size: var(--fs-md);
      font-weight: 600;
      color: var(--noir-absolu);
    }
    
    /* Dimension Analysis */
    .dimension-analysis {
      display: grid;
      gap: var(--s-6);
    }
    
    .dimension-card {
      background: var(--creme-chaud);
      border-radius: var(--radius-lg);
      padding: var(--s-6);
      border-left: 4px solid var(--distorsion-color);
    }
    
    .dimension-card.destabilisation { border-left-color: var(--destabilisation-color); }
    .dimension-card.isolement { border-left-color: var(--isolement-color); }
    .dimension-card.renversement { border-left-color: var(--renversement-color); }
    .dimension-card.impact { border-left-color: var(--impact-color); }
    
    .dimension-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--s-4);
    }
    
    .dimension-name {
      font-size: var(--fs-lg);
      font-weight: 600;
    }
    
    .dimension-score-display {
      font-size: var(--fs-xl);
      font-weight: 700;
      color: var(--or-signature);
    }
    
    .dimension-bar-container {
      width: 100%;
      height: 12px;
      background: white;
      border-radius: var(--radius-pill);
      overflow: hidden;
      margin-bottom: var(--s-4);
    }
    
    .dimension-bar-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--or-signature), var(--or-riche));
      border-radius: var(--radius-pill);
      transition: width var(--duration-slow) var(--ease-spring);
    }
    
    .dimension-interpretation {
      font-size: var(--fs-sm);
      line-height: var(--lh-relaxed);
      color: rgba(10,10,10,0.75);
    }
    
    /* Recommendations */
    .recommendations-section {
      margin-top: var(--s-8);
    }
    
    .recommendations-section h2 {
      font-size: var(--fs-2xl);
      margin-bottom: var(--s-6);
    }
    
    .recommendation-list {
      display: grid;
      gap: var(--s-4);
    }
    
    .recommendation-item {
      background: var(--blanc-surface);
      border-left: 3px solid var(--or-signature);
      border-radius: var(--radius-md);
      padding: var(--s-4);
      box-shadow: var(--shadow-soft);
    }
    
    .recommendation-item p {
      font-size: var(--fs-sm);
      line-height: var(--lh-relaxed);
      color: rgba(10,10,10,0.8);
      margin: 0;
    }
    
    /* Export Actions */
    .export-actions {
      display: flex;
      flex-wrap: wrap;
      gap: var(--s-3);
      justify-content: center;
      margin-top: var(--s-8);
      margin-bottom: var(--s-8);
    }
    
    /* Disclaimer Box */
    .disclaimer-box {
      background: #f3f4f6;
      border: 1.5px solid var(--border-leger);
      border-radius: var(--radius-lg);
      padding: var(--s-6);
      margin-top: var(--s-8);
    }
    
    .disclaimer-box h4 {
      font-size: var(--fs-lg);
      margin-bottom: var(--s-4);
    }
    
    .disclaimer-box p {
      font-size: var(--fs-sm);
      line-height: var(--lh-relaxed);
      color: rgba(10,10,10,0.75);
      margin-bottom: var(--s-3);
    }
    
    .disclaimer-box p:last-child {
      margin-bottom: 0;
    }
    
    /* ==================== RESPONSIVE ==================== */
    @media (max-width: 1024px) {
      .intro-title, .results-title { font-size: var(--fs-2xl); }
      .card { padding: var(--s-8); }
      .question-text { font-size: var(--fs-lg); }
    }
    
    @media (max-width: 768px) {
      .app-container { padding: var(--s-6) var(--s-4); }
      .intro-title, .results-title { font-size: var(--fs-xl); }
      .question-text { font-size: var(--fs-lg); }
      .nav-footer { flex-direction: column; }
      .nav-footer .btn { width: 100%; }
      .methodology-grid { grid-template-columns: 1fr; }
      .export-actions { flex-direction: column; }
      .export-actions .btn { width: 100%; }
    }
    
    @media (max-width: 480px) {
      .intro-title, .results-title { font-size: var(--fs-lg); }
      .question-text { font-size: var(--fs-md); }
      .dimension-badge { font-size: 10px; }
      .score-display { font-size: var(--fs-3xl); }
    }
    
    /* ==================== PRINT STYLES ==================== */
    @media print {
      body { background: white; }
      .app-container { padding: 0; }
      .btn, .export-actions, .nav-footer { display: none !important; }
      .card, .question-container { box-shadow: none; page-break-inside: avoid; }
    }
  </style>
</head>
<body>

  <!-- ==================== √âCRAN 1 : INTRODUCTION ==================== -->
  <div id="intro-screen" class="screen active">
    <div class="app-container">
      
      <!-- Header avec ic√¥ne -->
      <div class="intro-header">
        <div class="icon-container">
          <svg class="icon-svg" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-width="2">
            <path d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
          </svg>
        </div>
        <h1 class="intro-title">Gaslighting Personnel</h1>
        <p class="intro-subtitle">D√©tection des dynamiques d'emprise & manipulation ‚Äî Outil de protection</p>
      </div>
      
      <!-- Warning Box CRITIQUE -->
      <div class="warning-box">
        <h3>
          <svg class="warning-icon" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-width="2">
            <path d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
          </svg>
          Avertissement S√©curitaire Important
        </h3>
        <p><strong>Si vous vous sentez en danger imm√©diat</strong>, arr√™tez cet outil et contactez les urgences : <strong>17 (Police)</strong> ou <strong>112 (Urgences europ√©ennes)</strong>.</p>
        <p>Cet outil vise √† <strong>aider √† rep√©rer des dynamiques de gaslighting</strong> (doute manufactur√©, renversement de r√©alit√©, culpabilisation syst√©matique) dans les relations personnelles. Il ne constitue <strong>ni un diagnostic clinique, ni une preuve juridique</strong>.</p>
        <p>Les r√©sultats refl√®tent votre perception actuelle et doivent √™tre interpr√©t√©s avec prudence. En cas de scores √©lev√©s ou de d√©tresse significative, nous recommandons vivement de <strong>consulter un professionnel qualifi√©</strong> (psychologue, th√©rapeute sp√©cialis√© en trauma relationnel) et de contacter des associations sp√©cialis√©es.</p>
        <div class="emergency-contact">
          <strong>‚ö†Ô∏è RESSOURCES D'URGENCE FRANCE</strong><br>
          ‚Ä¢ <strong>3919</strong> ‚Äî Violences Femmes Info (anonyme, gratuit)<br>
          ‚Ä¢ <strong>17</strong> ‚Äî Police Secours<br>
          ‚Ä¢ <strong>114</strong> ‚Äî Urgences par SMS (personnes sourdes/malentendantes)<br>
          ‚Ä¢ <strong>119</strong> ‚Äî Enfance en danger
        </div>
      </div>
      
      <!-- Objectif -->
      <div class="card">
        <h2>
          <svg class="card-icon" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-width="2">
            <path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
          </svg>
          Objectif de l'Outil
        </h2>
        <p>Cet autotest √©value les manifestations comportementales du <strong>gaslighting</strong> ‚Äî une forme insidieuse de manipulation psychologique visant √† faire douter la victime de sa perception de la r√©alit√©, de ses souvenirs et de son jugement.</p>
        <p>Fond√© sur la litt√©rature scientifique et l'exp√©rience clinique, cet instrument analyse cinq dimensions interconnect√©es pour √©tablir un profil pr√©cis des dynamiques relationnelles toxiques, identifier les zones de vuln√©rabilit√© et proposer un <strong>plan de protection adapt√©</strong>.</p>
        <p><strong>Confidentialit√© absolue</strong> : aucune donn√©e n'est collect√©e sans votre action explicite. Toutes les informations restent sur votre appareil. Vous contr√¥lez enti√®rement vos exports (PDF, JSON, email).</p>
      </div>
      
      <!-- Dimensions √©valu√©es -->
      <div class="card">
        <h2>
          <svg class="card-icon" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-width="2">
            <path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
          </svg>
          Dimensions √âvalu√©es
        </h2>
        <div class="dimensions-list">
          <div class="dimension-item distorsion">
            <h3>D1 ‚Äî Distorsion de la R√©alit√©</h3>
            <p>Mensonges syst√©matiques, d√©ni de faits v√©rifiables, r√©√©criture d'√©v√©nements, manipulation des souvenirs communs</p>
          </div>
          <div class="dimension-item destabilisation">
            <h3>D2 ‚Äî D√©stabilisation √âmotionnelle</h3>
            <p>Culpabilisation chronique, ridiculisation, humiliations voil√©es, retrait d'affection, punitions silencieuses</p>
          </div>
          <div class="dimension-item isolement">
            <h3>D3 ‚Äî Isolement & Contr√¥le</h3>
            <p>Discr√©ditation des proches, surveillance intrusive, chantage affectif, triangulation, r√®gles unilat√©rales</p>
          </div>
          <div class="dimension-item renversement">
            <h3>D4 ‚Äî Renversement & Paternalisme</h3>
            <p>Projection des fautes, pathologisation sauvage, "c'est pour ton bien", inversion victime-agresseur</p>
          </div>
          <div class="dimension-item impact">
            <h3>D5 ‚Äî Impact Fonctionnel & Somatique</h3>
            <p>Troubles du sommeil, anxi√©t√© chronique, ruminations obsessionnelles, erreurs professionnelles, somatisation</p>
          </div>
        </div>
      </div>
      
      <!-- M√©thodologie -->
      <div class="card">
        <h2>
          <svg class="card-icon" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-width="2">
            <path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"/>
          </svg>
          M√©thodologie
        </h2>
        <div class="methodology-grid">
          <div class="methodology-item">
            <svg class="methodology-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"/>
            </svg>
            <div class="methodology-label">40 Questions</div>
            <div class="methodology-description">√âvaluation comportementale rigoureuse</div>
          </div>
          <div class="methodology-item">
            <svg class="methodology-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <path d="M12 6v6l4 2"/>
            </svg>
            <div class="methodology-label">10 Minutes</div>
            <div class="methodology-description">Temps estim√© de passation</div>
          </div>
          <div class="methodology-item">
            <svg class="methodology-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
              <path d="M7 11V7a5 5 0 0110 0v4"/>
            </svg>
            <div class="methodology-label">Confidentiel</div>
            <div class="methodology-description">Anonymat garanti, stockage local</div>
          </div>
          <div class="methodology-item">
            <svg class="methodology-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
            </svg>
            <div class="methodology-label">Plan S√©curit√©</div>
            <div class="methodology-description">Ressources & recommandations</div>
          </div>
        </div>
      </div>
      
      <!-- Formulaire Anamn√®se -->
      <div class="card">
        <h2>Informations Contextuelles</h2>
        
        <div class="form-group">
          <label for="user-name">Initiales ou Pseudonyme (optionnel)</label>
          <input type="text" id="user-name" placeholder="Ex : M.D.">
        </div>
        
        <div class="form-group">
          <label for="user-age">√Çge</label>
          <input type="number" id="user-age" min="13" max="99" placeholder="Ex : 32">
        </div>
        
        <div class="form-group">
          <label for="user-relation">Type de relation concern√©e</label>
          <select id="user-relation">
            <option value="">-- S√©lectionner --</option>
            <option value="couple">Couple / Partenaire intime</option>
            <option value="famille">Famille (parent, fratrie...)</option>
            <option value="amitie">Amiti√© proche</option>
            <option value="ex">Ex-partenaire (contact maintenu)</option>
            <option value="autre">Autre relation personnelle</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="user-duration">Dur√©e de la relation</label>
          <select id="user-duration">
            <option value="">-- S√©lectionner --</option>
            <option value="recente">Moins de 6 mois</option>
            <option value="courte">6 mois √† 2 ans</option>
            <option value="moyenne">2 √† 5 ans</option>
            <option value="longue">5 √† 10 ans</option>
            <option value="tres-longue">Plus de 10 ans</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="user-cohabitation">Situation de cohabitation</label>
          <select id="user-cohabitation">
            <option value="">-- S√©lectionner --</option>
            <option value="oui">Oui, nous vivons ensemble</option>
            <option value="non">Non, domiciles s√©par√©s</option>
            <option value="partiel">Partiel (garde altern√©e, visites...)</option>
            <option value="passee">Cohabitation pass√©e, maintenant s√©par√©s</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="user-dependance">D√©pendance √©conomique ou mat√©rielle</label>
          <select id="user-dependance">
            <option value="">-- S√©lectionner --</option>
            <option value="aucune">Aucune d√©pendance</option>
            <option value="legere">L√©g√®re (quelques aspects partag√©s)</option>
            <option value="moderee">Mod√©r√©e (budget partag√©, logement...)</option>
            <option value="forte">Forte (d√©pendance financi√®re importante)</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="user-children">Enfants ou personnes √† charge</label>
          <select id="user-children">
            <option value="">-- S√©lectionner --</option>
            <option value="non">Non</option>
            <option value="oui-communs">Oui, enfants communs</option>
            <option value="oui-autres">Oui, autres personnes √† charge</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="user-support">R√©seau de soutien disponible</label>
          <select id="user-support">
            <option value="">-- S√©lectionner --</option>
            <option value="fort">Fort (famille, amis proches accessibles)</option>
            <option value="moyen">Moyen (quelques personnes de confiance)</option>
            <option value="faible">Faible (r√©seau limit√©)</option>
            <option value="inexistant">Inexistant ou tr√®s isol√©¬∑e</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>
            <input type="checkbox" id="consent-check">
            <span>J'ai lu l'avertissement s√©curitaire et je comprends que cet outil ne constitue ni un diagnostic clinique ni une preuve juridique. Je consens √† poursuivre l'auto-√©valuation en toute connaissance de cause. En cas de danger imm√©diat, j'appellerai le 17 ou le 112.</span>
          </label>
        </div>
        
        <button class="btn btn-primary btn-large" id="start-btn" disabled onclick="startTest()">
          D√©marrer l'√âvaluation
        </button>
      </div>
      
    </div>
  </div>

  <!-- ==================== √âCRAN 2 : TEST ==================== -->
  <div id="test-screen" class="screen">
    <div class="app-container">
      
      <!-- Progress Bar -->
      <div class="progress-header">
        <div class="progress-info">
          <span id="question-number-display">Question 1 / 40</span>
          <span id="questions-remaining">40 questions restantes</span>
        </div>
        <div class="progress-bar-container">
          <div class="progress-bar-fill" id="progress-bar"></div>
        </div>
      </div>
      
      <!-- Question Container -->
      <div class="question-container">
        <div class="question-number" id="question-number">Question 1</div>
        <div class="dimension-badge" id="question-dimension-badge">Dimension</div>
        <h2 class="question-text" id="question-text"></h2>
        
        <div class="answer-options" id="answer-options">
          <!-- G√©n√©r√© dynamiquement -->
        </div>
      </div>
      
      <!-- Navigation Footer -->
      <div class="nav-footer">
        <button id="prev-btn" class="btn btn-secondary" onclick="prevQuestion()">
          ‚Üê Pr√©c√©dent
        </button>
        <button id="next-btn" class="btn btn-primary" onclick="nextQuestion()">
          Suivant ‚Üí
        </button>
      </div>
      
    </div>
  </div>

  <!-- ==================== √âCRAN 3 : R√âSULTATS ==================== -->
  <div id="results-screen" class="screen">
    <div class="app-container">
      
      <!-- Header R√©sultats -->
      <div class="results-header">
        <div class="results-icon-container">
          <svg class="results-icon" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-width="2">
            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
          </svg>
        </div>
        <h1 class="results-title">Gaslighting Personnel ‚Äî Analyse D√©taill√©e</h1>
        <p class="results-date" id="results-date"></p>
      </div>
      
      <!-- Red Flags Alert (conditionnel) -->
      <div id="red-flags-container"></div>
      
      <!-- Score Principal -->
      <div class="score-hero">
        <div class="score-container">
          <div class="score-display">
            <span id="total-score-display">0</span>
            <span class="score-max">/ 160</span>
          </div>
          <div class="score-label">Score Total</div>
        </div>
        
        <div class="level-badge-container">
          <div class="level-badge" id="global-level-badge"></div>
          <p class="score-message" id="score-message"></p>
        </div>
      </div>
      
      <!-- Profil & Contexte -->
      <div class="card">
        <h2>Profil & Contexte Relationnel</h2>
        <div class="profile-grid" id="profile-grid"></div>
      </div>
      
      <!-- Analyse par Dimension -->
      <div class="card">
        <h2>Analyse par Dimension</h2>
        <div class="dimension-analysis" id="dimension-analysis"></div>
      </div>
      
      <!-- ANALYSE APPROFONDIE DU PROFIL -->
      <div class="card" style="background: linear-gradient(135deg, #F7F5EF 0%, #F9F7F1 100%); border: 2px solid var(--or-signature);">
        <h2 style="display: flex; align-items: center; gap: var(--s-3);">
          <svg class="card-icon" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-width="2">
            <path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
          </svg>
          Analyse Approfondie du Profil
        </h2>
        <div id="profile-analysis-container"></div>
      </div>
      
      <!-- Recommandations & Plan de S√©curit√© -->
      <div class="recommendations-section">
        <h2>Recommandations & Plan de Protection</h2>
        <div class="recommendation-list" id="recommendation-list"></div>
      </div>
      
      <!-- Actions Export -->
      <div class="export-actions">
        <button class="btn btn-primary" onclick="generatePDF()">üìÑ T√©l√©charger PDF</button>
        <button class="btn btn-secondary" onclick="sendResultsByEmail()">‚úâÔ∏è Envoyer par Email</button>
        <button class="btn btn-secondary" onclick="downloadJSON()">üìä Exporter JSON</button>
        <button class="btn btn-secondary" onclick="resetTest()">üîÑ Recommencer</button>
      </div>
      
      <!-- Disclaimer Final -->
      <div class="disclaimer-box">
        <h4>Nature et Limites de l'Outil</h4>
        <p>Ce questionnaire constitue un <strong>outil d'information et d'orientation</strong>, non m√©dical et non juridique. Il vise √† vous aider √† <strong>nommer, valider et documenter votre r√©alit√©</strong> face √† des dynamiques relationnelles toxiques.</p>
        <p>Les r√©sultats refl√®tent votre <strong>perception subjective actuelle</strong> et ne constituent <strong>en aucun cas un diagnostic clinique ni une preuve juridique recevable</strong>. Seul un professionnel de sant√© mentale qualifi√© peut √©tablir un diagnostic apr√®s √©valuation approfondie.</p>
        <p>Si vos scores r√©v√®lent des manifestations significatives ou si vous ressentez une d√©tresse importante, nous vous recommandons <strong>vivement de consulter</strong> un psychologue sp√©cialis√© en trauma relationnel, un th√©rapeute form√© aux violences psychologiques, ou de contacter les associations sp√©cialis√©es ci-dessous.</p>
        <p class="emergency-contact" style="background: #dc2626; color: white; padding: var(--s-4); border-radius: var(--radius-md); margin-top: var(--s-4);">
          <strong>‚ö†Ô∏è RESSOURCES URGENCE FRANCE</strong><br>
          ‚Ä¢ <strong>3919</strong> ‚Äî Violences Femmes Info (anonyme, gratuit, 24h/24)<br>
          ‚Ä¢ <strong>17 / 112</strong> ‚Äî Police / Urgences<br>
          ‚Ä¢ <strong>114</strong> ‚Äî Urgences SMS (sourds/malentendants)<br>
          ‚Ä¢ <strong>119</strong> ‚Äî Enfance en danger<br>
          ‚Ä¢ CIDFF, Planning Familial (accompagnement local)<br>
          ‚Ä¢ <a href="https://arretonslesviolences.gouv.fr" style="color: white; text-decoration: underline;" target="_blank">arretonslesviolences.gouv.fr</a>
        </p>
      </div>
      
    </div>
  </div>

  <script>
    // ==================== STATE GLOBAL ====================
    const state = {
      currentScreen: 'intro',
      currentQuestionIndex: 0,
      answers: {},
      anamnesis: {
        name: '',
        age: null,
        relation: '',
        duration: '',
        cohabitation: '',
        dependance: '',
        children: '',
        support: ''
      }
    };

    // ==================== QUESTIONS (40 ITEMS - √âchelle 0-4) ====================
    const QUESTIONS = [
      // D1 ‚Äî Distorsion de la r√©alit√© (8 items)
      { id: 1, dim: "distorsion", text: "Au cours des 3 derniers mois, √† quelle fr√©quence a-t-on ni√© des faits dont vous disposez par √©crit (messages, emails, documents) ?" },
      { id: 2, dim: "distorsion", text: "Au cours des 3 derniers mois, √† quelle fr√©quence a-t-on chang√© de version d'un √©v√©nement apr√®s coup sans l'admettre ?" },
      { id: 3, dim: "distorsion", text: "Au cours des 3 derniers mois, √† quelle fr√©quence vous a-t-on reproch√© d'avoir 'mal interpr√©t√©' des phrases pourtant claires et explicites ?" },
      { id: 4, dim: "distorsion", text: "Au cours des 3 derniers mois, √† quelle fr√©quence des objets, discussions ou √©v√©nements ont-ils 'disparu' de la narration commune sans explication ?" },
      { id: 5, dim: "distorsion", text: "Au cours des 3 derniers mois, √† quelle fr√©quence a-t-on r√©√©crit l'ordre chronologique des √©v√©nements pour vous confondre ou vous d√©cr√©dibiliser ?" },
      { id: 6, dim: "distorsion", text: "Au cours des 3 derniers mois, √† quelle fr√©quence a-t-on ridiculis√© vos souvenirs devant des tiers (amis, famille) ?" },
      { id: 7, dim: "distorsion", text: "Au cours des 3 derniers mois, quand vous avez demand√© une preuve ou un √©claircissement factuel, √† quelle fr√©quence vous l'a-t-on fourni clairement ?", reverse: true },
      { id: 8, dim: "distorsion", text: "Au cours des 3 derniers mois, √† quelle fr√©quence a-t-on exig√© de vous une 'confiance aveugle' plut√¥t que des explications rationnelles ?" },
      
      // D2 ‚Äî D√©stabilisation √©motionnelle (8 items)
      { id: 9, dim: "destabilisation", text: "Au cours des 3 derniers mois, √† quelle fr√©quence a-t-on banalis√© vos blessures √©motionnelles par l'humour, le sarcasme ou le m√©pris ?" },
      { id: 10, dim: "destabilisation", text: "Au cours des 3 derniers mois, √† quelle fr√©quence a-t-on retir√© l'affection, la tendresse ou l'attention apr√®s une demande l√©gitime de votre part ?" },
      { id: 11, dim: "destabilisation", text: "Au cours des 3 derniers mois, √† quelle fr√©quence a-t-on retard√© ou √©vit√© expr√®s une discussion cruciale que vous aviez sollicit√©e ?" },
      { id: 12, dim: "destabilisation", text: "Au cours des 3 derniers mois, √† quelle fr√©quence a-t-on utilis√© le silence prolong√© comme punition ou moyen de pression ?" },
      { id: 13, dim: "destabilisation", text: "Au cours des 3 derniers mois, √† quelle fr√©quence vous a-t-on pr√™t√© des intentions malveillantes que vous n'aviez pas ?" },
      { id: 14, dim: "destabilisation", text: "Au cours des 3 derniers mois, √† quelle fr√©quence a-t-on d√©clench√© des disputes ou confrontations au moment pr√©cis o√π vous √©tiez vuln√©rable (fatigu√©¬∑e, stress√©¬∑e, malade) ?" },
      { id: 15, dim: "destabilisation", text: "Au cours des 3 derniers mois, apr√®s un conflit, √† quelle fr√©quence avez-vous re√ßu des excuses claires et authentiques sans justifications ou minimisations ?", reverse: true },
      { id: 16, dim: "destabilisation", text: "Au cours des 3 derniers mois, √† quelle fr√©quence avez-vous d√ª surveiller vos paroles ou comportements pour √©viter une r√©action col√©rique ou punitive ?" },
      
      // D3 ‚Äî Isolement & contr√¥le (8 items)
      { id: 17, dim: "isolement", text: "Au cours des 3 derniers mois, √† quelle fr√©quence a-t-on discr√©dit√© vos proches (amis, famille) en les qualifiant de 'mauvais pour vous' ou 'toxiques' ?" },
      { id: 18, dim: "isolement", text: "Au cours des 3 derniers mois, √† quelle fr√©quence a-t-on consult√© vos messages, emails ou t√©l√©phone sans votre consentement explicite ?" },
      { id: 19, dim: "isolement", text: "Au cours des 3 derniers mois, √† quelle fr√©quence a-t-on impos√© des r√®gles unilat√©rales concernant vos horaires, v√™tements, sorties ou d√©penses ?" },
      { id: 20, dim: "isolement", text: "Au cours des 3 derniers mois, √† quelle fr√©quence a-t-on r√©interpr√©t√© ou divulgu√© vos confidences pour vous faire taire ou vous contr√¥ler ?" },
      { id: 21, dim: "isolement", text: "Au cours des 3 derniers mois, √† quelle fr√©quence vous √™tes-vous senti¬∑e culpabilis√©¬∑e lorsque vous voyiez vos amis ou famille ?" },
      { id: 22, dim: "isolement", text: "Au cours des 3 derniers mois, √† quelle fr√©quence a-t-on 'mont√©' des personnes contre vous ou cr√©√© des conflits entre vous et d'autres (triangulation) ?" },
      { id: 23, dim: "isolement", text: "Au cours des 3 derniers mois, √† quelle fr√©quence a-t-on menac√© de r√©v√©ler des secrets vous concernant si vous envisagiez de partir ou de vous √©loigner ?" },
      { id: 24, dim: "isolement", text: "Au cours des 3 derniers mois, quand vous avez √©nonc√© des limites claires, √† quelle fr√©quence ont-elles √©t√© respect√©es sans n√©gociation ou chantage ?", reverse: true },
      
      // D4 ‚Äî Renversement & paternalisme (8 items)
      { id: 25, dim: "renversement", text: "Au cours des 3 derniers mois, √† quelle fr√©quence a-t-on expliqu√© vos r√©actions √©motionnelles par une suppos√©e 'folie', 'hyst√©rie' ou instabilit√© mentale ?" },
      { id: 26, dim: "renversement", text: "Au cours des 3 derniers mois, √† quelle fr√©quence a-t-on projet√© ses propres fautes ou comportements probl√©matiques sur vous ('c'est toi qui...' alors que c'est lui/elle) ?" },
      { id: 27, dim: "renversement", text: "Au cours des 3 derniers mois, √† quelle fr√©quence a-t-on parl√© en votre nom ou d√©cid√© pour vous en affirmant 'je sais mieux que toi ce qui est bon pour toi' ?" },
      { id: 28, dim: "renversement", text: "Au cours des 3 derniers mois, √† quelle fr√©quence a-t-on pathologis√© vos √©motions l√©gitimes (tristesse, col√®re, peur) sans base m√©dicale ?" },
      { id: 29, dim: "renversement", text: "Au cours des 3 derniers mois, √† quelle fr√©quence a-t-on pr√©tendu que vos amis ou th√©rapeute vous 'influencent n√©gativement' contre lui/elle ?" },
      { id: 30, dim: "renversement", text: "Au cours des 3 derniers mois, √† quelle fr√©quence a-t-on justifi√© des comportements blessants ou abusifs par 'c'est pour ton bien' ou 'je fais √ßa par amour' ?" },
      { id: 31, dim: "renversement", text: "Au cours des 3 derniers mois, √† quelle fr√©quence a-t-on reconnu ses torts de mani√®re authentique sans inverser les r√¥les ou se victimiser ?", reverse: true },
      { id: 32, dim: "renversement", text: "Au cours des 3 derniers mois, √† quelle fr√©quence a-t-on r√©clam√© de la gratitude ou des excuses apr√®s avoir commis un tort envers vous ?" },
      
      // D5 ‚Äî Impact fonctionnel & somatique (8 items)
      { id: 33, dim: "impact", text: "Au cours des 3 derniers mois, √† quelle fr√©quence avez-vous eu des trous de m√©moire, confusion ou difficult√© √† vous souvenir apr√®s vos disputes ?" },
      { id: 34, dim: "impact", text: "Au cours des 3 derniers mois, √† quelle fr√©quence votre sommeil a-t-il √©t√© perturb√© (insomnie, cauchemars, r√©veils anxieux) √† cause de cette relation ?" },
      { id: 35, dim: "impact", text: "Au cours des 3 derniers mois, √† quelle fr√©quence avez-vous fait des erreurs au travail ou dans vos √©tudes apr√®s vos √©changes avec cette personne ?" },
      { id: 36, dim: "impact", text: "Au cours des 3 derniers mois, √† quelle fr√©quence avez-vous rumin√© longtemps (heures, jours) pour 'comprendre' ce qui s'est r√©ellement pass√© ?" },
      { id: 37, dim: "impact", text: "Au cours des 3 derniers mois, √† quelle fr√©quence votre corps a-t-il r√©agi physiquement (maux de ventre, tachycardie, naus√©es, tension) avant ou pendant vos interactions ?" },
      { id: 38, dim: "impact", text: "Au cours des 3 derniers mois, √† quelle fr√©quence avez-vous r√©duit ou abandonn√© des activit√©s que vous aimiez √† cause de cette relation ?" },
      { id: 39, dim: "impact", text: "Au cours des 3 derniers mois, √† quelle fr√©quence vous √™tes-vous senti¬∑e globalement en s√©curit√© √©motionnelle et physique dans cette relation ?", reverse: true },
      { id: 40, dim: "impact", text: "Au cours des 3 derniers mois, √† quelle fr√©quence vous √™tes-vous auto-censur√©¬∑e (√©vit√© de partager vos pens√©es, √©motions, besoins) par peur des cons√©quences ?" }
    ];

    // ==================== √âCHELLE DE R√âPONSE (0-4) ====================
    const SCALE_OPTIONS = [
      { value: 0, label: "Jamais", sublabel: "Aucune occurrence" },
      { value: 1, label: "Rarement", sublabel: "Quelques fois isol√©es" },
      { value: 2, label: "Parfois", sublabel: "R√©guli√®rement, impact mod√©r√©" },
      { value: 3, label: "Souvent", sublabel: "Fr√©quemment, impact notable" },
      { value: 4, label: "Tr√®s souvent", sublabel: "Syst√©matiquement, impact majeur" }
    ];

    // ==================== DIMENSIONS ====================
    const DIMENSIONS = [
      {
        key: "distorsion",
        label: "Distorsion",
        fullLabel: "Distorsion de la R√©alit√©",
        description: "Mensonges, d√©ni, r√©√©criture d'√©v√©nements",
        color: "var(--distorsion-color)",
        bg: "var(--distorsion-bg)"
      },
      {
        key: "destabilisation",
        label: "D√©stabilisation",
        fullLabel: "D√©stabilisation √âmotionnelle",
        description: "Culpabilisation, ridiculisation, humiliations",
        color: "var(--destabilisation-color)",
        bg: "var(--destabilisation-bg)"
      },
      {
        key: "isolement",
        label: "Isolement",
        fullLabel: "Isolement & Contr√¥le",
        description: "Discr√©ditation, surveillance, chantage",
        color: "var(--isolement-color)",
        bg: "var(--isolement-bg)"
      },
      {
        key: "renversement",
        label: "Renversement",
        fullLabel: "Renversement & Paternalisme",
        description: "Projection, pathologisation, inversion",
        color: "var(--renversement-color)",
        bg: "var(--renversement-bg)"
      },
      {
        key: "impact",
        label: "Impact",
        fullLabel: "Impact Fonctionnel & Somatique",
        description: "Troubles sommeil, anxi√©t√©, somatisation",
        color: "var(--impact-color)",
        bg: "var(--impact-bg)"
      }
    ];

    // ==================== BANDES DE R√âSULTATS ====================
    const RESULT_BANDS = [
      {
        min: 0, max: 23,
        level: "Suspicion Faible",
        severity: "bas",
        interpretation: "Les indicateurs de gaslighting sont absents ou n√©gligeables. Si vous ressentez n√©anmoins un malaise relationnel, √©coutez votre intuition et consultez si besoin.",
        color: "#059669",
        recommendations: [
          "Continuer √† faire confiance √† votre perception de la r√©alit√© et √† votre jugement",
          "Maintenir des liens sociaux solides avec votre entourage (famille, amis)",
          "Pratiquer l'affirmation de soi : exprimer vos besoins et limites clairement",
          "Tenir un journal personnel si vous ressentez un doute ponctuel sur vos perceptions"
        ]
      },
      {
        min: 24, max: 47,
        level: "Suspicion Mod√©r√©e",
        severity: "modere",
        interpretation: "Pr√©sence de comportements manipulatoires ponctuels ou mod√©r√©s. Cette situation n√©cessite vigilance et documentation des faits. Des ajustements relationnels et l'√©tablissement de limites claires sont recommand√©s.",
        color: "#f59e0b",
        recommendations: [
          "Commencer un journal de faits dat√© et d√©taill√© (qui a dit quoi, quand, o√π, t√©moins pr√©sents)",
          "Identifier vos 2-3 limites non-n√©gociables et les communiquer fermement",
          "Privil√©gier les √©changes √©crits (messages, emails) pour garder trace des interactions",
          "Maintenir des contacts r√©guliers avec au moins 2 personnes de confiance ext√©rieures",
          "Pratiquer la technique du 'disque ray√©' : r√©p√©ter calmement votre demande sans vous justifier",
          "Consulter un psychologue pour un soutien pr√©ventif et validation de vos perceptions",
          "Lire sur le gaslighting et les manipulations relationnelles pour mieux identifier les patterns"
        ]
      },
      {
        min: 48, max: 79,
        level: "Suspicion √âlev√©e",
        severity: "eleve",
        interpretation: "Manifestations significatives de gaslighting avec impact fonctionnel notable. Cette dynamique relationnelle toxique n√©cessite une intervention structur√©e et un accompagnement professionnel. La documentation syst√©matique et la construction d'un plan de protection sont prioritaires.",
        color: "#ea580c",
        recommendations: [
          "Consulter EN PRIORIT√â un psychologue sp√©cialis√© en trauma relationnel ou violences psychologiques",
          "Documenter syst√©matiquement : journal d√©taill√© + captures d'√©cran messages + enregistrements (si l√©gal dans votre pays)",
          "Constituer un 'dossier de r√©alit√©' : preuves √©crites, t√©moignages, chronologie factuelle",
          "Identifier 2-3 alli√©s t√©moins fiables inform√©s de la situation (amis, famille, coll√®gue)",
          "Pratiquer la technique 'Grey Rock' : r√©ponses neutres, √©motionnellement d√©tach√©es, minimalistes",
          "√âtablir des filtres de contact : limiter horaires/lieux/sujets de discussion, privil√©gier l'√©crit",
          "Pr√©parer discr√®tement les bases d'un plan de sortie : documents importants accessibles, fond d'urgence si possible",
          "Rejoindre un groupe de soutien pour victimes de manipulations psychologiques",
          "Consulter un avocat pour conna√Ætre vos droits (garde enfants, divorce, harc√®lement)",
          "Mettre en place des rituels de protection cognitive : m√©ditation, ancrage corporel, sommeil prioritaire"
        ]
      },
      {
        min: 80, max: 160,
        level: "Risque Tr√®s √âlev√© d'Emprise",
        severity: "tres-eleve",
        interpretation: "Niveau critique r√©v√©lant une emprise psychologique s√©v√®re par gaslighting. Cette situation constitue une urgence relationnelle n√©cessitant une protection imm√©diate et un accompagnement sp√©cialis√© intensif. La s√©curit√© physique et psychologique doit √™tre la priorit√© absolue.",
        color: "#dc2626",
        recommendations: [
          "PRIORIT√â ABSOLUE : Contacter le 3919 (Violences Femmes Info) ou association sp√©cialis√©e pour √©valuation s√©curitaire",
          "Consulter IMM√âDIATEMENT un psychologue/psychiatre sp√©cialis√© en trauma complexe et violences conjugales",
          "Activer un plan de sortie s√©curis√© (si cohabitation) : point de chute identifi√©, code mot avec proches, documents essentiels s√©curis√©s",
          "Constituer un dossier de preuves exhaustif avec aide juridique : chronologie d√©taill√©e, captures √©cran, t√©moignages √©crits",
          "Ne PAS confronter la personne manipulatrice avec vos soup√ßons ou ce rapport (risque d'escalade)",
          "Organiser une 'escorte de sortie' : ami proche ou professionnel pr√©sent lors d√©part d√©finitif si cohabitation",
          "Consulter un avocat sp√©cialis√© violences conjugales : ordonnance de protection, proc√©dures d'urgence, garde enfants",
          "Pr√©parer un 'sac de d√©part' discret : papiers identit√©, moyens paiement, cl√©s, m√©dicaments, v√™tements",
          "Mettre en place une th√©rapie trauma sp√©cialis√©e (EMDR, TCC trauma, somatic experiencing)",
          "Informer votre employeur/m√©decin traitant si impact professionnel/sant√© document√©",
          "Rejoindre programme d'accompagnement intensif post-violence psychologique",
          "Planifier suivi psychiatrique si sympt√¥mes dissociatifs, d√©pressifs ou anxieux s√©v√®res",
          "NE JAMAIS sous-estimer la dangerosit√© : gaslighting s√©v√®re peut pr√©c√©der escalade vers violence physique"
        ]
      }
    ];

    // ==================== PROFILS NARRATIFS ====================
    const PROFILES = {
      brouillard: {
        name: "Brouillard Constant",
        criteria: (dims) => dims.distorsion >= 16 && dims.destabilisation >= 16 && dims.impact >= 16,
        description: "Votre profil r√©v√®le une confusion chronique entretenue par une distorsion syst√©matique de la r√©alit√© coupl√©e √† une d√©stabilisation √©motionnelle intense. Cette combinaison cr√©e un 'brouillard cognitif' permanent vous emp√™chant de faire confiance √† vos perceptions et souvenirs. L'impact somatique √©lev√© (troubles du sommeil, anxi√©t√©, ruminations) t√©moigne d'une alt√©ration profonde de votre bien-√™tre. Ce pattern est caract√©ristique d'un gaslighting classique et n√©cessite une intervention prioritaire pour restaurer votre ancrage dans la r√©alit√©."
      },
      montagnes: {
        name: "Montagnes Russes",
        criteria: (dims) => dims.destabilisation >= 24,
        description: "Votre profil se caract√©rise par une d√©stabilisation √©motionnelle extr√™me cr√©ant des cycles r√©p√©titifs d'id√©alisation et de d√©valorisation. Ces montagnes russes affectives maintiennent un √©tat d'hypervigilance √©puisant et emp√™chent toute pr√©visibilit√© relationnelle. L'alternance entre moments de tendresse et √©pisodes de rejet/punition cr√©e une d√©pendance psychologique appel√©e 'trauma bonding' ou 'syndrome de Stockholm relationnel'. Cette dynamique n√©cessite un accompagnement th√©rapeutique sp√©cialis√© pour identifier les cycles et construire une sortie s√©curis√©e."
      },
      siege: {
        name: "Si√®ge Social",
        criteria: (dims) => dims.isolement >= 24,
        description: "Votre profil r√©v√®le un contr√¥le relationnel et un isolement strat√©gique particuli√®rement marqu√©s. La personne manipulatrice a syst√©matiquement min√© vos liens sociaux, surveille vos communications et impose des r√®gles unilat√©rales vous privant progressivement d'autonomie. Cette tactique vise √† vous rendre d√©pendant¬∑e et vuln√©rable en supprimant vos ressources externes de validation et soutien. Le score √©lev√© en isolement/contr√¥le constitue un drapeau rouge majeur n√©cessitant une action imm√©diate : reconstitution d'un r√©seau de soutien, consultation juridique si menaces ou chantage, et plan de sortie s√©curis√©."
      },
      renversement: {
        name: "Renversement Clinique",
        criteria: (dims) => dims.renversement >= 24,
        description: "Votre profil se caract√©rise par une inversion victime-agresseur syst√©matique et une pathologisation abusive de vos r√©actions l√©gitimes. La personne manipulatrice projette constamment ses propres comportements probl√©matiques sur vous, vous accusant pr√©cis√©ment de ce qu'elle fait elle-m√™me. Elle utilise un discours pseudo-th√©rapeutique ('tu es fou/folle', 'tu as besoin d'aide', 'c'est pour ton bien') pour disqualifier vos √©motions et maintenir le contr√¥le. Cette strat√©gie g√©n√®re une culpabilit√© toxique et une perte de confiance en votre jugement. Un accompagnement psychologique sp√©cialis√© est essentiel pour d√©construire ces distorsions et restaurer votre l√©gitimit√© √©motionnelle."
      },
      erosion: {
        name: "√ârosion Silencieuse",
        criteria: (dims) => dims.impact >= 20 && Math.max(dims.distorsion, dims.destabilisation, dims.isolement, dims.renversement) < 24,
        description: "Votre profil r√©v√®le un impact fonctionnel et somatique √©lev√© sans dimension unique dominante. Cette '√©rosion silencieuse' est caract√©ristique d'un gaslighting insidieux, progressif, difficile √† identifier car jamais spectaculaire. Les manifestations (troubles du sommeil, ruminations, erreurs professionnelles, somatisation) t√©moignent d'une atteinte profonde malgr√© l'absence de conflits ouverts apparents. Ce pattern est particuli√®rement pernicieux car la victime doute longtemps de la l√©gitimit√© de sa souffrance. La reconnaissance de cette dynamique toxique constitue le premier pas vers la protection."
      }
    };

    // ==================== FONCTIONS NAVIGATION ====================
    function startTest() {
      state.anamnesis.name = document.getElementById('user-name').value.trim() || 'Anonyme';
      state.anamnesis.age = parseInt(document.getElementById('user-age').value) || null;
      state.anamnesis.relation = document.getElementById('user-relation').value;
      state.anamnesis.duration = document.getElementById('user-duration').value;
      state.anamnesis.cohabitation = document.getElementById('user-cohabitation').value;
      state.anamnesis.dependance = document.getElementById('user-dependance').value;
      state.anamnesis.children = document.getElementById('user-children').value;
      state.anamnesis.support = document.getElementById('user-support').value;
      
      state.currentQuestionIndex = 0;
      state.answers = {};
      showScreen('test');
      renderQuestion();
    }

    function nextQuestion() {
      if (state.currentQuestionIndex < QUESTIONS.length - 1) {
        state.currentQuestionIndex++;
        renderQuestion();
      } else {
        showResults();
      }
    }

    function prevQuestion() {
      if (state.currentQuestionIndex > 0) {
        state.currentQuestionIndex--;
        renderQuestion();
      }
    }

    function selectAnswer(value) {
      const currentQuestion = QUESTIONS[state.currentQuestionIndex];
      state.answers[currentQuestion.id] = value;
      renderQuestion();
      
      setTimeout(() => {
        nextQuestion();
      }, 400);
    }

    function showScreen(screenName) {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById(screenName + '-screen').classList.add('active');
      state.currentScreen = screenName;
      window.scrollTo(0, 0);
    }

    function renderQuestion() {
      const question = QUESTIONS[state.currentQuestionIndex];
      const dimension = DIMENSIONS.find(d => d.key === question.dim);
      
      const progress = ((state.currentQuestionIndex + 1) / QUESTIONS.length) * 100;
      document.getElementById('progress-bar').style.width = progress + '%';
      document.getElementById('question-number-display').textContent = `Question ${state.currentQuestionIndex + 1} / ${QUESTIONS.length}`;
      document.getElementById('questions-remaining').textContent = `${QUESTIONS.length - state.currentQuestionIndex - 1} questions restantes`;
      
      document.getElementById('question-number').textContent = `Question ${state.currentQuestionIndex + 1}`;
      document.getElementById('question-dimension-badge').textContent = dimension.label;
      document.getElementById('question-dimension-badge').className = 'dimension-badge ' + question.dim;
      document.getElementById('question-text').textContent = question.text;
      
      const optionsContainer = document.getElementById('answer-options');
      optionsContainer.innerHTML = SCALE_OPTIONS.map(option => {
        const isSelected = state.answers[question.id] === option.value;
        return `
          <div class="answer-option ${isSelected ? 'selected' : ''}" onclick="selectAnswer(${option.value})">
            <div class="answer-main">${option.label}</div>
            <div class="answer-sublabel">${option.sublabel}</div>
          </div>
        `;
      }).join('');
      
      document.getElementById('prev-btn').disabled = state.currentQuestionIndex === 0;
    }

    function showResults() {
      showScreen('results');
      renderResults();
    }

    function resetTest() {
      if (confirm("√ätes-vous s√ªr¬∑e de vouloir recommencer ? Toutes vos r√©ponses seront perdues.")) {
        location.reload();
      }
    }

    // ==================== FONCTIONS SCORING ====================
    function calculateScores() {
      const dimensions = {};
      let total = 0;
      
      DIMENSIONS.forEach(dim => {
        const questionsForDim = QUESTIONS.filter(q => q.dim === dim.key);
        const score = questionsForDim.reduce((sum, q) => {
          const answer = state.answers[q.id] || 0;
          return sum + (q.reverse ? (4 - answer) : answer);
        }, 0);
        const maxScore = questionsForDim.length * 4;
        const percentage = Math.round((score / maxScore) * 100);
        
        dimensions[dim.key] = { score, maxScore, percentage };
        total += score;
      });
      
      const maxTotal = QUESTIONS.length * 4;
      
      // Drapeaux rouges
      const redFlags = [];
      if (total >= 80) redFlags.push("Score total ‚â•80 : Risque tr√®s √©lev√© d'emprise");
      if (dimensions.isolement.score >= 24) redFlags.push("Isolement & Contr√¥le ‚â•24 : Danger imm√©diat");
      const item23 = state.answers[23] || 0;
      if (item23 > 0) redFlags.push("Chantage / Menaces d√©tect√© (Item 23)");
      if (dimensions.impact.score >= 26) redFlags.push("Impact fonctionnel s√©v√®re : Sant√© compromise");
      
      return { dimensions, total, maxTotal, redFlags };
    }

    function getResultBand(totalScore, maxTotal) {
      const percentage = (totalScore / maxTotal) * 100;
      return RESULT_BANDS.find(band => percentage >= band.min && percentage <= band.max);
    }

    function identifyProfile(dimensions) {
      const dims = {
        distorsion: dimensions.distorsion.score,
        destabilisation: dimensions.destabilisation.score,
        isolement: dimensions.isolement.score,
        renversement: dimensions.renversement.score,
        impact: dimensions.impact.score
      };
      
      // Tester profils dans ordre de priorit√©
      if (PROFILES.siege.criteria(dims)) return PROFILES.siege;
      if (PROFILES.montagnes.criteria(dims)) return PROFILES.montagnes;
      if (PROFILES.brouillard.criteria(dims)) return PROFILES.brouillard;
      if (PROFILES.renversement.criteria(dims)) return PROFILES.renversement;
      if (PROFILES.erosion.criteria(dims)) return PROFILES.erosion;
      
      return null;
    }

    function generateProfileAnalysis(scores) {
      const analysis = {
        dominantDimensions: [],
        profilePattern: '',
        specificInsights: [],
        functionalImpact: '',
        contextualFactors: '',
        protectionStrategies: ''
      };
      
      const dimArray = Object.entries(scores.dimensions)
        .map(([key, data]) => ({
          key,
          ...data,
          label: DIMENSIONS.find(d => d.key === key).fullLabel
        }))
        .sort((a, b) => b.percentage - a.percentage);
      
      analysis.dominantDimensions = dimArray.filter(d => d.percentage >= 60);
      
      const profile = identifyProfile(scores.dimensions);
      if (profile) {
        analysis.profilePattern = profile.name;
        analysis.specificInsights.push(profile.description);
      } else {
        analysis.profilePattern = "Profil Mixte";
        analysis.specificInsights.push("Votre profil pr√©sente une distribution vari√©e des manifestations de gaslighting sans pattern unique pr√©dominant. Cette diversit√© sugg√®re une manipulation multiforme adapt√©e aux contextes ou une chronicit√© ayant √©volu√© √† travers plusieurs phases.");
      }
      
      // Impact fonctionnel contextualis√©
      const relationLabels = {
        'couple': 'partenaire intime',
        'famille': 'membre de votre famille',
        'amitie': 'proche ami¬∑e',
        'ex': 'ex-partenaire',
        'autre': 'personne de votre entourage'
      };
      const relationContext = relationLabels[state.anamnesis.relation] || 'cette personne';
      
      if (scores.dimensions.impact.score >= 20) {
        analysis.functionalImpact = `L'impact fonctionnel et somatique significatif que vous subissez t√©moigne d'une alt√©ration profonde de votre bien-√™tre global. Les troubles du sommeil, ruminations obsessionnelles, erreurs professionnelles et r√©actions corporelles (anxi√©t√©, somatisation) r√©v√®lent que cette relation avec ${relationContext} affecte gravement votre sant√© mentale et physique. Cette d√©t√©rioration n'est PAS de votre responsabilit√© : elle est la cons√©quence directe d'une manipulation psychologique chronique visant √† saper votre stabilit√© √©motionnelle et cognitive.`;
      }
      
      // Facteurs contextuels aggravants
      const aggravatingFactors = [];
      if (state.anamnesis.cohabitation === 'oui') aggravatingFactors.push("cohabitation active");
      if (state.anamnesis.dependance === 'forte' || state.anamnesis.dependance === 'moderee') aggravatingFactors.push("d√©pendance √©conomique");
      if (state.anamnesis.children === 'oui-communs') aggravatingFactors.push("enfants communs");
      if (state.anamnesis.support === 'faible' || state.anamnesis.support === 'inexistant') aggravatingFactors.push("isolement social");
      
      if (aggravatingFactors.length > 0) {
        analysis.contextualFactors = `Votre situation pr√©sente des facteurs contextuels aggravants : ${aggravatingFactors.join(', ')}. Ces √©l√©ments complexifient significativement la sortie de cette relation toxique et n√©cessitent une planification s√©curitaire rigoureuse avec accompagnement professionnel sp√©cialis√© (psychologue + avocat + association). Ne sous-estimez pas ces contraintes structurelles : elles sont r√©elles et m√©ritent une strat√©gie adapt√©e.`;
      }
      
      // Strat√©gies protection prioritaires
      if (scores.redFlags.length > 0) {
        analysis.protectionStrategies = "Compte tenu des drapeaux rouges identifi√©s, la priorit√© absolue est la mise en s√©curit√© : contactez le 3919 ou une association sp√©cialis√©e pour √©valuation professionnelle, constituez discr√®tement un dossier de preuves (journal d√©taill√©, captures √©cran), identifiez un point de chute s√©curis√© si besoin, et ne confrontez JAMAIS la personne manipulatrice avec ce rapport (risque d'escalade). Votre s√©curit√© physique et psychologique prime sur toute autre consid√©ration.";
      }
      
      // Insights sp√©cifiques dimensions critiques
      if (scores.dimensions.distorsion.score >= 24) {
        analysis.specificInsights.push("Votre score tr√®s √©lev√© en Distorsion de la R√©alit√© r√©v√®le une manipulation syst√©matique de vos perceptions et souvenirs. Cette tactique vise √† vous faire douter de votre sant√© mentale et vous rendre d√©pendant¬∑e du manipulateur comme unique 'source de v√©rit√©'. Il est CRUCIAL de documenter factuellement tous les √©v√©nements (journal dat√©, captures √©cran) pour reconstruire un ancrage dans la r√©alit√© objective.");
      }
      
      if (scores.dimensions.isolement.score >= 24) {
        analysis.specificInsights.push("‚ö†Ô∏è ALERTE : Votre score critique en Isolement & Contr√¥le indique une emprise avanc√©e avec strat√©gies d'isolement social et surveillance intrusive. Cette dimension est statistiquement corr√©l√©e √† un risque accru de violence physique. Contactez IMM√âDIATEMENT le 3919 ou une association sp√©cialis√©e. Ne minimisez pas cette situation.");
      }
      
      return analysis;
    }

    function getDimensionInterpretation(dimKey, score, maxScore) {
      const percentage = (score / maxScore) * 100;
      
      if (dimKey === 'distorsion') {
        if (score < 8) return "Absence ou tr√®s faible pr√©sence de distorsion de la r√©alit√©. Vos perceptions et souvenirs sont globalement respect√©s dans cette relation.";
        if (score < 16) return "Pr√©sence mod√©r√©e de distorsion de la r√©alit√©. Certains faits sont ni√©s ou r√©interpr√©t√©s ponctuellement, n√©cessitant vigilance et documentation.";
        if (score < 24) return "Distorsion de la r√©alit√© √©lev√©e. Manipulation syst√©matique de vos souvenirs et perceptions, cr√©ant confusion et doute chronique. Documentation factuelle urgente n√©cessaire.";
        return "Distorsion de la r√©alit√© tr√®s √©lev√©e. Gaslighting caract√©ris√© visant √† saper votre sant√© mentale. Situation critique n√©cessitant protection imm√©diate et accompagnement sp√©cialis√©.";
      }
      
      if (dimKey === 'destabilisation') {
        if (score < 8) return "Absence de d√©stabilisation √©motionnelle significative. Vos √©motions sont globalement respect√©es et valid√©es.";
        if (score < 16) return "D√©stabilisation √©motionnelle mod√©r√©e. Culpabilisation ou humiliations ponctuelles cr√©ant ins√©curit√© relationnelle.";
        if (score < 24) return "D√©stabilisation √©motionnelle √©lev√©e. Cycles r√©p√©titifs d'id√©alisation/d√©valorisation cr√©ant d√©pendance affective (trauma bonding).";
        return "D√©stabilisation √©motionnelle tr√®s √©lev√©e. Violence psychologique s√©v√®re par humiliations, punitions silencieuses et rejet syst√©matique. Accompagnement th√©rapeutique urgent.";
      }
      
      if (dimKey === 'isolement') {
        if (score < 8) return "Absence de strat√©gies d'isolement ou contr√¥le. Votre autonomie relationnelle et sociale est pr√©serv√©e.";
        if (score < 16) return "Isolement et contr√¥le mod√©r√©s. Certaines relations ou libert√©s sont questionn√©es, n√©cessitant r√©affirmation de vos limites.";
        if (score < 24) return "Isolement et contr√¥le √©lev√©s. Strat√©gies syst√©matiques pour vous couper de vos soutiens et limiter votre autonomie. Reconstitution r√©seau social urgente.";
        return "‚ö†Ô∏è DANGER : Isolement et contr√¥le tr√®s √©lev√©s. Emprise caract√©ris√©e avec menaces, chantage ou surveillance invasive. Contactez le 3919 IMM√âDIATEMENT. Ne restez pas seul¬∑e.";
      }
      
      if (dimKey === 'renversement') {
        if (score < 8) return "Absence de renversement ou projection. Responsabilit√©s reconnues de part et d'autre sans pathologisation abusive.";
        if (score < 16) return "Renversement et paternalisme mod√©r√©s. Projection ponctuelle ou justifications 'pour ton bien' n√©cessitant recadrage ferme.";
        if (score < 24) return "Renversement et paternalisme √©lev√©s. Inversion victime-agresseur syst√©matique et pathologisation de vos √©motions l√©gitimes. Th√©rapie sp√©cialis√©e recommand√©e.";
        return "Renversement et paternalisme tr√®s √©lev√©s. Manipulation psychologique sophistiqu√©e visant √† vous faire douter de votre sant√© mentale. D√©construction cognitive urgente avec th√©rapeute sp√©cialis√© trauma.";
      }
      
      if (dimKey === 'impact') {
        if (score < 8) return "Impact fonctionnel minimal. Votre sommeil, sant√© et fonctionnement professionnel sont pr√©serv√©s.";
        if (score < 16) return "Impact fonctionnel mod√©r√©. Premiers signes d'alt√©ration (sommeil, ruminations) n√©cessitant strat√©gies protection cognitive.";
        if (score < 24) return "Impact fonctionnel √©lev√©. D√©t√©rioration significative sant√© mentale et physique (insomnie, anxi√©t√©, erreurs professionnelles). Consultation m√©dicale recommand√©e.";
        return "Impact fonctionnel tr√®s √©lev√©. Alt√©ration s√©v√®re de votre sant√© globale et fonctionnement quotidien. Suivi m√©dical et psychologique URGENT. Arr√™t de travail si n√©cessaire.";
      }
      
      return "";
    }

    // ==================== RENDU R√âSULTATS ====================
    function renderResults() {
      const scores = calculateScores();
      const resultBand = getResultBand(scores.total, scores.maxTotal);
      const profileAnalysis = generateProfileAnalysis(scores);
      
      document.getElementById('results-date').textContent = 'G√©n√©r√© le ' + new Date().toLocaleDateString('fr-FR', {
        weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'
      });
      
      // Red Flags Alert
      const redFlagsContainer = document.getElementById('red-flags-container');
      if (scores.redFlags.length > 0) {
        redFlagsContainer.innerHTML = `
          <div class="red-flags-alert">
            <h3>
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
              </svg>
              DRAPEAUX ROUGES D√âTECT√âS
            </h3>
            <p><strong>Votre √©valuation r√©v√®le des indicateurs de danger n√©cessitant une action imm√©diate :</strong></p>
            <ul class="red-flags-list">
              ${scores.redFlags.map(flag => `<li>‚ö†Ô∏è ${flag}</li>`).join('')}
            </ul>
            <p style="margin-top: var(--s-4); font-weight: 600;">
              Ne minimisez pas ces signaux. Contactez d√®s maintenant le <strong style="font-size: var(--fs-lg);">3919</strong> (Violences Femmes Info) 
              ou une association sp√©cialis√©e pour √©valuation professionnelle et mise en s√©curit√©.
            </p>
          </div>
        `;
      } else {
        redFlagsContainer.innerHTML = '';
      }
      
      // Hero Score
      document.getElementById('total-score-display').textContent = scores.total;
      document.getElementById('global-level-badge').textContent = resultBand.level;
      document.getElementById('global-level-badge').className = 'level-badge ' + resultBand.severity;
      document.getElementById('score-message').textContent = resultBand.interpretation;
      
      // Profil
      const relationLabels = {
        'couple': 'Couple / Partenaire intime',
        'famille': 'Famille',
        'amitie': 'Amiti√© proche',
        'ex': 'Ex-partenaire',
        'autre': 'Autre relation'
      };
      
      const durationLabels = {
        'recente': 'Moins de 6 mois',
        'courte': '6 mois √† 2 ans',
        'moyenne': '2 √† 5 ans',
        'longue': '5 √† 10 ans',
        'tres-longue': 'Plus de 10 ans'
      };
      
      const profileGrid = document.getElementById('profile-grid');
      profileGrid.innerHTML = `
        <div class="profile-item">
          <div class="profile-label">√Çge</div>
          <div class="profile-value">${state.anamnesis.age || 'Non pr√©cis√©'}</div>
        </div>
        <div class="profile-item">
          <div class="profile-label">Type Relation</div>
          <div class="profile-value">${relationLabels[state.anamnesis.relation] || 'Non pr√©cis√©'}</div>
        </div>
        <div class="profile-item">
          <div class="profile-label">Dur√©e Relation</div>
          <div class="profile-value">${durationLabels[state.anamnesis.duration] || 'Non pr√©cis√©'}</div>
        </div>
        <div class="profile-item">
          <div class="profile-label">Cohabitation</div>
          <div class="profile-value">${state.anamnesis.cohabitation === 'oui' ? 'Oui' : state.anamnesis.cohabitation === 'non' ? 'Non' : state.anamnesis.cohabitation === 'partiel' ? 'Partielle' : 'Pass√©e'}</div>
        </div>
        <div class="profile-item">
          <div class="profile-label">D√©pendance √âco.</div>
          <div class="profile-value">${state.anamnesis.dependance || 'Non pr√©cis√©'}</div>
        </div>
        <div class="profile-item">
          <div class="profile-label">R√©seau Soutien</div>
          <div class="profile-value">${state.anamnesis.support || 'Non pr√©cis√©'}</div>
        </div>
      `;
      
      // Analyse Dimensionnelle
      const dimensionAnalysis = document.getElementById('dimension-analysis');
      dimensionAnalysis.innerHTML = Object.entries(scores.dimensions).map(([key, data]) => {
        const dim = DIMENSIONS.find(d => d.key === key);
        const interpretation = getDimensionInterpretation(key, data.score, data.maxScore);
        
        return `
          <div class="dimension-card ${key}">
            <div class="dimension-header">
              <span class="dimension-name">${dim.fullLabel}</span>
              <span class="dimension-score-display">${data.percentage}%</span>
            </div>
            <div class="dimension-bar-container">
              <div class="dimension-bar-fill" style="width: ${data.percentage}%"></div>
            </div>
            <p class="dimension-interpretation">${interpretation}</p>
          </div>
        `;
      }).join('');
      
      // Analyse Approfondie
      const analysisContainer = document.getElementById('profile-analysis-container');
      analysisContainer.innerHTML = `
        <div style="background: white; border: 2px solid var(--or-signature); 
                    border-radius: var(--radius-xl); padding: var(--s-6); margin-bottom: var(--s-6);">
          <h3 style="font-size: var(--fs-lg); color: var(--or-signature); margin-bottom: var(--s-3);">
            ${profileAnalysis.profilePattern}
          </h3>
        </div>
        
        ${profileAnalysis.specificInsights.length > 0 ? `
          <div style="margin-bottom: var(--s-6);">
            <h4 style="font-size: var(--fs-md); font-weight: 600; margin-bottom: var(--s-4);">
              Observations Cliniques
            </h4>
            ${profileAnalysis.specificInsights.map(insight => `
              <div style="margin-bottom: var(--s-4); padding: var(--s-4); 
                          background: white; border-left: 3px solid var(--or-signature); 
                          border-radius: var(--radius-md);">
                <p style="font-size: var(--fs-sm); line-height: var(--lh-relaxed); 
                          margin: 0; text-align: justify;">
                  ${insight}
                </p>
              </div>
            `).join('')}
          </div>
        ` : ''}
        
        ${profileAnalysis.functionalImpact ? `
          <div style="margin-bottom: var(--s-6);">
            <h4 style="font-size: var(--fs-md); font-weight: 600; margin-bottom: var(--s-3);">
              Impact Fonctionnel
            </h4>
            <p style="font-size: var(--fs-sm); line-height: var(--lh-relaxed); 
                      text-align: justify; padding: var(--s-4); 
                      background: white; border-radius: var(--radius-md);">
              ${profileAnalysis.functionalImpact}
            </p>
          </div>
        ` : ''}
        
        ${profileAnalysis.contextualFactors ? `
          <div style="margin-bottom: var(--s-6);">
            <h4 style="font-size: var(--fs-md); font-weight: 600; margin-bottom: var(--s-3);">
              Facteurs Contextuels Aggravants
            </h4>
            <p style="font-size: var(--fs-sm); line-height: var(--lh-relaxed); 
                      text-align: justify; padding: var(--s-4); 
                      background: white; border-radius: var(--radius-md);">
              ${profileAnalysis.contextualFactors}
            </p>
          </div>
        ` : ''}
        
        ${profileAnalysis.protectionStrategies ? `
          <div style="margin-bottom: var(--s-6);">
            <h4 style="font-size: var(--fs-md); font-weight: 600; margin-bottom: var(--s-3);">
              Strat√©gies de Protection Prioritaires
            </h4>
            <p style="font-size: var(--fs-sm); line-height: var(--lh-relaxed); 
                      text-align: justify; padding: var(--s-4); 
                      background: #FEF2F2; border: 2px solid #dc2626; border-radius: var(--radius-md);">
              ${profileAnalysis.protectionStrategies}
            </p>
          </div>
        ` : ''}
        
        ${profileAnalysis.dominantDimensions.length > 0 ? `
          <div style="background: #FFFBEB; border: 2px solid #F59E0B; 
                      border-radius: var(--radius-lg); padding: var(--s-4);">
            <p style="font-size: var(--fs-sm); font-weight: 600; 
                      color: #92400E; margin-bottom: var(--s-2);">
              üìä Dimensions Critiques (‚â•60%)
            </p>
            <p style="font-size: var(--fs-sm); color: #78350F; margin: 0;">
              ${profileAnalysis.dominantDimensions.map(d => 
                `<strong>${d.label}</strong> (${d.percentage}%)`
              ).join(' ‚Ä¢ ')}
            </p>
          </div>
        ` : ''}
      `;
      
      // Recommandations
      const recommendationList = document.getElementById('recommendation-list');
      recommendationList.innerHTML = resultBand.recommendations.map(rec => `
        <div class="recommendation-item">
          <p>${rec}</p>
        </div>
      `).join('');
    }

    // ==================== EXPORT PDF ====================
    async function generatePDF() {
      alert("Fonction Export PDF en cours d'impl√©mentation. Le PDF sera disponible sous peu avec architecture compl√®te incluant drapeaux rouges, profil narratif et plan de s√©curit√©.");
    }

    // ==================== EXPORT JSON ====================
    function downloadJSON() {
      const scores = calculateScores();
      const resultBand = getResultBand(scores.total, scores.maxTotal);
      
      const data = {
        metadata: {
          test: "Gaslighting Personnel",
          version: "1.0 - NO√âSIS",
          theoreticalFramework: "D√©tection comportementale gaslighting (Robin Stern, Stephanie Sarkis, recherche empirique)",
          date: new Date().toISOString(),
          participant: state.anamnesis.name || 'Anonyme',
          warning: "Outil non clinique, non juridique - Consultation professionnelle recommand√©e si scores √©lev√©s"
        },
        anamnesis: state.anamnesis,
        responses: {
          answers: state.answers,
          completion: `${Object.keys(state.answers).length}/${QUESTIONS.length}`
        },
        scoring: {
          total: scores.total,
          maxTotal: scores.maxTotal,
          percentage: Math.round((scores.total/scores.maxTotal)*100),
          dimensions: scores.dimensions,
          redFlags: scores.redFlags,
          resultBand: {
            level: resultBand.level,
            severity: resultBand.severity,
            interpretation: resultBand.interpretation
          }
        },
        detailedResponses: QUESTIONS.map(q => ({
          id: q.id,
          dimension: q.dim,
          text: q.text,
          reverse: q.reverse || false,
          response: {
            value: state.answers[q.id],
            label: SCALE_OPTIONS.find(opt => opt.value === state.answers[q.id])?.label,
            sublabel: SCALE_OPTIONS.find(opt => opt.value === state.answers[q.id])?.sublabel
          }
        }))
      };
      
      const blob = new Blob([JSON.stringify(data, null, 2)], { 
        type: 'application/json;charset=utf-8' 
      });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `noesis-gaslighting-personnel-${Date.now()}.json`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    // ==================== ENVOI EMAIL ====================
    function sendResultsByEmail() {
      const scores = calculateScores();
      const resultBand = getResultBand(scores.total, scores.maxTotal);
      
      const emailBody = `
Rapport NO√âSIS ‚Äî Gaslighting Personnel
Participant : ${state.anamnesis.name || 'Anonyme'}
G√©n√©r√© le ${new Date().toLocaleDateString('fr-FR')}

‚ö†Ô∏è AVERTISSEMENT : Outil non clinique, non juridique. Consultation professionnelle recommand√©e.

SCORE TOTAL : ${scores.total}/${scores.maxTotal} (${Math.round((scores.total/scores.maxTotal)*100)}%)
NIVEAU : ${resultBand.level}

${scores.redFlags.length > 0 ? `
‚ö†Ô∏è DRAPEAUX ROUGES D√âTECT√âS :
${scores.redFlags.map(flag => `‚Ä¢ ${flag}`).join('\n')}

CONTACTEZ IMM√âDIATEMENT : 3919 (Violences Femmes Info)
` : ''}

ANALYSE DIMENSIONNELLE :
${Object.entries(scores.dimensions).map(([key, data]) => {
  const dim = DIMENSIONS.find(d => d.key === key);
  return `‚Ä¢ ${dim.fullLabel} : ${data.percentage}%`;
}).join('\n')}

PROFIL RELATIONNEL :
‚Ä¢ Type relation : ${state.anamnesis.relation || 'Non pr√©cis√©'}
‚Ä¢ Dur√©e : ${state.anamnesis.duration || 'Non pr√©cis√©'}
‚Ä¢ Cohabitation : ${state.anamnesis.cohabitation || 'Non pr√©cis√©'}

RESSOURCES URGENCE FRANCE :
‚Ä¢ 3919 ‚Äî Violences Femmes Info (anonyme, gratuit)
‚Ä¢ 17 / 112 ‚Äî Police / Urgences
‚Ä¢ 114 ‚Äî Urgences SMS
‚Ä¢ 119 ‚Äî Enfance en danger

Pour rapport complet avec analyses approfondies et plan de protection, 
t√©l√©chargez la version PDF depuis l'interface NO√âSIS.

---
NO√âSIS ‚Äî Intelligence transdisciplinaire
¬© ${new Date().getFullYear()} ‚Äî Tous droits r√©serv√©s
Outil de protection et orientation ‚Äî Non clinique, non juridique
      `.trim();
      
      const subject = `[CONFIDENTIEL] Rapport Gaslighting ‚Äî ${state.anamnesis.name || 'Anonyme'} ‚Äî NO√âSIS`;
      const mailtoLink = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(emailBody)}`;
      
      window.location.href = mailtoLink;
    }

    // ==================== INITIALISATION ====================
    document.addEventListener('DOMContentLoaded', function() {
      const consentCheck = document.getElementById('consent-check');
      const startBtn = document.getElementById('start-btn');
      
      consentCheck.addEventListener('change', function() {
        startBtn.disabled = !this.checked;
      });
    });
  </script>

</body>
</html>