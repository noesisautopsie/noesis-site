<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- SEO -->
  <title>Gaslighting Professionnel — Grille d'Évaluation Clinique NOÉSIS</title>
  <meta name="description" content="Grille d'évaluation clinique du gaslighting professionnel basée sur la recherche en psychologie du travail, criminologie et neurosciences. 60 items validés.">
  
  <!-- Open Graph -->
  <meta property="og:title" content="Gaslighting Professionnel — NOÉSIS">
  <meta property="og:description" content="Grille d'évaluation clinique 60 items. Identification manipulation professionnelle.">
  <meta property="og:type" content="website">
  
  <!-- Tailwind CSS via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- React + ReactDOM via CDN -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  
  <!-- Babel Standalone pour JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  
  <style>
    /* Styles d'impression PDF optimisés A4 */
    @media print {
      .no-print { display: none !important; }
      .print-only { display: block !important; }
      
      body { 
        background: white !important;
        margin: 0;
        padding: 0;
      }
      
      @page {
        size: A4;
        margin: 12mm 15mm;
      }
      
      .print-container {
        max-width: 100%;
        padding: 0 !important;
        margin: 0 !important;
      }
      
      .print-section {
        padding: 8px 0 !important;
        margin-bottom: 12px !important;
      }
      
      .print-header {
        font-size: 18px !important;
        margin-bottom: 8px !important;
        padding-bottom: 4px !important;
        border-bottom: 2px solid #334155;
      }
      
      .print-subheader {
        font-size: 14px !important;
        margin: 8px 0 4px 0 !important;
      }
      
      .print-text {
        font-size: 11px !important;
        line-height: 1.4 !important;
        margin: 2px 0 !important;
      }
      
      .print-question {
        font-size: 11px !important;
        padding: 3px 0 !important;
        page-break-inside: avoid;
      }
      
      .print-axis-section {
        page-break-inside: avoid;
        margin-bottom: 10px !important;
      }
      
      .print-score-box {
        padding: 6px !important;
        margin: 4px 0 !important;
        border: 1px solid #e2e8f0;
        border-radius: 4px;
      }
      
      .print-reco {
        font-size: 11px !important;
        padding: 2px 0 2px 16px !important;
        margin: 2px 0 !important;
      }
    }
    
    .print-only {
      display: none;
    }
  </style>
</head>
<body class="m-0 p-0">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useMemo, useCallback } = React;

    // ============================================================
    // CONFIGURATION
    // ============================================================

    const AXES = [
      { 
        key: "alteration", 
        label: "Altération de la réalité", 
        color: "red",
        description: "Négation, réinterprétation des faits, distorsion mémorielle"
      },
      { 
        key: "destabilisation", 
        label: "Déstabilisation émotionnelle", 
        color: "amber",
        description: "Invalidation, culpabilisation, attaque identitaire"
      },
      { 
        key: "controle", 
        label: "Contrôle coercitif", 
        color: "purple",
        description: "Isolement, double contrainte, privation d'autonomie"
      },
      { 
        key: "neurostress", 
        label: "Impact neuropsychologique", 
        color: "indigo",
        description: "Hypervigilance, sidération, altérations cognitives"
      }
    ];

    const CHOICES = [
      { value: 0, label: "Jamais", anchor: "0 fois" },
      { value: 1, label: "Rarement", anchor: "1-2×/mois" },
      { value: 2, label: "Souvent", anchor: "1-2×/semaine" },
      { value: 3, label: "Très souvent", anchor: "Quotidien" }
    ];

    const QUESTIONS = [
      // ALTÉRATION RÉALITÉ (15 items)
      { id: "Q1", dim: "alteration", text: "On nie des faits ou décisions pourtant documentés par écrit." },
      { id: "Q2", dim: "alteration", text: "Mes réussites sont minimisées ou attribuées à d'autres personnes." },
      { id: "Q3", dim: "alteration", text: "On me reproche des erreurs issues d'instructions floues ou contradictoires." },
      { id: "Q4", dim: "alteration", text: "Le contexte d'événements est réécrit a posteriori pour m'imputer la faute." },
      { id: "Q5", dim: "alteration", text: "Des informations critiques disparaissent ou sont modifiées sans explication." },
      { id: "Q6", dim: "alteration", text: "Mes propos sont systématiquement sortis de leur contexte ou déformés." },
      { id: "Q7", dim: "alteration", text: "On me dit que « je me souviens mal » d'événements dont je suis certain·e." },
      { id: "Q8", dim: "alteration", text: "Des promesses ou engagements oraux sont niés ultérieurement." },
      { id: "Q9", dim: "alteration", text: "Les faits objectifs que je rapporte sont qualifiés d'« interprétations personnelles »." },
      { id: "Q10", dim: "alteration", text: "Je doute de plus en plus de ma propre mémoire professionnelle." },
      { id: "Q11", dim: "alteration", text: "Les règles ou attentes changent rétroactivement, me plaçant toujours en tort." },
      { id: "Q12", dim: "alteration", text: "On me fait passer pour confus·e ou incompétent·e devant des tiers." },
      { id: "Q13", dim: "alteration", text: "Des réunions ou décisions importantes ont lieu sans moi, puis on prétend m'avoir informé·e." },
      { id: "Q14", dim: "alteration", text: "Mes observations factuelles sont systématiquement contestées sans justification." },
      { id: "Q15", dim: "alteration", text: "Je me surprends à documenter obsessionnellement tout échange pour prouver ma version." },
      
      // DÉSTABILISATION ÉMOTIONNELLE (15 items)
      { id: "Q16", dim: "destabilisation", text: "Des remarques dénigrantes sont formulées sous couvert d'humour." },
      { id: "Q17", dim: "destabilisation", text: "On m'accuse d'être « trop sensible » lorsque j'exprime une préoccupation légitime." },
      { id: "Q18", dim: "destabilisation", text: "Je ressors émotionnellement vidé·e ou confus·e après certains échanges." },
      { id: "Q19", dim: "destabilisation", text: "Mes émotions sont systématiquement disqualifiées comme irrationnelles ou excessives." },
      { id: "Q20", dim: "destabilisation", text: "Je dois me justifier en permanence, même pour des choix professionnels standards." },
      { id: "Q21", dim: "destabilisation", text: "La responsabilité de conflits est systématiquement inversée pour me désigner coupable." },
      { id: "Q22", dim: "destabilisation", text: "Je marche sur des œufs en permanence pour éviter des réactions imprévisibles." },
      { id: "Q23", dim: "destabilisation", text: "Des humiliations subtiles se produisent en présence de collègues (soupirs, regards, moqueries)." },
      { id: "Q24", dim: "destabilisation", text: "On insinue que je devrais consulter un·e psychologue ou remettre en question ma santé mentale." },
      { id: "Q25", dim: "destabilisation", text: "Je minimise mes propres émotions pour éviter d'être critiqué·e davantage." },
      { id: "Q26", dim: "destabilisation", text: "On exploite mes vulnérabilités personnelles (santé, situation familiale) pour me fragiliser." },
      { id: "Q27", dim: "destabilisation", text: "Je me sens coupable même lorsque je n'ai objectivement rien fait de répréhensible." },
      { id: "Q28", dim: "destabilisation", text: "Mes compétences professionnelles sont remises en cause de manière récurrente." },
      { id: "Q29", dim: "destabilisation", text: "Je n'ose plus exprimer mon désaccord ou ma perception par peur de représailles." },
      { id: "Q30", dim: "destabilisation", text: "On me compare défavorablement à d'autres collègues de manière humiliante." },
      
      // CONTRÔLE COERCITIF (15 items)
      { id: "Q31", dim: "controle", text: "Les priorités changent brutalement sans explication, puis on me reproche le retard." },
      { id: "Q32", dim: "controle", text: "Je suis isolé·e progressivement d'informations ou de réunions décisives." },
      { id: "Q33", dim: "controle", text: "J'ai peur de m'exprimer librement ou de formuler un refus justifié." },
      { id: "Q34", dim: "controle", text: "Des décisions me concernant sont prises à mon insu puis présentées comme validées." },
      { id: "Q35", dim: "controle", text: "Des confidences personnelles sont réutilisées ultérieurement contre moi de manière stratégique." },
      { id: "Q36", dim: "controle", text: "Je dois systématiquement réparer ou compenser des dysfonctionnements créés par d'autres." },
      { id: "Q37", dim: "controle", text: "On m'écarte progressivement des contacts professionnels clés (clients, direction, partenaires)." },
      { id: "Q38", dim: "controle", text: "Je suis évalué·e sur des critères non annoncés ou modifiés en cours de route." },
      { id: "Q39", dim: "controle", text: "Je dépends d'un seul décideur qui arbitre sans transparence ni cohérence." },
      { id: "Q40", dim: "controle", text: "Je vis des doubles contraintes permanentes : quoi que je fasse, c'est considéré inadéquat." },
      { id: "Q41", dim: "controle", text: "Mes demandes légitimes (ressources, délais, clarifications) sont systématiquement refusées ou ignorées." },
      { id: "Q42", dim: "controle", text: "On surveille étroitement mon travail tout en me reprochant un manque d'autonomie." },
      { id: "Q43", dim: "controle", text: "Mes contacts avec certains collègues ou services sont découragés ou empêchés." },
      { id: "Q44", dim: "controle", text: "Je dois rendre compte de détails insignifiants alors que d'autres ne subissent pas ce contrôle." },
      { id: "Q45", dim: "controle", text: "On me prive de moyens nécessaires (accès, outils, formation) puis on me reproche l'inefficacité." },
      
      // IMPACT NEUROPSYCHOLOGIQUE (15 items)
      { id: "Q46", dim: "neurostress", text: "Je vis en état d'hypervigilance constante, anticipant reproches ou attaques." },
      { id: "Q47", dim: "neurostress", text: "Mon sommeil est gravement perturbé (réveils nocturnes, ruminations, cauchemars)." },
      { id: "Q48", dim: "neurostress", text: "Ma mémoire de travail et ma concentration se dégradent au travail." },
      { id: "Q49", dim: "neurostress", text: "Je ressens des tensions physiques intenses (gorge serrée, ventre noué, tremblements)." },
      { id: "Q50", dim: "neurostress", text: "J'ai des pics émotionnels incontrôlables après certains mails ou appels." },
      { id: "Q51", dim: "neurostress", text: "J'anticipe et « édite » mentalement chaque mot avant de parler pour éviter des réactions." },
      { id: "Q52", dim: "neurostress", text: "Je perds mes repères temporels ou mémoriels après des conflits (flou, trous)." },
      { id: "Q53", dim: "neurostress", text: "Je ressens un soulagement physique marqué en télétravail ou en l'absence de la personne." },
      { id: "Q54", dim: "neurostress", text: "Je fais des cauchemars ou revit des scènes de dénigrement au travail." },
      { id: "Q55", dim: "neurostress", text: "Mon appétit, ma libido ou ma motivation générale chutent sans autre cause médicale." },
      { id: "Q56", dim: "neurostress", text: "J'ai des pensées intrusives récurrentes liées aux situations de travail." },
      { id: "Q57", dim: "neurostress", text: "Je me sens émotionnellement « éteint·e » ou dissocié·e pendant le travail." },
      { id: "Q58", dim: "neurostress", text: "J'évite certains lieux, personnes ou situations professionnelles par anxiété anticipatoire." },
      { id: "Q59", dim: "neurostress", text: "Je ressens des symptômes physiques inexpliqués (maux de tête, douleurs, nausées)." },
      { id: "Q60", dim: "neurostress", text: "Je me sens piégé·e sans issue possible, avec un sentiment d'impuissance chronique." }
    ];

    // ============================================================
    // FONCTIONS DE SCORING
    // ============================================================

    function scoreBands(total, perAxis) {
      if (total <= 35) {
        return {
          band: "Environnement professionnel sain",
          color: "green",
          severity: "none",
          message: "Les indicateurs de gaslighting professionnel sont absents ou très faibles. La situation ne présente pas de signaux d'alerte significatifs.",
          recommendations: [
            "Maintenir une vigilance ordinaire sur la qualité des relations professionnelles.",
            "Continuer à documenter les décisions importantes par écrit (bonne pratique standard).",
            "Cultiver un réseau professionnel diversifié."
          ],
          urgent: false
        };
      }
      
      if (total <= 75) {
        return {
          band: "Signaux d'alerte — Vigilance accrue",
          color: "yellow",
          severity: "low",
          message: "Plusieurs indicateurs de manipulation professionnelle sont présents. La situation mérite une attention soutenue et une documentation systématique. Le gaslighting n'est pas encore caractérisé mais les mécanismes précoces apparaissent.",
          recommendations: [
            "Documenter systématiquement : conserver tous les échanges écrits, prendre des notes datées après chaque réunion importante, sauvegarder les preuves.",
            "Élargir le cercle de confiance : partager vos préoccupations avec un·e collègue de confiance, un·e mentor, ou les RH si sécurisé.",
            "Consultation préventive : envisager un échange avec le médecin du travail pour traçabilité et conseil.",
            "Clarifier les attentes : demander par écrit des clarifications sur les priorités, critères d'évaluation, processus décisionnels."
          ],
          urgent: false
        };
      }
      
      if (total <= 120) {
        return {
          band: "Situation à risque élevé — Action nécessaire",
          color: "orange",
          severity: "moderate",
          message: "Les indicateurs convergent vers une situation de gaslighting professionnel caractérisé. L'exposition répétée à ces mécanismes génère des impacts neuropsychologiques mesurables. La situation nécessite une intervention structurée et un accompagnement professionnel.",
          recommendations: [
            "PRIORITÉ 1 — Médecin du travail : consultation urgente pour évaluation de l'impact santé, mise en place de mesures de protection (aménagement, arrêt si nécessaire), traçabilité médicale officielle.",
            "Psychologue du travail ou psychothérapeute : accompagnement spécialisé sur le trauma professionnel, reconstruction de la perception de réalité, stratégies de protection psychologique.",
            "Documentation renforcée : journal quotidien (date, faits, verbatims, témoins), sauvegarde cloud sécurisée, privilégier les échanges écrits traçables.",
            "Alerter les RH ou représentants du personnel : si interlocuteur de confiance disponible, exposer factuellement la situation avec documentation. Privilégier l'écrit pour traçabilité.",
            "Plan de sécurité professionnel : identifier issues de secours (mobilité interne, externe), sécuriser situation financière, préparer options de recours."
          ],
          urgent: true
        };
      }
      
      return {
        band: "Situation critique — Danger pour la santé",
        color: "red",
        severity: "critical",
        message: "Les indicateurs révèlent une situation de gaslighting professionnel sévère avec impact neuropsychologique majeur. L'exposition prolongée à ce niveau de violence psychologique constitue un danger avéré pour la santé mentale et physique. Une intervention immédiate pluridisciplinaire est impérative.",
        recommendations: [
          "URGENCE MÉDICALE : consultation médecin du travail ou médecin traitant dans les 48h. Évaluation psychiatrique si idées noires, dissociation sévère, ou détresse aiguë. Ne pas rester seul·e.",
          "Arrêt de travail : envisager sérieusement avec le médecin un arrêt pour protection et récupération cognitive. Le maintien en poste aggrave le trauma.",
          "Accompagnement psychothérapeutique spécialisé : psychotraumatologue ou psychologue clinicien formé aux violences professionnelles. Thérapies validées : EMDR, TCC trauma-focalisée.",
          "Protection juridique : consultation avocat spécialisé droit du travail pour évaluation des recours (harcèlement moral art. L1152-1, contrôle coercitif). Constitution dossier probatoire.",
          "Inspection du travail + DREETS : signalement si organisation délétère systémique. Demande d'enquête sur les conditions de travail.",
          "Soutien social renforcé : informer proches de confiance, groupe de parole victimes harcèlement moral, associations spécialisées (AVFT, Souffrance & Travail).",
          "Numéros d'urgence : 3114 (prévention suicide), 01 45 39 40 00 (Suicide Écoute), médecin traitant si détresse aiguë."
        ],
        urgent: true
      };
    }

    function getAxisAnalysis(dimScores) {
      const sorted = Object.entries(dimScores)
        .map(([key, score]) => ({ key, score, dim: AXES.find(d => d.key === key) }))
        .sort((a, b) => b.score - a.score);
      
      const dominant = sorted[0];
      
      const analyses = {
        alteration: "L'altération de la réalité est votre dimension dominante. Vous subissez probablement une distorsion systématique des faits, une négation de vos perceptions et une réinterprétation constante des événements. Cette manipulation cognitive vise à vous faire douter de votre propre mémoire et jugement.",
        destabilisation: "La déstabilisation émotionnelle domine votre profil. Vous êtes exposé·e à des attaques identitaires récurrentes, une invalidation systématique de vos émotions et une culpabilisation constante. Cette violence psychologique érode progressivement votre estime professionnelle et votre équilibre émotionnel.",
        controle: "Le contrôle coercitif est au cœur de votre situation. Vous subissez probablement un isolement progressif, des doubles contraintes permanentes et une privation d'autonomie décisionnelle. Cette emprise institutionnelle crée un sentiment d'impuissance et compromet votre capacité d'action.",
        neurostress: "L'impact neuropsychologique domine votre profil. Votre système nerveux montre des signes de stress post-traumatique avec hypervigilance, altérations cognitives et réponses physiologiques de danger. Cette dimension témoigne d'une exposition prolongée à une violence psychologique sévère."
      };
      
      return {
        dominant: dominant.key,
        analysis: analyses[dominant.key]
      };
    }

    // ============================================================
    // COMPOSANT PRINCIPAL
    // ============================================================

    function GaslightingTest() {
      const [page, setPage] = useState("intro");
      const [currentQ, setCurrentQ] = useState(0);
      const [answers, setAnswers] = useState({});
      const [email, setEmail] = useState("");

      // SUPPRESSION TOTALE localStorage — Test toujours vierge

      const allAnswered = Object.keys(answers).length === QUESTIONS.length;

      const handleAnswer = useCallback((qId, value) => {
        setAnswers(prev => ({ ...prev, [qId]: value }));
        
        if (currentQ < QUESTIONS.length - 1) {
          setTimeout(() => setCurrentQ(c => c + 1), 150);
        }
      }, [currentQ]);

      const goToResults = useCallback(() => {
        if (!allAnswered) {
          alert(`Il reste ${QUESTIONS.length - Object.keys(answers).length} question(s) sans réponse.`);
          return;
        }
        setPage("results");
      }, [allAnswered, answers]);

      const reset = useCallback(() => {
        setAnswers({});
        setCurrentQ(0);
        setPage("intro");
        setEmail("");
      }, []);

      const dimensionScores = useMemo(() => {
        const scores = {};
        AXES.forEach(axis => {
          const qs = QUESTIONS.filter(q => q.dim === axis.key);
          const total = qs.reduce((sum, q) => sum + (answers[q.id] || 0), 0);
          scores[axis.key] = total;
        });
        return scores;
      }, [answers]);

      const totalScore = useMemo(() => {
        return Object.values(dimensionScores).reduce((a, b) => a + b, 0);
      }, [dimensionScores]);

      const resultBand = useMemo(() => scoreBands(totalScore, dimensionScores), [totalScore, dimensionScores]);
      const profileAnalysis = useMemo(() => getAxisAnalysis(dimensionScores), [dimensionScores]);

      const handlePDF = useCallback(() => {
        window.print();
      }, []);

      const handleDownloadJSON = useCallback(() => {
        const data = {
          test: "Gaslighting Professionnel",
          date: new Date().toISOString(),
          totalScore,
          resultBand: resultBand.band,
          dimensionScores,
          answers: QUESTIONS.map(q => ({
            id: q.id,
            dimension: q.dim,
            question: q.text,
            answer: CHOICES.find(c => c.value === answers[q.id])?.label || "Non répondu"
          }))
        };
        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `noesis-gaslighting-${new Date().toISOString().split('T')[0]}.json`;
        a.click();
        URL.revokeObjectURL(url);
      }, [totalScore, resultBand, dimensionScores, answers]);

      const handleEmail = useCallback(() => {
        if (!email) return;
        const subject = encodeURIComponent("Résultats Auto-test Gaslighting");
        const body = encodeURIComponent(
          `Bonjour,\n\nVoici mes résultats au test Gaslighting Professionnel NOÉSIS :\n\n` +
          `Score total : ${totalScore}/180\n` +
          `Profil : ${resultBand.band}\n\n` +
          `Scores par dimension :\n` +
          AXES.map(d => `- ${d.label} : ${dimensionScores[d.key]}`).join('\n') +
          `\n\nPour consulter le détail complet, merci de télécharger le PDF ou JSON depuis le site.`
        );
        window.location.href = `mailto:${email}?subject=${subject}&body=${body}`;
      }, [email, totalScore, resultBand, dimensionScores]);

      const progress = useMemo(() => Math.round((currentQ / QUESTIONS.length) * 100), [currentQ]);

      // ============================================================
      // PAGE INTRO
      // ============================================================
      
      if (page === "intro") {
        return (
          <div className="min-h-screen bg-gradient-to-br from-slate-50 via-indigo-50 to-purple-50 p-4 md:p-8">
            <div className="max-w-3xl mx-auto">
              <div className="text-center mb-8">
                <div className="inline-block p-4 bg-indigo-100 rounded-2xl mb-4">
                  <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5" className="text-indigo-600">
                    <path d="M9.5 2c-1.82 0-3.53.5-5 1.36C2.68 4.72 1.5 6.73 1.5 9c0 1.56.52 3 1.39 4.14.87 1.14 2.07 2 3.43 2.36"/>
                    <path d="M14.5 2c1.82 0 3.53.5 5 1.36C21.32 4.72 22.5 6.73 22.5 9c0 1.56-.52 3-1.39 4.14-.87 1.14-2.07 2-3.43 2.36"/>
                    <path d="M12 2v20"/>
                    <path d="M9.5 15.5c0 1.38.62 2.5 1.5 2.5"/>
                    <path d="M14.5 15.5c0 1.38-.62 2.5-1.5 2.5"/>
                    <circle cx="9" cy="9" r="1" fill="currentColor"/>
                    <circle cx="15" cy="9" r="1" fill="currentColor"/>
                  </svg>
                </div>
                <h1 className="text-4xl md:text-5xl font-black text-slate-900 mb-3">
                  Gaslighting Professionnel
                </h1>
                <p className="text-lg text-slate-600 font-medium">
                  Grille d'évaluation clinique — 60 items validés
                </p>
              </div>

              <div className="bg-white rounded-2xl shadow-2xl p-6 md:p-8 mb-6">
                <div className="bg-red-50 border-l-4 border-red-500 p-4 mb-6 rounded-r-lg">
                  <div className="flex gap-3">
                    <span className="text-2xl flex-shrink-0">🚨</span>
                    <div className="text-sm text-red-900">
                      <p className="font-bold mb-1">Avertissement méthodologique</p>
                      <p className="leading-relaxed">
                        Cette grille d'évaluation clinique <strong>ne remplace pas un diagnostic professionnel</strong>. 
                        Elle vise à identifier des indicateurs de gaslighting professionnel basés sur la recherche en psychologie du travail, criminologie et neurosciences. 
                        En cas de scores élevés, une consultation médicale et un accompagnement spécialisé sont indispensables.
                      </p>
                    </div>
                  </div>
                </div>

                <div className="mb-8">
                  <div className="flex items-center gap-2 mb-4">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5" className="text-slate-700">
                      <circle cx="11" cy="11" r="8"/>
                      <path d="m21 21-4.35-4.35"/>
                      <circle cx="11" cy="11" r="3"/>
                    </svg>
                    <h2 className="text-xl font-bold text-slate-900">Méthodologie</h2>
                  </div>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-3 mb-6">
                    <div className="bg-red-50 text-red-700 px-3 py-2 rounded-lg text-center text-sm font-semibold">
                      Altération réalité
                    </div>
                    <div className="bg-amber-50 text-amber-700 px-3 py-2 rounded-lg text-center text-sm font-semibold">
                      Déstabilisation émotionnelle
                    </div>
                    <div className="bg-purple-50 text-purple-700 px-3 py-2 rounded-lg text-center text-sm font-semibold">
                      Contrôle coercitif
                    </div>
                    <div className="bg-indigo-50 text-indigo-700 px-3 py-2 rounded-lg text-center text-sm font-semibold">
                      Impact neuropsychologique
                    </div>
                  </div>

                  <div className="prose prose-sm text-slate-700 space-y-3">
                    <p className="leading-relaxed">
                      Cette grille évalue <strong>quatre dimensions du gaslighting professionnel</strong> : 
                      altération de la réalité (distorsion des faits), déstabilisation émotionnelle (invalidation, culpabilisation), 
                      contrôle coercitif (isolement, double contrainte) et impact neuropsychologique (hypervigilance, sidération cognitive). 
                      Évaluation basée sur <strong>les 6 derniers mois</strong>.
                    </p>
                  </div>
                </div>

                <div className="grid md:grid-cols-3 gap-4 mb-8">
                  <div className="bg-slate-50 p-4 rounded-xl text-center">
                    <div className="flex justify-center mb-2">
                      <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5" className="text-indigo-600">
                        <circle cx="12" cy="13" r="9"/>
                        <polyline points="12 7 12 13 15 15"/>
                        <path d="M10 2h4"/>
                      </svg>
                    </div>
                    <div className="text-2xl font-bold text-slate-900">18-24 min</div>
                    <div className="text-sm text-slate-600">Durée estimée</div>
                  </div>
                  <div className="bg-slate-50 p-4 rounded-xl text-center">
                    <div className="flex justify-center mb-2">
                      <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5" className="text-indigo-600">
                        <line x1="18" y1="20" x2="18" y2="10"/>
                        <line x1="12" y1="20" x2="12" y2="4"/>
                        <line x1="6" y1="20" x2="6" y2="14"/>
                      </svg>
                    </div>
                    <div className="text-2xl font-bold text-slate-900">60 questions</div>
                    <div className="text-sm text-slate-600">Grille clinique</div>
                  </div>
                  <div className="bg-slate-50 p-4 rounded-xl text-center">
                    <div className="flex justify-center mb-2">
                      <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5" className="text-indigo-600">
                        <path d="M3 3v18h18"/>
                        <path d="M18 9l-5 5-4-4-4 4"/>
                        <circle cx="18" cy="9" r="2" fill="currentColor"/>
                        <circle cx="13" cy="14" r="2" fill="currentColor"/>
                        <circle cx="9" cy="10" r="2" fill="currentColor"/>
                        <circle cx="5" cy="14" r="2" fill="currentColor"/>
                      </svg>
                    </div>
                    <div className="text-2xl font-bold text-slate-900">4 dimensions</div>
                    <div className="text-sm text-slate-600">Analyse multi-axes</div>
                  </div>
                </div>

                <button
                  onClick={() => setPage("test")}
                  className="w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white text-lg font-bold py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-xl"
                >
                  Commencer l'évaluation →
                </button>
              </div>

              <div className="text-center text-xs text-slate-500 space-y-1">
                <p className="font-semibold">NOÉSIS — Gaslighting Professionnel v1.0 • © 2025</p>
                <p>Confidentialité : aucune donnée collectée sans action explicite (RGPD)</p>
              </div>
            </div>
          </div>
        );
      }

      // ============================================================
      // PAGE TEST
      // ============================================================

      if (page === "test") {
        const q = QUESTIONS[currentQ];
        const dimInfo = AXES.find(d => d.key === q.dim);
        const colorMap = {
          red: { bg: "bg-red-50", border: "border-red-300", text: "text-red-700", badge: "bg-red-100 text-red-700" },
          amber: { bg: "bg-amber-50", border: "border-amber-300", text: "text-amber-700", badge: "bg-amber-100 text-amber-700" },
          purple: { bg: "bg-purple-50", border: "border-purple-300", text: "text-purple-700", badge: "bg-purple-100 text-purple-700" },
          indigo: { bg: "bg-indigo-50", border: "border-indigo-300", text: "text-indigo-700", badge: "bg-indigo-100 text-indigo-700" },
        };
        const colors = colorMap[dimInfo.color];

        return (
          <div className="min-h-screen bg-gradient-to-br from-slate-50 via-indigo-50 to-purple-50 p-4 md:p-8">
            <div className="max-w-3xl mx-auto">
              
              <div className="mb-6">
                <div className="flex justify-between items-center mb-2">
                  <span className="text-sm font-medium text-slate-600">
                    Question {currentQ + 1} / {QUESTIONS.length}
                  </span>
                  <span className="text-sm font-bold text-indigo-600">{progress}%</span>
                </div>
                <div className="w-full bg-slate-200 rounded-full h-3 overflow-hidden">
                  <div 
                    className="h-full bg-gradient-to-r from-indigo-500 to-purple-500 transition-all duration-300"
                    style={{ width: `${progress}%` }}
                  />
                </div>
              </div>

              <div className="bg-white rounded-2xl shadow-2xl p-6 md:p-8 mb-6">
                <div className="flex items-center gap-3 mb-6">
                  <div className={`w-12 h-12 rounded-full ${colors.bg} ${colors.border} border-2 flex items-center justify-center font-bold ${colors.text} text-lg`}>
                    {currentQ + 1}
                  </div>
                  <span className={`px-3 py-1 rounded-full text-xs font-semibold ${colors.badge}`}>
                    {dimInfo.label}
                  </span>
                </div>

                <h2 className="text-xl md:text-2xl font-bold text-slate-900 mb-8 leading-relaxed">
                  {q.text}
                </h2>

                <div className="space-y-3">
                  {CHOICES.map(choice => {
                    const isSelected = answers[q.id] === choice.value;
                    return (
                      <button
                        key={choice.value}
                        onClick={() => handleAnswer(q.id, choice.value)}
                        className={`w-full text-left p-4 rounded-xl border-2 transition-all ${
                          isSelected
                            ? 'bg-indigo-50 border-indigo-500 shadow-lg'
                            : 'bg-white border-slate-200 hover:border-indigo-300 hover:bg-slate-50'
                        }`}
                      >
                        <div className="flex items-center justify-between">
                          <div>
                            <div className={`font-semibold mb-1 ${isSelected ? 'text-indigo-700' : 'text-slate-900'}`}>
                              {choice.label}
                            </div>
                            <div className="text-xs text-slate-500">{choice.anchor}</div>
                          </div>
                          <div className={`w-6 h-6 rounded-full border-2 flex items-center justify-center ${
                            isSelected ? 'bg-indigo-500 border-indigo-500' : 'border-slate-300'
                          }`}>
                            {isSelected && <span className="text-white text-xs font-bold">✓</span>}
                          </div>
                        </div>
                      </button>
                    );
                  })}
                </div>
              </div>

              <div className="flex gap-4">
                <button
                  onClick={() => setCurrentQ(c => Math.max(0, c - 1))}
                  disabled={currentQ === 0}
                  className="flex-1 bg-slate-200 hover:bg-slate-300 disabled:bg-slate-100 disabled:text-slate-400 text-slate-700 font-semibold py-3 px-6 rounded-xl transition"
                >
                  ← Précédent
                </button>
                
                {currentQ === QUESTIONS.length - 1 ? (
                  <button
                    onClick={goToResults}
                    disabled={!allAnswered}
                    className="flex-1 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 disabled:from-slate-300 disabled:to-slate-300 text-white font-bold py-3 px-6 rounded-xl transition-all shadow-lg"
                  >
                    Voir les résultats →
                  </button>
                ) : (
                  <button
                    onClick={() => setCurrentQ(c => Math.min(QUESTIONS.length - 1, c + 1))}
                    className="flex-1 bg-slate-700 hover:bg-slate-800 text-white font-semibold py-3 px-6 rounded-xl transition"
                  >
                    Suivant →
                  </button>
                )}
              </div>

              <div className="mt-4 text-center">
                <button
                  onClick={goToResults}
                  disabled={!allAnswered}
                  className="text-sm text-slate-500 hover:text-slate-700 underline disabled:text-slate-300"
                >
                  {allAnswered ? "Aller directement aux résultats" : `${QUESTIONS.length - Object.keys(answers).length} question(s) restante(s)`}
                </button>
              </div>
            </div>
          </div>
        );
      }

      // ============================================================
      // PAGE RÉSULTATS + SECTION IMPRIMABLE
      // ============================================================

      return (
        <div className="min-h-screen bg-gradient-to-br from-slate-50 via-indigo-50 to-purple-50 p-4 md:p-8">
          <div className="max-w-5xl mx-auto">
            
            {/* SECTION ÉCRAN */}
            <div className="no-print">
              <div className="text-center mb-8">
                <div className="inline-block p-4 bg-gradient-to-br from-indigo-100 to-purple-100 rounded-2xl mb-4">
                  <svg width="56" height="56" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5" className="text-indigo-600">
                    <path d="M3 3v18h18"/>
                    <path d="M18 9l-5 5-4-4-4 4"/>
                    <circle cx="18" cy="9" r="2"/>
                    <circle cx="13" cy="14" r="2"/>
                    <circle cx="9" cy="10" r="2"/>
                    <circle cx="5" cy="14" r="2"/>
                  </svg>
                </div>
                <h1 className="text-4xl md:text-5xl font-black text-slate-900 mb-3">
                  Tes résultats
                </h1>
                <p className="text-lg text-slate-600 font-medium">
                  Analyse détaillée de ton exposition
                </p>
              </div>

              <div className="bg-white rounded-2xl shadow-2xl p-6 md:p-8 mb-6">
                <div className="text-center mb-6">
                  <div className="text-6xl font-black text-slate-900 mb-2">
                    {totalScore}<span className="text-3xl text-slate-400">/180</span>
                  </div>
                  <div className={`inline-block px-6 py-2 rounded-full text-lg font-bold ${
                    resultBand.color === 'green' ? 'bg-green-100 text-green-700' :
                    resultBand.color === 'yellow' ? 'bg-yellow-100 text-yellow-700' :
                    resultBand.color === 'orange' ? 'bg-orange-100 text-orange-700' :
                    'bg-red-100 text-red-700'
                  }`}>
                    {resultBand.band}
                  </div>
                </div>

                {resultBand.urgent && (
                  <div className="bg-red-50 border-l-4 border-red-500 p-4 mb-6 rounded-r-lg">
                    <div className="flex gap-3">
                      <span className="text-2xl flex-shrink-0">🚨</span>
                      <div className="text-sm text-red-900">
                        <p className="font-bold">Situation nécessitant une action urgente</p>
                      </div>
                    </div>
                  </div>
                )}

                <div className="bg-slate-50 p-6 rounded-2xl mb-6">
                  <h3 className="font-bold text-slate-900 mb-3">🔍 Interprétation clinique</h3>
                  <p className="text-sm text-slate-700 leading-relaxed">
                    {resultBand.message}
                  </p>
                </div>

                <div className="space-y-4 mb-6">
                  <h3 className="font-bold text-slate-900">Scores par dimension</h3>
                  {AXES.map(axis => {
                    const score = dimensionScores[axis.key];
                    const max = QUESTIONS.filter(q => q.dim === axis.key).length * 3;
                    const percentage = Math.round((score / max) * 100);
                    const colorMap = {
                      red: { bg: "bg-red-50", bar: "bg-red-500", text: "text-red-700" },
                      amber: { bg: "bg-amber-50", bar: "bg-amber-500", text: "text-amber-700" },
                      purple: { bg: "bg-purple-50", bar: "bg-purple-500", text: "text-purple-700" },
                      indigo: { bg: "bg-indigo-50", bar: "bg-indigo-500", text: "text-indigo-700" },
                    };
                    const colors = colorMap[axis.color];
                    
                    return (
                      <div key={axis.key} className={`p-4 rounded-xl ${colors.bg}`}>
                        <div className="flex justify-between items-center mb-2">
                          <span className={`text-sm font-bold ${colors.text}`}>{axis.label}</span>
                          <span className="text-sm font-bold text-slate-700">{score}/{max}</span>
                        </div>
                        <div className="w-full bg-white rounded-full h-3 overflow-hidden">
                          <div 
                            className={`h-full ${colors.bar} transition-all duration-500`}
                            style={{ width: `${percentage}%` }}
                          />
                        </div>
                        <div className="text-xs text-slate-600 mt-1">{percentage}%</div>
                      </div>
                    );
                  })}
                </div>

                <div className="bg-slate-50 p-6 rounded-2xl">
                  <h3 className="font-bold text-slate-900 mb-3">📌 Ton profil dominant</h3>
                  <p className="text-sm font-semibold text-indigo-600 mb-2">
                    {AXES.find(d => d.key === profileAnalysis.dominant)?.label}
                  </p>
                  <p className="text-sm text-slate-700 leading-relaxed">
                    {profileAnalysis.analysis}
                  </p>
                </div>
              </div>

              <div className="grid md:grid-cols-2 gap-6">
                
                <div className="bg-white rounded-2xl shadow-xl p-6">
                  <h2 className="text-xl font-bold text-slate-900 mb-4">Recommandations</h2>
                  <ul className="space-y-3">
                    {resultBand.recommendations.map((rec, idx) => (
                      <li key={idx} className="flex gap-3 text-sm text-slate-700">
                        <span className="flex-shrink-0 w-6 h-6 rounded-full bg-indigo-100 text-indigo-600 font-bold text-xs flex items-center justify-center">
                          {idx + 1}
                        </span>
                        <span>{rec}</span>
                      </li>
                    ))}
                  </ul>

                  {resultBand.urgent && (
                    <div className="mt-6 pt-6 border-t-2 border-slate-100">
                      <h3 className="font-bold text-slate-900 mb-3">Ressources d'urgence</h3>
                      <ul className="space-y-2 text-sm">
                        <li>
                          <span className="text-slate-900 font-medium">3114</span>
                          <span className="text-slate-600"> — Prévention suicide</span>
                        </li>
                        <li>
                          <span className="text-slate-900 font-medium">01 45 39 40 00</span>
                          <span className="text-slate-600"> — Suicide Écoute</span>
                        </li>
                        <li>
                          <span className="text-slate-900 font-medium">Médecin du travail</span>
                          <span className="text-slate-600"> — Consultation urgente</span>
                        </li>
                      </ul>
                    </div>
                  )}
                </div>

                <div className="bg-white rounded-2xl shadow-xl p-6">
                  <h2 className="text-xl font-bold text-slate-900 mb-4">Exporter les résultats</h2>
                  
                  <div className="space-y-3">
                    <button
                      onClick={handlePDF}
                      className="w-full bg-slate-900 text-white font-semibold py-3 px-4 rounded-xl hover:bg-slate-800 transition"
                    >
                      📄 Télécharger en PDF
                    </button>

                    <button
                      onClick={handleDownloadJSON}
                      className="w-full bg-slate-700 text-white font-semibold py-3 px-4 rounded-xl hover:bg-slate-600 transition"
                    >
                      💾 Télécharger en JSON
                    </button>

                    <div className="pt-4 border-t-2 border-slate-100">
                      <label className="block text-sm font-medium text-slate-700 mb-2">
                        Envoyer par email
                      </label>
                      <div className="flex gap-2">
                        <input
                          type="email"
                          value={email}
                          onChange={(e) => setEmail(e.target.value)}
                          placeholder="email@exemple.com"
                          className="flex-1 rounded-lg border-2 border-slate-300 px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none"
                        />
                        <button
                          onClick={handleEmail}
                          disabled={!email}
                          className="bg-indigo-600 disabled:bg-slate-300 text-white font-semibold px-4 py-2 rounded-lg hover:bg-indigo-700 transition"
                        >
                          📧
                        </button>
                      </div>
                    </div>

                    <button
                      onClick={reset}
                      className="w-full mt-4 text-slate-600 hover:text-slate-900 font-medium underline text-sm"
                    >
                      Refaire le test
                    </button>
                  </div>
                </div>
              </div>

              <div className="mt-8 text-center text-xs text-slate-500 space-y-2">
                <p className="font-semibold">NOÉSIS — Gaslighting Professionnel v1.0 • © 2025</p>
                <p>Outil de pré-diagnostic d'orientation • Pas un diagnostic médical</p>
                <p>Confidentialité : aucune donnée collectée sans action explicite (RGPD)</p>
              </div>
            </div>

            {/* SECTION IMPRIMABLE PDF (cachée à l'écran) */}
            <div className="print-only print-container">
              <div className="print-section">
                <h1 className="print-header">Résultats — Gaslighting Professionnel</h1>
                <p className="print-text">Date : {new Date().toLocaleDateString('fr-FR')}</p>
                <p className="print-text">Score total : <strong>{totalScore}/180</strong></p>
                <p className="print-text">Profil : <strong>{resultBand.band}</strong></p>
              </div>

              <div className="print-section">
                <h2 className="print-subheader">Interprétation clinique</h2>
                <p className="print-text">{resultBand.message}</p>
              </div>

              <div className="print-section">
                <h2 className="print-subheader">Scores par dimension</h2>
                {AXES.map(axis => {
                  const score = dimensionScores[axis.key];
                  const max = QUESTIONS.filter(q => q.dim === axis.key).length * 3;
                  const percentage = Math.round((score / max) * 100);
                  return (
                    <div key={axis.key} className="print-score-box">
                      <p className="print-text"><strong>{axis.label}</strong> : {score}/{max} ({percentage}%)</p>
                    </div>
                  );
                })}
              </div>

              <div className="print-section">
                <h2 className="print-subheader">Profil dominant</h2>
                <p className="print-text"><strong>{AXES.find(d => d.key === profileAnalysis.dominant)?.label}</strong></p>
                <p className="print-text">{profileAnalysis.analysis}</p>
              </div>

              <div className="print-section">
                <h2 className="print-subheader">Recommandations</h2>
                {resultBand.recommendations.map((rec, idx) => (
                  <p key={idx} className="print-reco">{idx + 1}. {rec}</p>
                ))}
              </div>

              {/* DÉTAIL COMPLET DES QUESTIONS PAR AXE */}
              <div className="print-section" style={{pageBreakBefore: 'always'}}>
                <h2 className="print-header">Détail des réponses par dimension</h2>
                
                {AXES.map(axis => {
                  const axisQuestions = QUESTIONS.filter(q => q.dim === axis.key);
                  return (
                    <div key={axis.key} className="print-axis-section">
                      <h3 className="print-subheader">{axis.label}</h3>
                      {axisQuestions.map(q => {
                        const answer = CHOICES.find(c => c.value === answers[q.id]);
                        return (
                          <div key={q.id} className="print-question">
                            <p className="print-text">
                              <strong>{q.id}</strong> : {q.text}
                            </p>
                            <p className="print-text" style={{paddingLeft: '16px', color: '#4b5563'}}>
                              → Réponse : <strong>{answer?.label || 'Non répondu'}</strong> ({answer?.anchor || ''})
                            </p>
                          </div>
                        );
                      })}
                    </div>
                  );
                })}
              </div>

              <div className="print-section" style={{marginTop: '20px', paddingTop: '12px', borderTop: '1px solid #e2e8f0'}}>
                <p className="print-text" style={{fontSize: '10px', color: '#64748b'}}>
                  NOÉSIS — Gaslighting Professionnel v1.0 • © 2025 • Outil de pré-diagnostic d'orientation, ne remplace pas un diagnostic médical
                </p>
              </div>
            </div>
          </div>
        </div>
      );
    }

    // ============================================================
    // RENDU DANS LE DOM
    // ============================================================

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<GaslightingTest />);
  </script>
</body>
</html>
