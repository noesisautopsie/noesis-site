<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Autotest TDAH Adaptatif ‚Äî √âvaluation Multidimensionnelle | NO√âSIS</title>
  <meta name="description" content="Outil d'auto-√©valuation scientifiquement calibr√© pour le Trouble du D√©ficit de l'Attention avec ou sans Hyperactivit√© (TDAH). Analyse par √¢ge, contextes multiples et exportation professionnelle.">
  
  <!-- Open Graph -->
  <meta property="og:title" content="Autotest TDAH Adaptatif ‚Äî NO√âSIS">
  <meta property="og:description" content="√âvaluation rigoureuse du TDAH avec adaptation par √¢ge, analyse contextuelle et profil personnalis√©.">
  <meta property="og:type" content="website">
  
  <!-- Polices Google -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@300;400;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <style>
    /* ==================== VARIABLES CSS NO√âSIS ==================== */
    :root {
      /* Palette Chromatique NO√âSIS */
      --noir-absolu: #0A0A0A;
      --noir-doux: #111111;
      --noir-surface: #1A1A1A;
      --creme-principal: #F7F5EF;
      --creme-chaud: #F9F7F1;
      --blanc-surface: #FFFFFF;
      --or-signature: #C7A86D;
      --or-riche: #D4B980;
      --or-sombre: #A89158;
      --or-subtil: rgba(199,168,109,.08);
      --or-leger: rgba(199,168,109,.15);
      --or-moyen: rgba(199,168,109,.25);
      
      /* Dimensions Th√©matiques */
      --inattention-color: #2563eb;
      --inattention-bg: rgba(37,99,235,0.08);
      --hyperactivite-color: #dc2626;
      --hyperactivite-bg: rgba(220,38,38,0.08);
      --executif-color: #7c3aed;
      --executif-bg: rgba(124,58,237,0.08);
      --emotion-color: #ea580c;
      --emotion-bg: rgba(234,88,12,0.08);
      
      /* Typographie */
      --fs-xs: 12px; --fs-sm: 14px; --fs-md: 18px;
      --fs-lg: 21px; --fs-xl: 24px; --fs-2xl: 32px;
      --fs-3xl: 42px; --fs-4xl: 56px;
      --lh-tight: 1.2; --lh-normal: 1.5; --lh-relaxed: 1.7;
      
      /* Spacing (√©chelle 8px) */
      --s-2: 8px; --s-3: 12px; --s-4: 16px; --s-6: 24px;
      --s-8: 32px; --s-12: 48px; --s-16: 64px; --s-20: 80px;
      
      /* Ombres */
      --shadow-soft: 0 2px 8px rgba(10,10,10,.08), 0 1px 2px rgba(10,10,10,.12);
      --shadow-medium: 0 4px 16px rgba(10,10,10,.1), 0 2px 4px rgba(10,10,10,.15);
      --shadow-large: 0 8px 32px rgba(10,10,10,.12), 0 2px 8px rgba(10,10,10,.18);
      
      /* Bordures */
      --border-subtil: rgba(10,10,10,.08);
      --border-leger: rgba(10,10,10,.12);
      --border-visible: rgba(10,10,10,.18);
      
      /* Rayons */
      --radius-sm: 4px; --radius-md: 8px; --radius-lg: 12px;
      --radius-xl: 16px; --radius-2xl: 24px; --radius-pill: 9999px;
      
      /* Transitions */
      --ease-standard: cubic-bezier(0.4, 0.0, 0.2, 1);
      --ease-spring: cubic-bezier(0.16, 1, 0.3, 1);
      --duration-fast: 150ms; --duration-normal: 250ms; --duration-slow: 350ms;
    }
    
    /* ==================== RESET & BASE ==================== */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Inter', sans-serif;
      font-size: var(--fs-md);
      line-height: var(--lh-relaxed);
      color: var(--noir-absolu);
      background: var(--creme-principal);
      -webkit-font-smoothing: antialiased;
    }
    
    h1, h2, h3 {
      font-family: 'Fraunces', serif;
      font-weight: 600;
      line-height: var(--lh-tight);
    }
    
    /* ==================== LAYOUT ==================== */
    .app-container {
      max-width: 900px;
      margin: 0 auto;
      padding: var(--s-12) var(--s-6);
    }
    
    .screen {
      display: none;
    }
    
    .screen.active {
      display: block;
      animation: fadeIn var(--duration-normal) var(--ease-standard);
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(8px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* ==================== √âCRAN INTRO ==================== */
    .intro-header {
      text-align: center;
      margin-bottom: var(--s-12);
    }
    
    .icon-container {
      width: 80px;
      height: 80px;
      margin: 0 auto var(--s-4);
      background: linear-gradient(135deg, var(--or-subtil), var(--or-leger));
      border: 2px solid var(--or-signature);
      border-radius: var(--radius-xl);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .icon-svg {
      width: 40px;
      height: 40px;
      stroke: var(--or-signature);
      fill: none;
    }
    
    .intro-title {
      font-size: var(--fs-3xl);
      color: var(--noir-absolu);
      margin-bottom: var(--s-3);
    }
    
    .intro-subtitle {
      font-size: var(--fs-md);
      color: rgba(10,10,10,0.6);
      font-weight: 400;
    }
    
    /* Cartes */
    .card {
      background: var(--blanc-surface);
      border-radius: var(--radius-2xl);
      padding: var(--s-12);
      margin-bottom: var(--s-8);
      box-shadow: var(--shadow-large);
    }
    
    .card h2 {
      font-size: var(--fs-xl);
      margin-bottom: var(--s-6);
      display: flex;
      align-items: center;
      gap: var(--s-3);
    }
    
    .card-icon {
      width: 24px;
      height: 24px;
      stroke: var(--or-signature);
    }
    
    /* Warning Box */
    .warning-box {
      background: #fffbeb;
      border-left: 4px solid var(--or-signature);
      border-radius: var(--radius-md);
      padding: var(--s-6);
      margin-bottom: var(--s-8);
    }
    
    .warning-box h3 {
      font-size: var(--fs-lg);
      margin-bottom: var(--s-3);
      display: flex;
      align-items: center;
      gap: var(--s-2);
    }
    
    .warning-box p {
      font-size: var(--fs-sm);
      line-height: var(--lh-relaxed);
      color: rgba(10,10,10,0.75);
    }
    
    /* Dimensions List */
    .dimensions-list {
      display: grid;
      gap: var(--s-4);
    }
    
    .dimension-item {
      background: var(--creme-chaud);
      border-left: 3px solid var(--inattention-color);
      border-radius: var(--radius-md);
      padding: var(--s-4);
      transition: transform var(--duration-normal) var(--ease-standard);
    }
    
    .dimension-item:hover {
      transform: translateX(4px);
    }
    
    .dimension-item.hyperactivite { border-left-color: var(--hyperactivite-color); }
    .dimension-item.executif { border-left-color: var(--executif-color); }
    .dimension-item.emotion { border-left-color: var(--emotion-color); }
    
    .dimension-item h4 {
      font-size: var(--fs-md);
      font-weight: 600;
      margin-bottom: var(--s-2);
    }
    
    .dimension-item p {
      font-size: var(--fs-sm);
      color: rgba(10,10,10,0.7);
      line-height: var(--lh-normal);
    }
    
    /* Steps */
    .steps-list {
      display: grid;
      gap: var(--s-4);
      margin-top: var(--s-6);
    }
    
    .step-item {
      display: flex;
      gap: var(--s-4);
      align-items: flex-start;
    }
    
    .step-number {
      flex-shrink: 0;
      width: 32px;
      height: 32px;
      background: var(--or-signature);
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: var(--fs-sm);
    }
    
    .step-content h5 {
      font-size: var(--fs-md);
      font-weight: 600;
      margin-bottom: var(--s-2);
    }
    
    .step-content p {
      font-size: var(--fs-sm);
      color: rgba(10,10,10,0.7);
    }
    
    /* Consentement */
    .consent-section {
      margin-top: var(--s-8);
      padding: var(--s-6);
      background: var(--creme-chaud);
      border-radius: var(--radius-lg);
    }
    
    .consent-checkbox {
      display: flex;
      align-items: flex-start;
      gap: var(--s-3);
      cursor: pointer;
    }
    
    .consent-checkbox input[type="checkbox"] {
      margin-top: 4px;
      width: 20px;
      height: 20px;
      cursor: pointer;
    }
    
    .consent-checkbox label {
      font-size: var(--fs-sm);
      line-height: var(--lh-relaxed);
      cursor: pointer;
    }
    
    /* Anamn√®se */
    .anamnese-section {
      margin-top: var(--s-8);
    }
    
    .anamnese-field {
      margin-bottom: var(--s-6);
    }
    
    .anamnese-field label {
      display: block;
      font-weight: 600;
      margin-bottom: var(--s-2);
      font-size: var(--fs-sm);
    }
    
    .anamnese-field input,
    .anamnese-field select {
      width: 100%;
      padding: var(--s-3);
      border: 1.5px solid var(--border-leger);
      border-radius: var(--radius-md);
      font-size: var(--fs-sm);
      font-family: inherit;
      transition: border-color var(--duration-normal) var(--ease-standard);
    }
    
    .anamnese-field input:focus,
    .anamnese-field select:focus {
      outline: none;
      border-color: var(--or-signature);
    }
    
    .anamnese-hint {
      font-size: var(--fs-xs);
      color: rgba(10,10,10,0.6);
      margin-top: var(--s-2);
    }
    
    /* Boutons */
    .btn {
      padding: var(--s-4) var(--s-12);
      border: none;
      border-radius: var(--radius-pill);
      font-family: 'Inter', sans-serif;
      font-size: var(--fs-md);
      font-weight: 600;
      cursor: pointer;
      transition: all var(--duration-normal) var(--ease-standard);
      display: inline-block;
      text-align: center;
      text-decoration: none;
    }
    
    .btn-primary {
      background: var(--or-signature);
      color: white;
    }
    
    .btn-primary:hover:not(:disabled) {
      background: var(--or-riche);
      transform: scale(1.02);
      box-shadow: var(--shadow-medium);
    }
    
    .btn-primary:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    .btn-secondary {
      background: transparent;
      color: var(--or-sombre);
      border: 1.5px solid var(--or-signature);
    }
    
    .btn-secondary:hover {
      background: var(--or-subtil);
    }
    
    .btn-container {
      display: flex;
      gap: var(--s-3);
      justify-content: center;
      margin-top: var(--s-8);
    }
    
    /* ==================== √âCRAN TEST ==================== */
    .test-header {
      background: var(--blanc-surface);
      border-radius: var(--radius-xl);
      padding: var(--s-6);
      margin-bottom: var(--s-8);
      box-shadow: var(--shadow-soft);
    }
    
    .progress-container {
      margin-bottom: var(--s-4);
    }
    
    .progress-label {
      display: flex;
      justify-content: space-between;
      margin-bottom: var(--s-2);
      font-size: var(--fs-sm);
      font-weight: 600;
    }
    
    .progress-bar {
      width: 100%;
      height: 8px;
      background: var(--creme-principal);
      border-radius: var(--radius-pill);
      overflow: hidden;
    }
    
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--or-signature), var(--or-riche));
      border-radius: var(--radius-pill);
      transition: width var(--duration-slow) var(--ease-spring);
    }
    
    .dimension-badge {
      display: inline-block;
      padding: var(--s-2) var(--s-4);
      background: var(--inattention-bg);
      color: var(--inattention-color);
      border-radius: var(--radius-pill);
      font-size: var(--fs-xs);
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .dimension-badge.hyperactivite { background: var(--hyperactivite-bg); color: var(--hyperactivite-color); }
    .dimension-badge.executif { background: var(--executif-bg); color: var(--executif-color); }
    .dimension-badge.emotion { background: var(--emotion-bg); color: var(--emotion-color); }
    
    /* Question Container */
    .question-container {
      background: var(--blanc-surface);
      border-radius: var(--radius-2xl);
      padding: var(--s-12);
      box-shadow: var(--shadow-large);
      margin-bottom: var(--s-8);
    }
    
    .question-number {
      font-size: var(--fs-sm);
      font-weight: 600;
      color: rgba(10,10,10,0.5);
      margin-bottom: var(--s-3);
    }
    
    .question-text {
      font-size: var(--fs-xl);
      line-height: var(--lh-normal);
      margin-bottom: var(--s-8);
      color: var(--noir-absolu);
    }
    
    /* √âchelle de R√©ponses */
    .answer-options {
      display: grid;
      gap: var(--s-3);
    }
    
    .answer-option {
      padding: var(--s-4);
      background: var(--creme-chaud);
      border: 2px solid transparent;
      border-radius: var(--radius-lg);
      cursor: pointer;
      transition: all var(--duration-normal) var(--ease-standard);
    }
    
    .answer-option:hover {
      border-color: var(--or-leger);
      background: var(--blanc-surface);
    }
    
    .answer-option.selected {
      border-color: var(--or-signature);
      background: var(--or-subtil);
    }
    
    .answer-option input[type="radio"] {
      display: none;
    }
    
    .answer-label {
      display: block;
      cursor: pointer;
    }
    
    .answer-main {
      font-size: var(--fs-md);
      font-weight: 600;
      margin-bottom: var(--s-2);
    }
    
    .answer-sublabel {
      font-size: var(--fs-sm);
      color: rgba(10,10,10,0.65);
      line-height: var(--lh-normal);
    }
    
    /* Navigation Footer */
    .nav-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: var(--s-4);
    }
    
    /* Masquer bouton Suivant avec progression automatique */
    #next-btn {
      display: none;
    }
    
    .nav-footer .btn {
      flex: 1;
      max-width: 200px;
    }
    
    .questions-remaining {
      font-size: var(--fs-sm);
      color: rgba(10,10,10,0.6);
      text-align: center;
    }
    
    /* ==================== √âCRAN R√âSULTATS ==================== */
    .results-hero {
      text-align: center;
      margin-bottom: var(--s-12);
    }
    
    .score-hero {
      font-size: 120px;
      font-family: 'Fraunces', serif;
      font-weight: 700;
      color: var(--or-signature);
      line-height: 1;
      margin-bottom: var(--s-3);
    }
    
    .score-fraction {
      font-size: var(--fs-xl);
      color: rgba(10,10,10,0.4);
      font-weight: 400;
    }
    
    .level-badge {
      display: inline-block;
      padding: var(--s-3) var(--s-8);
      border-radius: var(--radius-pill);
      font-size: var(--fs-md);
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: var(--s-4);
    }
    
    .level-badge.minimal { background: #d1fae5; color: #065f46; }
    .level-badge.low { background: #dbeafe; color: #1e40af; }
    .level-badge.moderate { background: #fef3c7; color: #92400e; }
    .level-badge.high { background: #fee2e2; color: #991b1b; }
    
    .score-message {
      font-size: var(--fs-lg);
      color: rgba(10,10,10,0.75);
      line-height: var(--lh-relaxed);
      max-width: 600px;
      margin: 0 auto;
    }
    
    /* Profil Section */
    .profile-section {
      background: var(--creme-chaud);
      border-radius: var(--radius-xl);
      padding: var(--s-8);
      margin-bottom: var(--s-8);
    }
    
    .profile-section h2 {
      font-size: var(--fs-2xl);
      margin-bottom: var(--s-6);
    }
    
    .profile-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: var(--s-4);
      margin-bottom: var(--s-6);
    }
    
    .profile-item {
      background: var(--blanc-surface);
      border-radius: var(--radius-md);
      padding: var(--s-4);
    }
    
    .profile-label {
      font-size: var(--fs-xs);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: rgba(10,10,10,0.6);
      margin-bottom: var(--s-2);
      font-weight: 600;
    }
    
    .profile-value {
      font-size: var(--fs-lg);
      font-weight: 600;
      color: var(--noir-absolu);
    }
    
    /* Dimensions Analysis */
    .dimension-analysis {
      display: grid;
      gap: var(--s-6);
    }
    
    .dimension-card {
      background: var(--blanc-surface);
      border-left: 4px solid var(--inattention-color);
      border-radius: var(--radius-lg);
      padding: var(--s-6);
      box-shadow: var(--shadow-soft);
    }
    
    .dimension-card.hyperactivite { border-left-color: var(--hyperactivite-color); }
    .dimension-card.executif { border-left-color: var(--executif-color); }
    .dimension-card.emotion { border-left-color: var(--emotion-color); }
    
    .dimension-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: var(--s-4);
    }
    
    .dimension-name {
      font-size: var(--fs-lg);
      font-weight: 600;
    }
    
    .dimension-score-display {
      font-size: var(--fs-xl);
      font-family: 'Fraunces', serif;
      font-weight: 600;
      color: var(--or-signature);
    }
    
    .dimension-bar-container {
      height: 12px;
      background: var(--creme-principal);
      border-radius: var(--radius-pill);
      overflow: hidden;
      margin-bottom: var(--s-4);
    }
    
    .dimension-bar-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--inattention-color), rgba(37,99,235,0.7));
      border-radius: var(--radius-pill);
      transition: width var(--duration-slow) var(--ease-spring);
    }
    
    .dimension-card.hyperactivite .dimension-bar-fill {
      background: linear-gradient(90deg, var(--hyperactivite-color), rgba(220,38,38,0.7));
    }
    
    .dimension-card.executif .dimension-bar-fill {
      background: linear-gradient(90deg, var(--executif-color), rgba(124,58,237,0.7));
    }
    
    .dimension-card.emotion .dimension-bar-fill {
      background: linear-gradient(90deg, var(--emotion-color), rgba(234,88,12,0.7));
    }
    
    .dimension-interpretation {
      font-size: var(--fs-sm);
      line-height: var(--lh-relaxed);
      color: rgba(10,10,10,0.75);
    }
    
    /* Recommandations */
    .recommendations-section {
      background: var(--blanc-surface);
      border-radius: var(--radius-2xl);
      padding: var(--s-12);
      box-shadow: var(--shadow-large);
      margin-bottom: var(--s-8);
    }
    
    .recommendations-section h2 {
      font-size: var(--fs-2xl);
      margin-bottom: var(--s-6);
    }
    
    .recommendation-list {
      display: grid;
      gap: var(--s-4);
    }
    
    .recommendation-item {
      padding: var(--s-4);
      background: var(--creme-chaud);
      border-left: 3px solid var(--or-signature);
      border-radius: var(--radius-md);
    }
    
    .recommendation-item h4 {
      font-size: var(--fs-md);
      font-weight: 600;
      margin-bottom: var(--s-2);
    }
    
    .recommendation-item p {
      font-size: var(--fs-sm);
      color: rgba(10,10,10,0.75);
      line-height: var(--lh-relaxed);
    }
    
    /* Export Actions */
    .export-actions {
      display: flex;
      gap: var(--s-3);
      flex-wrap: wrap;
      justify-content: center;
      margin-top: var(--s-8);
    }
    
    .export-actions .btn {
      flex: 1;
      min-width: 180px;
    }
    
    /* Disclaimer */
    .disclaimer-box {
      background: var(--creme-chaud);
      border: 1.5px solid var(--border-leger);
      border-radius: var(--radius-lg);
      padding: var(--s-6);
      margin-top: var(--s-12);
    }
    
    .disclaimer-box h4 {
      font-size: var(--fs-md);
      font-weight: 600;
      margin-bottom: var(--s-3);
    }
    
    .disclaimer-box p {
      font-size: var(--fs-sm);
      line-height: var(--lh-relaxed);
      color: rgba(10,10,10,0.75);
      margin-bottom: var(--s-3);
    }
    
    .disclaimer-box p:last-child {
      margin-bottom: 0;
    }
    
    .emergency-contact {
      margin-top: var(--s-4);
      padding-top: var(--s-4);
      border-top: 1px solid var(--border-subtil);
      font-weight: 600;
    }
    
    /* ==================== RESPONSIVE ==================== */
    @media (max-width: 768px) {
      .app-container {
        padding: var(--s-6) var(--s-4);
      }
      
      .intro-title {
        font-size: var(--fs-2xl);
      }
      
      .question-text {
        font-size: var(--fs-lg);
      }
      
      .score-hero {
        font-size: 80px;
      }
      
      .nav-footer {
        flex-direction: column;
      }
      
      .nav-footer .btn {
        max-width: 100%;
        width: 100%;
      }
      
      .profile-grid {
        grid-template-columns: 1fr;
      }
    }
    
    @media (max-width: 480px) {
      .intro-title {
        font-size: var(--fs-xl);
      }
      
      .score-hero {
        font-size: 64px;
      }
      
      .btn-container {
        flex-direction: column;
      }
      
      .btn-container .btn {
        width: 100%;
      }
    }
    
    /* ==================== PRINT ==================== */
    @media print {
      body {
        background: white;
      }
      
      .export-actions,
      .btn {
        display: none !important;
      }
      
      .card,
      .question-container,
      .recommendations-section {
        page-break-inside: avoid;
      }
    }
  </style>
</head>
<body>
  
  <div id="app" class="app-container">
    
    <!-- ==================== √âCRAN INTRO ==================== -->
    <div id="intro-screen" class="screen active">
      
      <div class="intro-header">
        <div class="icon-container">
          <svg class="icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2z"/>
            <path d="M12 6v6l4 2"/>
          </svg>
        </div>
        <h1 class="intro-title">Autotest TDAH Adaptatif</h1>
        <p class="intro-subtitle">√âvaluation multidimensionnelle avec calibration par √¢ge et analyse contextuelle</p>
      </div>
      
      <div class="warning-box">
        <h3>
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
            <line x1="12" y1="9" x2="12" y2="13"/>
            <line x1="12" y1="17" x2="12.01" y2="17"/>
          </svg>
          Avertissement Important
        </h3>
        <p>
          Cet outil est destin√© √† l'<strong>auto-√©valuation informative</strong> et ne remplace en aucun cas un diagnostic clinique. Le Trouble du D√©ficit de l'Attention avec ou sans Hyperactivit√© (TDAH) ne peut √™tre diagnostiqu√© que par un professionnel qualifi√© (psychiatre, neuropsychologue, neurop√©diatre) apr√®s un bilan complet.
        </p>
        <p>
          Les r√©sultats refl√®tent votre perception subjective actuelle et doivent √™tre interpr√©t√©s avec prudence. En cas de scores √©lev√©s ou de souffrance significative, consultez un sp√©cialiste.
        </p>
      </div>
      
      <div class="card">
        <h2>
          <svg class="card-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"/>
            <path d="M12 16v-4M12 8h.01"/>
          </svg>
          M√©thodologie
        </h2>
        <p>
          Ce questionnaire √©value <strong>4 dimensions cliniques</strong> du TDAH selon les crit√®res DSM-5-TR, adapt√©es aux groupes d'√¢ge (enfants, adolescents, adultes, seniors). L'analyse int√®gre des <strong>modulateurs contextuels</strong> (√¢ge de d√©but, multi-contextes, type d'√©valuateur) et calcule un <strong>indice de risque composite</strong> (0‚Äì100) tenant compte des facteurs situationnels.
        </p>
        
        <h3 style="font-size: var(--fs-lg); margin-top: var(--s-6); margin-bottom: var(--s-4);">Dimensions √âvalu√©es</h3>
        <div class="dimensions-list">
          <div class="dimension-item inattention">
            <h4>Inattention</h4>
            <p>Difficult√© √† maintenir l'attention, distractibilit√©, oublis fr√©quents, difficult√©s organisationnelles.</p>
          </div>
          <div class="dimension-item hyperactivite">
            <h4>Hyperactivit√© / Impulsivit√©</h4>
            <p>Agitation motrice, incapacit√© √† rester en place, difficult√© √† attendre, tendance √† interrompre.</p>
          </div>
          <div class="dimension-item executif">
            <h4>Fonctions Ex√©cutives</h4>
            <p>Planification, m√©moire de travail, flexibilit√© cognitive, inhibition, initiation des t√¢ches.</p>
          </div>
          <div class="dimension-item emotion">
            <h4>R√©gulation √âmotionnelle</h4>
            <p>R√©activit√© √©motionnelle excessive, difficult√©s de gestion des frustrations, instabilit√© de l'humeur.</p>
          </div>
        </div>
      </div>
      
      <div class="card">
        <h2>
          <svg class="card-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <path d="M9 11l3 3L22 4"/>
            <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/>
          </svg>
          Comment √ßa marche
        </h2>
        <div class="steps-list">
          <div class="step-item">
            <div class="step-number">1</div>
            <div class="step-content">
              <h5>Informations Pr√©liminaires</h5>
              <p>Renseignez votre √¢ge, le contexte d'impact et quelques donn√©es anamnestiques essentielles (optionnel mais recommand√© pour affiner l'analyse).</p>
            </div>
          </div>
          <div class="step-item">
            <div class="step-number">2</div>
            <div class="step-content">
              <h5>Questionnaire (40 items)</h5>
              <p>R√©pondez √† 40 questions sur une √©chelle de fr√©quence √† 4 points (Jamais ‚Üí Syst√©matiquement). Chaque item √©value un comportement observable sp√©cifique.</p>
            </div>
          </div>
          <div class="step-item">
            <div class="step-number">3</div>
            <div class="step-content">
              <h5>Analyse Personnalis√©e</h5>
              <p>Obtenez vos scores par dimension, un profil global, un indice de risque composite et des recommandations adapt√©es √† votre situation.</p>
            </div>
          </div>
          <div class="step-item">
            <div class="step-number">4</div>
            <div class="step-content">
              <h5>Export & Partage</h5>
              <p>T√©l√©chargez un PDF professionnel ou exportez les donn√©es JSON pour un suivi longitudinal ou une consultation sp√©cialis√©e.</p>
            </div>
          </div>
        </div>
        <p style="margin-top: var(--s-6); font-size: var(--fs-sm); color: rgba(10,10,10,0.6);">
          <strong>Dur√©e estim√©e :</strong> 8‚Äì12 minutes ‚Ä¢ <strong>Nombre de questions :</strong> 40 ‚Ä¢ <strong>Confidentialit√© :</strong> 100% locale (aucune donn√©e transmise)
        </p>
      </div>
      
      <!-- Anamn√®se Pr√©liminaire -->
      <div class="card anamnese-section">
        <h2>Informations Pr√©liminaires (Optionnel)</h2>
        <p style="margin-bottom: var(--s-6); font-size: var(--fs-sm); color: rgba(10,10,10,0.7);">
          Ces informations permettent d'affiner l'interpr√©tation des r√©sultats selon votre profil. Vous pouvez les laisser vides si vous le souhaitez.
        </p>
        
        <div class="anamnese-field">
          <label for="user-age">√Çge</label>
          <input type="number" id="user-age" min="6" max="99" placeholder="Ex : 28">
          <p class="anamnese-hint">L'analyse sera calibr√©e selon les seuils normatifs de votre groupe d'√¢ge.</p>
        </div>
        
        <div class="anamnese-field">
          <label for="user-name">Nom / Initiales (pour le PDF)</label>
          <input type="text" id="user-name" placeholder="Ex : A.D. ou Anonymous" maxlength="50">
          <p class="anamnese-hint">Optionnel. Utilis√© uniquement pour personnaliser le document export√©.</p>
        </div>
        
        <div class="anamnese-field">
          <label for="onset-age">Les difficult√©s ont-elles commenc√© avant 12 ans ?</label>
          <select id="onset-age">
            <option value="unknown">Je ne sais pas / Non pr√©cis√©</option>
            <option value="yes">Oui, avant 12 ans</option>
            <option value="no">Non, apr√®s 12 ans</option>
          </select>
          <p class="anamnese-hint">Crit√®re diagnostique DSM-5 : d√©but des sympt√¥mes avant 12 ans.</p>
        </div>
        
        <div class="anamnese-field">
          <label for="multi-context">Les difficult√©s se manifestent-elles dans plusieurs contextes ?</label>
          <select id="multi-context">
            <option value="unknown">Je ne sais pas</option>
            <option value="yes">Oui (‚â•2 contextes : maison, √©cole/travail, social)</option>
            <option value="no">Non (un seul contexte principalement)</option>
          </select>
          <p class="anamnese-hint">L'impact dans plusieurs domaines de vie renforce la probabilit√© clinique.</p>
        </div>
        
        <div class="anamnese-field">
          <label for="evaluator-type">Vous r√©pondez en tant que :</label>
          <select id="evaluator-type">
            <option value="self">Personne concern√©e (auto-√©valuation)</option>
            <option value="parent">Parent / Tuteur</option>
            <option value="teacher">Enseignant / √âducateur</option>
            <option value="partner">Conjoint / Proche</option>
            <option value="other">Autre</option>
          </select>
          <p class="anamnese-hint">Le type d'√©valuateur influence la formulation de l'analyse narrative.</p>
        </div>
      </div>
      
      <!-- Consentement -->
      <div class="consent-section">
        <div class="consent-checkbox">
          <input type="checkbox" id="consent-check">
          <label for="consent-check">
            J'ai lu et compris les avertissements. Je confirme que cet outil est utilis√© √† des fins informatives uniquement et qu'il ne remplace pas une consultation avec un professionnel de sant√© qualifi√©. Je comprends que toutes mes donn√©es restent locales et ne sont transmises √† aucun serveur.
          </label>
        </div>
      </div>
      
      <div class="btn-container">
        <button class="btn btn-primary" id="start-btn" disabled>D√©marrer l'√âvaluation</button>
      </div>
      
    </div>
    
    <!-- ==================== √âCRAN TEST ==================== -->
    <div id="test-screen" class="screen">
      
      <div class="test-header">
        <div class="progress-container">
          <div class="progress-label">
            <span>Progression</span>
            <span id="progress-text">0%</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" id="progress-fill"></div>
          </div>
        </div>
        <div style="text-align: center; margin-top: var(--s-3);">
          <span class="dimension-badge" id="current-dimension-badge">Inattention</span>
        </div>
      </div>
      
      <div class="question-container">
        <p class="question-number" id="question-number">Question 1/40</p>
        <h2 class="question-text" id="question-text"></h2>
        
        <div class="answer-options" id="answer-options">
          <!-- Options g√©n√©r√©es dynamiquement -->
        </div>
      </div>
      
      <div class="nav-footer">
        <button class="btn btn-secondary" id="prev-btn" style="visibility: hidden;">‚Üê Pr√©c√©dent</button>
        <div class="questions-remaining" id="questions-remaining"></div>
        <button class="btn btn-primary" id="next-btn" disabled>Suivant ‚Üí</button>
      </div>
      
    </div>
    
    <!-- ==================== √âCRAN R√âSULTATS ==================== -->
    <div id="results-screen" class="screen">
      
      <div class="results-hero">
        <div class="score-hero" id="total-score-display">0</div>
        <p class="score-fraction">/ 120</p>
        <div class="level-badge" id="global-level-badge">Niveau</div>
        <p class="score-message" id="score-message"></p>
      </div>
      
      <!-- Profil Anamnestique -->
      <div class="profile-section" id="profile-section">
        <h2>Profil & Contexte</h2>
        <div class="profile-grid" id="profile-grid">
          <!-- G√©n√©r√© dynamiquement -->
        </div>
        <div style="margin-top: var(--s-6);">
          <p style="font-size: var(--fs-sm); color: rgba(10,10,10,0.7); line-height: var(--lh-relaxed);">
            <strong>Indice de Risque Composite :</strong> <span id="risk-index-value" style="font-weight: 600; color: var(--or-signature);"></span> / 100
          </p>
          <p style="font-size: var(--fs-xs); color: rgba(10,10,10,0.6); margin-top: var(--s-2);">
            Cet indice int√®gre les scores bruts, l'√¢ge, les contextes d'impact et la qualit√© des r√©ponses (d√©tection de patterns uniformes). Il fournit une estimation globale du niveau de difficult√©.
          </p>
        </div>
      </div>
      
      <!-- Analyse Dimensionnelle -->
      <div class="card">
        <h2>Analyse par Dimension</h2>
        <div class="dimension-analysis" id="dimension-analysis">
          <!-- G√©n√©r√© dynamiquement -->
        </div>
      </div>
      
      <!-- Analyse Approfondie du Profil -->
      <div class="card" style="background: linear-gradient(135deg, #F7F5EF 0%, #F9F7F1 100%); border: 2px solid var(--or-signature);">
        <h2 style="display: flex; align-items: center; gap: var(--s-3);">
          <svg class="card-icon" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-width="2">
            <path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
          </svg>
          Analyse Approfondie du Profil
        </h2>
        <div id="profile-analysis-container">
          <!-- G√©n√©r√© dynamiquement -->
        </div>
      </div>
      
      <!-- Recommandations -->
      <div class="recommendations-section">
        <h2>Recommandations Personnalis√©es</h2>
        <div class="recommendation-list" id="recommendation-list">
          <!-- G√©n√©r√© dynamiquement -->
        </div>
      </div>
      
      <!-- Actions Export -->
      <div class="export-actions">
        <button class="btn btn-primary" id="pdf-btn">üìÑ T√©l√©charger PDF</button>
        <button class="btn btn-secondary" id="email-btn">‚úâÔ∏è Envoyer par Email</button>
        <button class="btn btn-secondary" id="json-btn">üìä Exporter JSON</button>
        <button class="btn btn-secondary" id="reset-btn">üîÑ Recommencer</button>
      </div>
      
      <!-- Disclaimer Final -->
      <div class="disclaimer-box">
        <h4>Nature et Limites de l'Outil</h4>
        <p>
          Ce questionnaire constitue un <strong>outil de sensibilisation et de pr√©-√©valuation</strong>, con√ßu selon des standards m√©thodologiques rigoureux mais <strong>non valid√© psychom√©triquement</strong> par protocole scientifique formel (validation convergente, fid√©lit√© test-retest, analyse factorielle confirmatoire).
        </p>
        <p>
          Les r√©sultats refl√®tent votre <strong>perception subjective</strong> √† un instant donn√© et <strong>ne constituent en aucun cas un diagnostic clinique</strong>.
        </p>
        <p>
          En cas de scores √©lev√©s, de d√©tresse significative ou de questionnement persistant, nous recommandons fortement de <strong>consulter un professionnel qualifi√©</strong> (psychiatre, neuropsychologue, neurop√©diatre).
        </p>
        <p class="emergency-contact">
          <strong>Ressources Sp√©cialis√©es France :</strong><br>
          ‚Ä¢ Association HyperSupers TDAH France : <a href="https://www.tdah-france.fr" target="_blank">www.tdah-france.fr</a><br>
          ‚Ä¢ Lignes d'√©coute : 3114 (pr√©vention suicide), Fil Sant√© Jeunes 0800 235 236
        </p>
      </div>
      
    </div>
    
  </div>
  
  <!-- ==================== SCRIPTS EXTERNES (PDF) ==================== -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  
  <script>
    // ==================== √âTAT GLOBAL ====================
    const state = {
      currentScreen: 'intro',
      answers: {},
      currentQuestionIndex: 0,
      anamnesis: {
        age: null,
        name: '',
        onsetAge: 'unknown',
        multiContext: 'unknown',
        evaluatorType: 'self'
      }
    };
    
    // ==================== DONN√âES ‚Äî QUESTIONS ====================
    const QUESTIONS = [
      // INATTENTION (10 items)
      { id: 1, text: "J'ai du mal √† maintenir mon attention sur des t√¢ches longues ou r√©p√©titives.", dim: "inattention" },
      { id: 2, text: "Je fais fr√©quemment des erreurs d'inattention dans mon travail ou mes √©tudes.", dim: "inattention" },
      { id: 3, text: "J'ai l'impression de ne pas √©couter quand on me parle directement.", dim: "inattention" },
      { id: 4, text: "J'ai du mal √† suivre les instructions jusqu'au bout et √† terminer les t√¢ches.", dim: "inattention" },
      { id: 5, text: "J'√©vite ou reporte syst√©matiquement les t√¢ches n√©cessitant un effort mental soutenu.", dim: "inattention" },
      { id: 6, text: "Je perds fr√©quemment des objets essentiels (cl√©s, t√©l√©phone, documents).", dim: "inattention" },
      { id: 7, text: "Je suis facilement distrait¬∑e par des stimuli externes (bruits, mouvements).", dim: "inattention" },
      { id: 8, text: "J'oublie des rendez-vous, des √©ch√©ances ou des t√¢ches du quotidien.", dim: "inattention" },
      { id: 9, text: "J'ai des difficult√©s √† organiser mes activit√©s et √† g√©rer mon temps.", dim: "inattention" },
      { id: 10, text: "Je passe d'une t√¢che √† l'autre sans les terminer, avec une impression de dispersion mentale.", dim: "inattention" },
      
      // HYPERACTIVIT√â / IMPULSIVIT√â (10 items)
      { id: 11, text: "Je bouge sans arr√™t les mains, les pieds ou je m'agite sur ma chaise.", dim: "hyperactivite" },
      { id: 12, text: "J'ai du mal √† rester assis¬∑e longtemps dans des situations qui l'exigent.", dim: "hyperactivite" },
      { id: 13, text: "Je ressens une tension interne, une sensation d'√™tre sous pression constante.", dim: "hyperactivite" },
      { id: 14, text: "J'ai des difficult√©s √† me d√©tendre ou √† pratiquer des activit√©s calmes.", dim: "hyperactivite" },
      { id: 15, text: "Je parle de mani√®re excessive, parfois sans pouvoir m'arr√™ter.", dim: "hyperactivite" },
      { id: 16, text: "Je r√©ponds aux questions avant qu'elles soient termin√©es.", dim: "hyperactivite" },
      { id: 17, text: "J'ai du mal √† attendre mon tour dans les files d'attente ou les conversations.", dim: "hyperactivite" },
      { id: 18, text: "J'interromps les autres ou je m'impose dans leurs activit√©s.", dim: "hyperactivite" },
      { id: 19, text: "Je prends des d√©cisions impulsives sans r√©fl√©chir aux cons√©quences.", dim: "hyperactivite" },
      { id: 20, text: "J'ai tendance √† agir sous le coup de l'√©motion, avec des regrets ensuite.", dim: "hyperactivite" },
      
      // FONCTIONS EX√âCUTIVES (10 items)
      { id: 21, text: "J'ai des difficult√©s √† planifier les √©tapes d'un projet complexe.", dim: "executif" },
      { id: 22, text: "Je peine √† estimer le temps n√©cessaire pour accomplir une t√¢che.", dim: "executif" },
      { id: 23, text: "Je procrastine syst√©matiquement, m√™me pour des choses importantes.", dim: "executif" },
      { id: 24, text: "J'ai du mal √† g√©rer plusieurs informations simultan√©ment (m√©moire de travail).", dim: "executif" },
      { id: 25, text: "Je me sens bloqu√©¬∑e quand il faut passer d'une activit√© √† une autre (rigidit√©).", dim: "executif" },
      { id: 26, text: "J'ai du mal √† m'auto-corriger ou √† ajuster mon comportement selon le contexte.", dim: "executif" },
      { id: 27, text: "Je me lance dans une t√¢che sans pr√©paration ni strat√©gie claire.", dim: "executif" },
      { id: 28, text: "J'ai des difficult√©s √† inhiber mes premi√®res r√©actions ou mes impulsions.", dim: "executif" },
      { id: 29, text: "Je ne parviens pas √† maintenir un effort mental sur la dur√©e n√©cessaire.", dim: "executif" },
      { id: 30, text: "J'oublie rapidement les consignes ou les informations qu'on vient de me donner.", dim: "executif" },
      
      // R√âGULATION √âMOTIONNELLE (10 items)
      { id: 31, text: "Je r√©agis de mani√®re disproportionn√©e face aux contrari√©t√©s mineures.", dim: "emotion" },
      { id: 32, text: "Mon humeur change rapidement et de fa√ßon impr√©visible.", dim: "emotion" },
      { id: 33, text: "Je vis mes √©motions avec une intensit√© beaucoup plus forte que les autres.", dim: "emotion" },
      { id: 34, text: "J'ai du mal √† me calmer une fois que je suis √©nerv√©¬∑e ou frustr√©¬∑e.", dim: "emotion" },
      { id: 35, text: "Je suis facilement bless√©¬∑e par les critiques ou les remarques.", dim: "emotion" },
      { id: 36, text: "J'√©prouve une sensation chronique d'ennui ou d'insatisfaction.", dim: "emotion" },
      { id: 37, text: "Je ressens une impatience constante, une difficult√© √† tol√©rer l'attente.", dim: "emotion" },
      { id: 38, text: "J'ai des difficult√©s √† g√©rer le stress, avec une sensation de d√©bordement rapide.", dim: "emotion" },
      { id: 39, text: "Je passe d'un √©tat d'excitation √† un √©tat de d√©couragement tr√®s rapidement.", dim: "emotion" },
      { id: 40, text: "Je ressens une hypersensibilit√© √©motionnelle face aux stimuli (sons, lumi√®res, textures).", dim: "emotion" }
    ];
    
    // ==================== √âCHELLE DE R√âPONSES ====================
    const SCALE_OPTIONS = [
      { value: 0, label: "Jamais", sublabel: "Absence totale de manifestation" },
      { value: 1, label: "Rarement", sublabel: "Quelques occurrences isol√©es" },
      { value: 2, label: "Souvent", sublabel: "Manifestations r√©guli√®res, impact notable" },
      { value: 3, label: "Syst√©matiquement", sublabel: "Pr√©sence constante, impact majeur" }
    ];
    
    // ==================== DIMENSIONS ====================
    const DIMENSIONS = [
      {
        key: "inattention",
        label: "Inattention",
        fullLabel: "Inattention",
        description: "Difficult√© √† maintenir l'attention, distractibilit√©, oublis, d√©sorganisation",
        color: "var(--inattention-color)",
        bg: "var(--inattention-bg)"
      },
      {
        key: "hyperactivite",
        label: "Hyperactivit√©/Impulsivit√©",
        fullLabel: "Hyperactivit√© & Impulsivit√©",
        description: "Agitation motrice, impulsivit√© d√©cisionnelle, difficult√© √† attendre",
        color: "var(--hyperactivite-color)",
        bg: "var(--hyperactivite-bg)"
      },
      {
        key: "executif",
        label: "Fonctions Ex√©cutives",
        fullLabel: "Fonctions Ex√©cutives",
        description: "Planification, organisation, m√©moire de travail, flexibilit√© cognitive",
        color: "var(--executif-color)",
        bg: "var(--executif-bg)"
      },
      {
        key: "emotion",
        label: "R√©gulation √âmotionnelle",
        fullLabel: "R√©gulation √âmotionnelle",
        description: "R√©activit√© √©motionnelle, instabilit√© de l'humeur, hypersensibilit√©",
        color: "var(--emotion-color)",
        bg: "var(--emotion-bg)"
      }
    ];
    
    // ==================== SEUILS PAR √ÇGE ====================
    // Format : { min_score_percent_for_level: [faible, l√©ger, mod√©r√©, √©lev√©] }
    const AGE_THRESHOLDS = {
      '6-12': {
        inattention: [0, 40, 60, 80],
        hyperactivite: [0, 45, 65, 85],
        executif: [0, 40, 60, 80],
        emotion: [0, 35, 55, 75]
      },
      '13-17': {
        inattention: [0, 35, 55, 75],
        hyperactivite: [0, 40, 60, 80],
        executif: [0, 35, 55, 75],
        emotion: [0, 30, 50, 70]
      },
      '18-54': {
        inattention: [0, 30, 50, 70],
        hyperactivite: [0, 35, 55, 75],
        executif: [0, 30, 50, 70],
        emotion: [0, 25, 45, 65]
      },
      '55+': {
        inattention: [0, 28, 48, 68],
        hyperactivite: [0, 33, 53, 73],
        executif: [0, 28, 48, 68],
        emotion: [0, 23, 43, 63]
      }
    };
    
    // ==================== INTERPR√âTATIONS DIMENSIONNELLES ====================
    const DIMENSION_INTERPRETATIONS = {
      inattention: {
        minimal: "Les indicateurs d'inattention sont absents ou n√©gligeables. Votre capacit√© √† maintenir l'attention sur des t√¢ches vari√©es semble pr√©serv√©e.",
        low: "Pr√©sence l√©g√®re de difficult√©s attentionnelles sans impact fonctionnel majeur. Il peut s'agir de fluctuations normales li√©es au stress ou √† la fatigue.",
        moderate: "Manifestations significatives d'inattention avec impact notable sur la vie quotidienne. Une √©valuation approfondie pourrait identifier des strat√©gies compensatoires.",
        high: "Niveau √©lev√© de difficult√©s attentionnelles n√©cessitant attention particuli√®re. Ces manifestations peuvent affecter significativement la productivit√© et le bien-√™tre. Consultation recommand√©e."
      },
      hyperactivite: {
        minimal: "Les indicateurs d'hyperactivit√© et d'impulsivit√© sont absents ou n√©gligeables. Vous semblez capable de r√©guler votre niveau d'activit√© et vos impulsions.",
        low: "Pr√©sence l√©g√®re d'agitation ou d'impulsivit√©, sans retentissement majeur. Cela peut refl√©ter un temp√©rament dynamique plut√¥t qu'un dysfonctionnement.",
        moderate: "Manifestations significatives d'hyperactivit√© ou d'impulsivit√© avec impact sur les interactions sociales ou la gestion du quotidien. Des techniques de r√©gulation pourraient √™tre b√©n√©fiques.",
        high: "Niveau √©lev√© d'agitation motrice ou d'impulsivit√© n√©cessitant attention. Ces manifestations peuvent entra√Æner des difficult√©s relationnelles ou professionnelles. √âvaluation sp√©cialis√©e recommand√©e."
      },
      executif: {
        minimal: "Les fonctions ex√©cutives (planification, organisation, m√©moire de travail) semblent pr√©serv√©es. Vous parvenez g√©n√©ralement √† g√©rer les t√¢ches complexes.",
        low: "Difficult√©s l√©g√®res en planification ou organisation, sans impact fonctionnel significatif. Des outils simples (listes, agenda) peuvent suffire.",
        moderate: "Manifestations significatives de difficult√©s ex√©cutives avec impact notable sur la gestion du temps et des projets. Une √©valuation neuropsychologique pourrait pr√©ciser le profil.",
        high: "Niveau √©lev√© de dysfonctionnement ex√©cutif n√©cessitant attention. Ces difficult√©s peuvent compromettre l'autonomie professionnelle ou scolaire. Consultation sp√©cialis√©e fortement recommand√©e."
      },
      emotion: {
        minimal: "La r√©gulation √©motionnelle semble globalement adapt√©e. Vous parvenez √† g√©rer vos √©motions dans la plupart des situations.",
        low: "R√©activit√© √©motionnelle l√©g√®rement augment√©e, sans retentissement majeur. Cela peut refl√©ter une sensibilit√© naturelle plut√¥t qu'une dysr√©gulation clinique.",
        moderate: "Manifestations significatives de dysr√©gulation √©motionnelle avec impact sur le bien-√™tre et les relations. Des approches th√©rapeutiques (TCC, pleine conscience) pourraient √™tre b√©n√©fiques.",
        high: "Niveau √©lev√© de dysr√©gulation √©motionnelle n√©cessitant attention. Ces manifestations peuvent entra√Æner une souffrance importante. Consultation en sant√© mentale fortement recommand√©e."
      }
    };
    
    // ==================== BANDES DE R√âSULTATS ====================
    const RESULT_BANDS = [
      {
        min: 0, max: 30,
        level: "Absence de Manifestation",
        severity: "minimal",
        interpretation: "Les indicateurs √©valu√©s sont absents ou n√©gligeables. Profil normatif attendu.",
        color: "#059669",
        recommendations: [
          "Maintenir un √©quilibre de vie sain (sommeil, activit√© physique, gestion du stress).",
          "Rester attentif aux variations dans le temps, surtout en p√©riodes de charge accrue.",
          "Favoriser des strat√©gies d'organisation proactives pour pr√©server l'efficacit√©."
        ]
      },
      {
        min: 31, max: 50,
        level: "Pr√©sence L√©g√®re",
        severity: "low",
        interpretation: "Manifestations l√©g√®res, sans impact fonctionnel significatif. Surveillance pr√©ventive recommand√©e.",
        color: "#0284c7",
        recommendations: [
          "Mettre en place des outils simples d'organisation (listes, alarmes, plannings).",
          "Identifier les contextes o√π les difficult√©s se manifestent le plus.",
          "Pratiquer des techniques de gestion du stress (respiration, pauses r√©guli√®res).",
          "Envisager un bilan si les sympt√¥mes s'intensifient ou persistent au-del√† de 6 mois."
        ]
      },
      {
        min: 51, max: 75,
        level: "Pr√©sence Mod√©r√©e",
        severity: "moderate",
        interpretation: "Manifestations significatives avec impact fonctionnel notable. Intervention cibl√©e conseill√©e.",
        color: "#f59e0b",
        recommendations: [
          "Consulter un professionnel pour une √©valuation approfondie (neuropsychologue, psychiatre).",
          "Explorer des strat√©gies compensatoires adapt√©es (coaching, psycho√©ducation, TCC).",
          "Am√©nager l'environnement (r√©duction des distracteurs, structuration des t√¢ches).",
          "Envisager un soutien scolaire ou professionnel selon le contexte.",
          "Maintenir une hygi√®ne de vie rigoureuse (sommeil, alimentation, activit√© physique)."
        ]
      },
      {
        min: 76, max: 120,
        level: "Pr√©sence S√©v√®re",
        severity: "high",
        interpretation: "Manifestations intenses avec alt√©ration fonctionnelle majeure. Consultation sp√©cialis√©e fortement recommand√©e.",
        color: "#dc2626",
        recommendations: [
          "Consulter en urgence un psychiatre ou neuropsychologue sp√©cialis√© en TDAH.",
          "R√©aliser un bilan complet (tests neuropsychologiques, questionnaires standardis√©s).",
          "Envisager une prise en charge multimodale (psychoth√©rapie, √©ventuellement m√©dicamenteuse).",
          "Solliciter des am√©nagements scolaires ou professionnels (tiers-temps, plan de soutien).",
          "Rejoindre des groupes de soutien ou associations sp√©cialis√©es (ex. HyperSupers TDAH France).",
          "√âvaluer les comorbidit√©s fr√©quentes (anxi√©t√©, d√©pression, troubles du sommeil)."
        ]
      }
    ];
    
    // ==================== FONCTIONS UTILITAIRES ====================
    
    function getAgeGroup(age) {
      if (!age) return '18-54'; // D√©faut adulte
      if (age >= 6 && age <= 12) return '6-12';
      if (age >= 13 && age <= 17) return '13-17';
      if (age >= 18 && age <= 54) return '18-54';
      return '55+';
    }
    
    function getSeverityLevel(percentage, thresholds) {
      if (percentage < thresholds[1]) return 'minimal';
      if (percentage < thresholds[2]) return 'low';
      if (percentage < thresholds[3]) return 'moderate';
      return 'high';
    }
    
    function getDimensionInterpretation(dimKey, percentage, ageGroup) {
      const thresholds = AGE_THRESHOLDS[ageGroup][dimKey];
      const level = getSeverityLevel(percentage, thresholds);
      return DIMENSION_INTERPRETATIONS[dimKey][level];
    }
    
    function calculateRiskIndex(scores, anamnesis) {
      // Indice composite 0-100
      let index = 0;
      
      // Base : score total normalis√©
      const totalPercentage = (scores.total / scores.maxTotal) * 100;
      index += totalPercentage * 0.5; // 50% du poids
      
      // Modulateurs contextuels
      if (anamnesis.onsetAge === 'yes') index += 10; // D√©but pr√©coce
      if (anamnesis.multiContext === 'yes') index += 15; // Multi-contextes
      
      // Poids par domaine (simulation : on estime l'impact selon les dimensions)
      const dimScores = scores.dimensions;
      const maxImpact = Math.max(
        dimScores.inattention.percentage,
        dimScores.hyperactivite.percentage,
        dimScores.executif.percentage,
        dimScores.emotion.percentage
      );
      index += maxImpact * 0.25; // 25% du poids
      
      // Qualit√© des r√©ponses : d√©tection de patterns uniformes
      const answersArray = Object.values(state.answers);
      const allSame = answersArray.every(v => v === answersArray[0]);
      if (allSame) index -= 20; // P√©nalit√© pour r√©ponses uniformes (suspect)
      
      // Clamp 0-100
      return Math.max(0, Math.min(100, Math.round(index)));
    }
    
    // ==================== CALCUL SCORES ====================
    
    function calculateScores() {
      const dimensions = {};
      let total = 0;
      
      DIMENSIONS.forEach(dim => {
        const questionsForDim = QUESTIONS.filter(q => q.dim === dim.key);
        const score = questionsForDim.reduce((sum, q) => {
          return sum + (state.answers[q.id] || 0);
        }, 0);
        const maxScore = questionsForDim.length * 3;
        const percentage = Math.round((score / maxScore) * 100);
        
        dimensions[dim.key] = { score, maxScore, percentage };
        total += score;
      });
      
      const maxTotal = QUESTIONS.length * 3;
      const ageGroup = getAgeGroup(state.anamnesis.age);
      const riskIndex = calculateRiskIndex({ dimensions, total, maxTotal }, state.anamnesis);
      
      return { dimensions, total, maxTotal, ageGroup, riskIndex };
    }
    
    function getResultBand(totalScore, maxTotal) {
      const percentage = (totalScore / maxTotal) * 100;
      return RESULT_BANDS.find(band => percentage >= band.min && percentage <= band.max);
    }
    
    // ==================== ANALYSE APPROFONDIE DU PROFIL ====================
    
    function generateProfileAnalysis(scores) {
      const analysis = {
        dominantDimensions: [],
        profilePattern: '',
        specificInsights: [],
        functionalImpact: '',
        developmentalConsiderations: '',
        interactionPatterns: ''
      };
      
      // 1. Identifier dimensions dominantes (>60%)
      const dimArray = Object.entries(scores.dimensions).map(([key, data]) => ({
        key,
        ...data,
        label: DIMENSIONS.find(d => d.key === key).fullLabel
      })).sort((a, b) => b.percentage - a.percentage);
      
      analysis.dominantDimensions = dimArray.filter(d => d.percentage >= 60);
      
      // 2. D√©terminer pattern de profil
      const high = dimArray.filter(d => d.percentage >= 70).map(d => d.key);
      const moderate = dimArray.filter(d => d.percentage >= 40 && d.percentage < 70).map(d => d.key);
      const low = dimArray.filter(d => d.percentage < 40).map(d => d.key);
      
      if (high.length >= 3) {
        analysis.profilePattern = 'Profil Global S√©v√®re';
        analysis.specificInsights.push("Vos r√©sultats r√©v√®lent une pr√©sentation multidimensionnelle marqu√©e du TDAH, avec des manifestations significatives dans la majorit√© des domaines √©valu√©s. Cette constellation de difficult√©s sugg√®re un impact fonctionnel √©tendu n√©cessitant une attention particuli√®re.");
      } else if (high.includes('inattention') && high.includes('executif')) {
        analysis.profilePattern = 'Profil Inattentif avec Dysfonction Ex√©cutive';
        analysis.specificInsights.push("Votre profil se caract√©rise principalement par des difficult√©s attentionnelles associ√©es √† un dysfonctionnement ex√©cutif. Cette combinaison est typique du sous-type inattentif du TDAH et affecte particuli√®rement la planification, l'organisation et la gestion des t√¢ches complexes.");
      } else if (high.includes('hyperactivite') && moderate.includes('emotion')) {
        analysis.profilePattern = 'Profil Hyperactif-Impulsif avec Dysr√©gulation √âmotionnelle';
        analysis.specificInsights.push("Votre profil r√©v√®le une pr√©dominance de l'agitation motrice et de l'impulsivit√©, accompagn√©e d'une r√©gulation √©motionnelle fragile. Cette association peut g√©n√©rer des difficult√©s importantes dans les interactions sociales et la gestion des situations stressantes.");
      } else if (dimArray[0].percentage - dimArray[3].percentage > 40) {
        analysis.profilePattern = 'Profil H√©t√©rog√®ne avec Dimension Pr√©dominante';
        analysis.specificInsights.push(`Votre profil pr√©sente une h√©t√©rog√©n√©it√© marqu√©e, avec une pr√©dominance nette de la dimension "${dimArray[0].label}" (${dimArray[0].percentage}%). Cette dispersion sugg√®re que les manifestations du TDAH s'expriment de mani√®re s√©lective plut√¥t que g√©n√©ralis√©e.`);
      } else {
        analysis.profilePattern = 'Profil √âquilibr√© Mod√©r√©';
        analysis.specificInsights.push("Votre profil se caract√©rise par une distribution relativement homog√®ne des manifestations √† travers les diff√©rentes dimensions du TDAH. Cette pr√©sentation sugg√®re un impact fonctionnel mod√©r√© mais √©tendu.");
      }
      
      // 3. Impact fonctionnel contextualis√©
      const ageGroup = scores.ageGroup;
      const hasMultiContext = state.anamnesis.multiContext === 'yes';
      const earlyOnset = state.anamnesis.onsetAge === 'yes';
      
      if (ageGroup === '6-12') {
        analysis.functionalImpact = "√Ä votre √¢ge, ces manifestations peuvent affecter significativement les apprentissages scolaires, les relations avec les pairs et le d√©veloppement de l'autonomie. Les difficult√©s dans la r√©gulation comportementale et attentionnelle √† cette p√©riode critique peuvent compromettre l'acquisition des comp√©tences acad√©miques fondamentales.";
      } else if (ageGroup === '13-17') {
        analysis.functionalImpact = "Durant l'adolescence, ces manifestations peuvent interf√©rer avec la scolarit√©, la construction identitaire et les relations sociales. Les d√©fis li√©s √† l'organisation, la gestion du temps et la r√©gulation √©motionnelle deviennent particuli√®rement saillants face aux exigences croissantes d'autonomie.";
      } else if (ageGroup === '18-54') {
        analysis.functionalImpact = "√Ä l'√¢ge adulte, ces manifestations peuvent impacter significativement la vie professionnelle, les relations interpersonnelles et la gestion du quotidien. Les difficult√©s ex√©cutives et attentionnelles peuvent compromettre la productivit√©, tandis que la dysr√©gulation √©motionnelle affecte la qualit√© des relations.";
      } else {
        analysis.functionalImpact = "√Ä votre stade de vie, ces manifestations peuvent affecter la qualit√© de vie globale, l'autonomie fonctionnelle et le bien-√™tre psychologique. Le vieillissement peut parfois masquer certains sympt√¥mes d'hyperactivit√© tout en exacerbant les difficult√©s attentionnelles et mn√©siques.";
      }
      
      if (hasMultiContext) {
        analysis.functionalImpact += " Le fait que ces difficult√©s se manifestent dans plusieurs contextes de vie renforce l'hypoth√®se d'un trouble sous-jacent plut√¥t que de simples r√©actions situationnelles.";
      }
      
      // 4. Consid√©rations d√©veloppementales
      if (earlyOnset) {
        analysis.developmentalConsiderations = "Le d√©but pr√©coce des sympt√¥mes (avant 12 ans) est un crit√®re diagnostique central du TDAH selon le DSM-5-TR. Cette chronologie sugg√®re une origine neurod√©veloppementale, distinguant le TDAH de difficult√©s attentionnelles acquises √† l'√¢ge adulte. L'installation pr√©coce implique souvent des m√©canismes compensatoires d√©velopp√©s au fil du temps, qui peuvent masquer partiellement l'intensit√© des difficult√©s sous-jacentes.";
      } else if (state.anamnesis.onsetAge === 'no') {
        analysis.developmentalConsiderations = "L'apparition tardive des sympt√¥mes (apr√®s 12 ans) peut questionner le diagnostic de TDAH stricto sensu, bien que certaines recherches r√©centes sugg√®rent l'existence de formes √† d√©but tardif. Il conviendrait d'explorer d'autres hypoth√®ses diagnostiques (troubles anxieux, d√©pression, syndrome post-commotionnel, effets m√©dicamenteux) qui peuvent mimer les manifestations du TDAH.";
      }
      
      // 5. Patterns d'interaction entre dimensions
      const inatt = scores.dimensions.inattention?.percentage || 0;
      const hyper = scores.dimensions.hyperactivite?.percentage || 0;
      const exec = scores.dimensions.executif?.percentage || 0;
      const emo = scores.dimensions.emotion?.percentage || 0;
      
      if (exec > 65 && (inatt > 65 || hyper > 65)) {
        analysis.interactionPatterns = "L'association entre dysfonctionnement ex√©cutif et manifestations attentionnelles/hyperactives cr√©e un effet amplificateur. Les difficult√©s √† planifier et organiser exacerbent les probl√®mes d'attention, cr√©ant un cercle vicieux o√π chaque domaine d√©t√©riore les capacit√©s de l'autre. Des interventions ciblant sp√©cifiquement les fonctions ex√©cutives (structuration, strat√©gies m√©tacognitives) pourraient avoir un effet b√©n√©fique en cascade.";
      }
      
      if (emo > 60 && hyper > 60) {
        analysis.interactionPatterns += (analysis.interactionPatterns ? " " : "") + "La combinaison dysr√©gulation √©motionnelle et impulsivit√© constitue un facteur de vuln√©rabilit√© majeur pour les relations interpersonnelles et la prise de d√©cision. L'impulsivit√© r√©duit le d√©lai de r√©flexion n√©cessaire √† la modulation √©motionnelle, tandis que l'intensit√© √©motionnelle alimente les comportements impulsifs. Des approches th√©rapeutiques int√©grant r√©gulation √©motionnelle (pleine conscience, TCC) et gestion de l'impulsivit√© sont particuli√®rement indiqu√©es.";
      }
      
      if (inatt > 70 && hyper < 30) {
        analysis.interactionPatterns += (analysis.interactionPatterns ? " " : "") + "Votre profil √† pr√©dominance inattentive (faible hyperactivit√© motrice) correspond au sous-type historiquement appel√© 'TDAH de type inattentif'. Ce profil, plus fr√©quent chez les femmes, est souvent sous-diagnostiqu√© car moins perturbateur en apparence. Cependant, l'impact fonctionnel peut √™tre tout aussi s√©v√®re, particuli√®rement sur le plan acad√©mique et professionnel.";
      }
      
      // 6. Insights sp√©cifiques par dimension dominante
      if (analysis.dominantDimensions.length > 0) {
        analysis.dominantDimensions.forEach(dim => {
          if (dim.key === 'inattention' && dim.percentage >= 70) {
            analysis.specificInsights.push("Vos difficult√©s attentionnelles marqu√©es peuvent se manifester par une distractibilit√© importante, des oublis fr√©quents, des difficult√©s √† soutenir l'effort mental et une tendance √† la procrastination face aux t√¢ches exigeantes. Ces manifestations g√©n√®rent souvent un sentiment de sous-performance chronique malgr√© des capacit√©s intellectuelles pr√©serv√©es.");
          }
          
          if (dim.key === 'hyperactivite' && dim.percentage >= 70) {
            analysis.specificInsights.push("Votre niveau √©lev√© d'hyperactivit√© et d'impulsivit√© peut se traduire par une agitation motrice constante, des difficult√©s √† rester assis, une tendance √† interrompre les autres, et des d√©cisions prises sans r√©flexion suffisante. Ces manifestations peuvent √™tre per√ßues par l'entourage comme un manque de consid√©ration ou de contr√¥le, alors qu'elles refl√®tent un dysfonctionnement neurologique sous-jacent.");
          }
          
          if (dim.key === 'executif' && dim.percentage >= 70) {
            analysis.specificInsights.push("Vos difficult√©s ex√©cutives majeures affectent votre capacit√© √† planifier, organiser, prioriser et mener √† terme les projets. La m√©moire de travail limit√©e rend difficile le maintien simultan√© de plusieurs informations, tandis que la rigidit√© cognitive complique l'adaptation face aux impr√©vus. Ces d√©ficits g√©n√®rent fr√©quemment un sentiment de d√©bordement et d'inefficacit√©.");
          }
          
          if (dim.key === 'emotion' && dim.percentage >= 70) {
            analysis.specificInsights.push("Votre dysr√©gulation √©motionnelle s√©v√®re se caract√©rise par une r√©activit√© √©motionnelle intense, des variations d'humeur rapides, une difficult√© √† moduler les √©motions n√©gatives et une hypersensibilit√© aux stimuli √©motionnels. Bien que moins reconnue dans les crit√®res diagnostiques classiques du TDAH, cette dimension constitue souvent la source majeure de souffrance subjective et de complications relationnelles.");
          }
        });
      }
      
      // 7. Consid√©rations sur les comorbidit√©s potentielles
      if (emo > 70 && scores.riskIndex > 70) {
        analysis.specificInsights.push("‚ö†Ô∏è Votre niveau √©lev√© de dysr√©gulation √©motionnelle associ√© √† un indice de risque important sugg√®re la possibilit√© de comorbidit√©s anxio-d√©pressives. Le TDAH est fr√©quemment associ√© √† des troubles anxieux (30-50% des cas) et d√©pressifs (20-30% des cas). Une √©valuation clinique compl√®te devrait explorer ces dimensions pour adapter au mieux les interventions th√©rapeutiques.");
      }
      
      return analysis;
    }
    
    // ==================== NAVIGATION ====================
    
    function showScreen(screenId) {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById(screenId + '-screen').classList.add('active');
      state.currentScreen = screenId;
    }
    
    function startTest() {
      // Collecter anamn√®se
      state.anamnesis.age = parseInt(document.getElementById('user-age').value) || null;
      state.anamnesis.name = document.getElementById('user-name').value.trim() || 'Anonyme';
      state.anamnesis.onsetAge = document.getElementById('onset-age').value;
      state.anamnesis.multiContext = document.getElementById('multi-context').value;
      state.anamnesis.evaluatorType = document.getElementById('evaluator-type').value;
      
      state.currentQuestionIndex = 0;
      state.answers = {};
      showScreen('test');
      renderQuestion();
    }
    
    function nextQuestion() {
      if (state.currentQuestionIndex < QUESTIONS.length - 1) {
        state.currentQuestionIndex++;
        renderQuestion();
      } else {
        showResults();
      }
    }
    
    function prevQuestion() {
      if (state.currentQuestionIndex > 0) {
        state.currentQuestionIndex--;
        renderQuestion();
      }
    }
    
    function selectAnswer(value) {
      state.answers[QUESTIONS[state.currentQuestionIndex].id] = value;
      renderQuestion();
      
      // Progression automatique apr√®s s√©lection avec d√©lai pour feedback visuel
      setTimeout(() => {
        nextQuestion();
      }, 400);
    }
    
    function showResults() {
      showScreen('results');
      renderResults();
    }
    
    function resetTest() {
      if (confirm("√ätes-vous s√ªr¬∑e de vouloir recommencer ? Toutes vos r√©ponses seront perdues.")) {
        state.currentQuestionIndex = 0;
        state.answers = {};
        state.anamnesis = { age: null, name: '', onsetAge: 'unknown', multiContext: 'unknown', evaluatorType: 'self' };
        document.getElementById('user-age').value = '';
        document.getElementById('user-name').value = '';
        document.getElementById('onset-age').value = 'unknown';
        document.getElementById('multi-context').value = 'unknown';
        document.getElementById('evaluator-type').value = 'self';
        document.getElementById('consent-check').checked = false;
        showScreen('intro');
      }
    }
    
    // ==================== RENDU QUESTION ====================
    
    function renderQuestion() {
      const q = QUESTIONS[state.currentQuestionIndex];
      const dim = DIMENSIONS.find(d => d.key === q.dim);
      
      // Progress
      const progress = ((state.currentQuestionIndex + 1) / QUESTIONS.length) * 100;
      document.getElementById('progress-fill').style.width = progress + '%';
      document.getElementById('progress-text').textContent = Math.round(progress) + '%';
      
      // Dimension badge
      const badge = document.getElementById('current-dimension-badge');
      badge.textContent = dim.label;
      badge.className = 'dimension-badge ' + dim.key;
      
      // Question
      document.getElementById('question-number').textContent = `Question ${state.currentQuestionIndex + 1}/${QUESTIONS.length}`;
      document.getElementById('question-text').textContent = q.text;
      
      // Options
      const optionsContainer = document.getElementById('answer-options');
      optionsContainer.innerHTML = SCALE_OPTIONS.map(opt => `
        <div class="answer-option ${state.answers[q.id] === opt.value ? 'selected' : ''}" onclick="selectAnswer(${opt.value})">
          <input type="radio" name="answer" value="${opt.value}" id="opt-${opt.value}" ${state.answers[q.id] === opt.value ? 'checked' : ''}>
          <label for="opt-${opt.value}" class="answer-label">
            <div class="answer-main">${opt.label}</div>
            <div class="answer-sublabel">${opt.sublabel}</div>
          </label>
        </div>
      `).join('');
      
      // Boutons navigation
      document.getElementById('prev-btn').style.visibility = state.currentQuestionIndex > 0 ? 'visible' : 'hidden';
      document.getElementById('next-btn').disabled = state.answers[q.id] === undefined;
      document.getElementById('next-btn').textContent = state.currentQuestionIndex === QUESTIONS.length - 1 ? 'Voir les R√©sultats' : 'Suivant ‚Üí';
      
      // Questions restantes
      const remaining = QUESTIONS.length - state.currentQuestionIndex - 1;
      document.getElementById('questions-remaining').textContent = remaining > 0 ? `${remaining} question${remaining > 1 ? 's' : ''} restante${remaining > 1 ? 's' : ''}` : 'Derni√®re question';
    }
    
    // ==================== RENDU R√âSULTATS ====================
    
    function renderResults() {
      const scores = calculateScores();
      const resultBand = getResultBand(scores.total, scores.maxTotal);
      
      // Hero Score
      document.getElementById('total-score-display').textContent = scores.total;
      document.getElementById('global-level-badge').textContent = resultBand.level;
      document.getElementById('global-level-badge').className = 'level-badge ' + resultBand.severity;
      document.getElementById('score-message').textContent = resultBand.interpretation;
      
      // Profil Anamnestique
      const profileGrid = document.getElementById('profile-grid');
      profileGrid.innerHTML = `
        <div class="profile-item">
          <div class="profile-label">√Çge</div>
          <div class="profile-value">${state.anamnesis.age || 'Non pr√©cis√©'}</div>
        </div>
        <div class="profile-item">
          <div class="profile-label">Groupe d'√¢ge</div>
          <div class="profile-value">${scores.ageGroup}</div>
        </div>
        <div class="profile-item">
          <div class="profile-label">D√©but sympt√¥mes</div>
          <div class="profile-value">${state.anamnesis.onsetAge === 'yes' ? 'Avant 12 ans' : state.anamnesis.onsetAge === 'no' ? 'Apr√®s 12 ans' : 'Non pr√©cis√©'}</div>
        </div>
        <div class="profile-item">
          <div class="profile-label">Multi-contextes</div>
          <div class="profile-value">${state.anamnesis.multiContext === 'yes' ? 'Oui (‚â•2)' : state.anamnesis.multiContext === 'no' ? 'Non' : 'Non pr√©cis√©'}</div>
        </div>
        <div class="profile-item">
          <div class="profile-label">√âvaluateur</div>
          <div class="profile-value">${getEvaluatorLabel(state.anamnesis.evaluatorType)}</div>
        </div>
      `;
      
      document.getElementById('risk-index-value').textContent = scores.riskIndex;
      
      // Analyse Dimensionnelle
      const dimensionAnalysis = document.getElementById('dimension-analysis');
      dimensionAnalysis.innerHTML = Object.entries(scores.dimensions).map(([key, data]) => {
        const dim = DIMENSIONS.find(d => d.key === key);
        const thresholds = AGE_THRESHOLDS[scores.ageGroup][key];
        const level = getSeverityLevel(data.percentage, thresholds);
        const interpretation = getDimensionInterpretation(key, data.percentage, scores.ageGroup);
        
        return `
          <div class="dimension-card ${key}">
            <div class="dimension-header">
              <span class="dimension-name">${dim.fullLabel}</span>
              <span class="dimension-score-display">${data.percentage}%</span>
            </div>
            <div class="dimension-bar-container">
              <div class="dimension-bar-fill" style="width: ${data.percentage}%"></div>
            </div>
            <p class="dimension-interpretation">${interpretation}</p>
          </div>
        `;
      }).join('');
      
      // Analyse Approfondie du Profil
      const profileAnalysis = generateProfileAnalysis(scores);
      const analysisContainer = document.getElementById('profile-analysis-container');
      analysisContainer.innerHTML = `
        <div style="background: white; border: 2px solid var(--or-signature); border-radius: var(--radius-xl); padding: var(--s-6); margin-bottom: var(--s-6);">
          <h3 style="font-size: var(--fs-lg); color: var(--or-signature); margin-bottom: var(--s-3);">
            ${profileAnalysis.profilePattern}
          </h3>
        </div>
        
        ${profileAnalysis.specificInsights.length > 0 ? `
          <div style="margin-bottom: var(--s-6);">
            <h4 style="font-size: var(--fs-md); font-weight: 600; margin-bottom: var(--s-4); color: var(--noir-absolu);">
              Observations Cliniques
            </h4>
            ${profileAnalysis.specificInsights.map(insight => `
              <div style="margin-bottom: var(--s-4); padding: var(--s-4); background: white; border-left: 3px solid var(--or-signature); border-radius: var(--radius-md);">
                <p style="font-size: var(--fs-sm); line-height: var(--lh-relaxed); margin: 0; text-align: justify;">
                  ${insight}
                </p>
              </div>
            `).join('')}
          </div>
        ` : ''}
        
        ${profileAnalysis.functionalImpact ? `
          <div style="margin-bottom: var(--s-6);">
            <h4 style="font-size: var(--fs-md); font-weight: 600; margin-bottom: var(--s-3); color: var(--noir-absolu);">
              Impact Fonctionnel
            </h4>
            <p style="font-size: var(--fs-sm); line-height: var(--lh-relaxed); text-align: justify; padding: var(--s-4); background: white; border-radius: var(--radius-md);">
              ${profileAnalysis.functionalImpact}
            </p>
          </div>
        ` : ''}
        
        ${profileAnalysis.developmentalConsiderations ? `
          <div style="margin-bottom: var(--s-6);">
            <h4 style="font-size: var(--fs-md); font-weight: 600; margin-bottom: var(--s-3); color: var(--noir-absolu);">
              Consid√©rations D√©veloppementales
            </h4>
            <p style="font-size: var(--fs-sm); line-height: var(--lh-relaxed); text-align: justify; padding: var(--s-4); background: white; border-radius: var(--radius-md);">
              ${profileAnalysis.developmentalConsiderations}
            </p>
          </div>
        ` : ''}
        
        ${profileAnalysis.interactionPatterns ? `
          <div style="margin-bottom: var(--s-6);">
            <h4 style="font-size: var(--fs-md); font-weight: 600; margin-bottom: var(--s-3); color: var(--noir-absolu);">
              Interactions entre Dimensions
            </h4>
            <p style="font-size: var(--fs-sm); line-height: var(--lh-relaxed); text-align: justify; padding: var(--s-4); background: white; border-radius: var(--radius-md);">
              ${profileAnalysis.interactionPatterns}
            </p>
          </div>
        ` : ''}
        
        ${profileAnalysis.dominantDimensions.length > 0 ? `
          <div style="background: #FFFBEB; border: 2px solid #F59E0B; border-radius: var(--radius-lg); padding: var(--s-4);">
            <p style="font-size: var(--fs-sm); font-weight: 600; color: #92400E; margin-bottom: var(--s-2);">
              üìä Dimensions Pr√©dominantes (‚â•60%)
            </p>
            <p style="font-size: var(--fs-sm); color: #78350F; margin: 0;">
              ${profileAnalysis.dominantDimensions.map(d => `<strong>${d.label}</strong> (${d.percentage}%)`).join(' ‚Ä¢ ')}
            </p>
          </div>
        ` : ''}
      `;
      
      // Recommandations
      const recommendationList = document.getElementById('recommendation-list');
      recommendationList.innerHTML = resultBand.recommendations.map(rec => `
        <div class="recommendation-item">
          <p>${rec}</p>
        </div>
      `).join('');
    }
    
    function getEvaluatorLabel(type) {
      const labels = {
        self: 'Auto-√©valuation',
        parent: 'Parent/Tuteur',
        teacher: 'Enseignant',
        partner: 'Conjoint/Proche',
        other: 'Autre'
      };
      return labels[type] || 'Auto-√©valuation';
    }
    
    // ==================== EXPORT PDF ====================
    
    async function generatePDF() {
      const scores = calculateScores();
      const resultBand = getResultBand(scores.total, scores.maxTotal);
      
      const printWindow = window.open('', '', 'width=210mm,height=297mm');
      
      printWindow.document.write(`
        <!DOCTYPE html>
        <html lang="fr">
        <head>
          <meta charset="UTF-8">
          <title>Rapport TDAH ‚Äî ${state.anamnesis.name} ‚Äî NO√âSIS</title>
          <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@400;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
          
          <style>
            @page { size: A4 portrait; margin: 25mm 20mm; }
            * { margin: 0; padding: 0; box-sizing: border-box; }
            body {
              font-family: 'Inter', sans-serif;
              font-size: 10.5pt;
              line-height: 1.6;
              color: #0A0A0A;
              background: #FFFFFF;
            }
            h1, h2, h3 { font-family: 'Fraunces', serif; font-weight: 600; color: #0A0A0A; page-break-after: avoid; }
            h1 { font-size: 22pt; margin-bottom: 8pt; letter-spacing: -0.02em; }
            h2 { font-size: 16pt; margin-top: 24pt; margin-bottom: 12pt; border-bottom: 1.5pt solid #C7A86D; padding-bottom: 6pt; }
            h3 { font-size: 13pt; margin-top: 18pt; margin-bottom: 8pt; color: #C7A86D; }
            p { margin-bottom: 10pt; text-align: justify; hyphens: auto; }
            strong { font-weight: 600; color: #0A0A0A; }
            
            .header {
              text-align: center;
              padding-bottom: 18pt;
              margin-bottom: 24pt;
              border-bottom: 2pt solid #C7A86D;
            }
            .logo { font-family: 'Fraunces', serif; font-size: 28pt; font-weight: 700; letter-spacing: 0.05em; color: #C7A86D; margin-bottom: 6pt; }
            .document-title { font-size: 11pt; font-weight: 500; color: rgba(10,10,10,0.7); text-transform: uppercase; letter-spacing: 0.08em; }
            .metadata { margin-top: 8pt; font-size: 9pt; color: rgba(10,10,10,0.5); }
            
            .section { margin-bottom: 24pt; page-break-inside: avoid; }
            
            .score-container {
              background: linear-gradient(135deg, #F7F5EF 0%, #F9F7F1 100%);
              border: 1.5pt solid #C7A86D;
              border-radius: 8pt;
              padding: 18pt;
              margin-bottom: 18pt;
              text-align: center;
            }
            .score-main { font-family: 'Fraunces', serif; font-size: 48pt; font-weight: 700; color: #C7A86D; line-height: 1; margin-bottom: 6pt; }
            .score-label { font-size: 11pt; font-weight: 500; color: rgba(10,10,10,0.7); margin-bottom: 12pt; }
            .level-badge { display: inline-block; padding: 6pt 16pt; border-radius: 999pt; font-size: 10pt; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }
            .level-badge.minimal { background: #d1fae5; color: #065f46; }
            .level-badge.low { background: #dbeafe; color: #1e40af; }
            .level-badge.moderate { background: #fef3c7; color: #92400e; }
            .level-badge.high { background: #fee2e2; color: #991b1b; }
            .interpretation-text { margin-top: 12pt; font-size: 10pt; line-height: 1.5; text-align: left; color: rgba(10,10,10,0.8); }
            
            .dimension-grid { display: grid; grid-template-columns: 1fr; gap: 12pt; margin-bottom: 18pt; }
            .dimension-card { background: #FAFAFA; border-left: 3pt solid #C7A86D; padding: 12pt; border-radius: 0 4pt 4pt 0; page-break-inside: avoid; }
            .dimension-header { display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 6pt; }
            .dimension-name { font-weight: 600; font-size: 11pt; color: #0A0A0A; }
            .dimension-score { font-family: 'Fraunces', serif; font-size: 12pt; font-weight: 600; color: #C7A86D; }
            .dimension-bar { height: 6pt; background: #E5E5E5; border-radius: 3pt; overflow: hidden; margin-bottom: 8pt; }
            .dimension-bar-fill { height: 100%; background: linear-gradient(90deg, #C7A86D, #D4B980); border-radius: 3pt; }
            .dimension-description { font-size: 9.5pt; line-height: 1.4; color: rgba(10,10,10,0.7); }
            
            .profile-table { width: 100%; border-collapse: collapse; margin: 12pt 0; }
            .profile-table td { padding: 8pt; border-bottom: 0.5pt solid #E5E5E5; vertical-align: top; }
            .profile-table td:first-child { font-weight: 600; width: 40%; }
            
            .recommendation-list { list-style: none; padding-left: 0; counter-reset: rec-counter; }
            .recommendation-item { counter-increment: rec-counter; position: relative; padding-left: 28pt; margin-bottom: 12pt; line-height: 1.5; }
            .recommendation-item:before { content: counter(rec-counter); position: absolute; left: 0; top: 0; width: 20pt; height: 20pt; background: #C7A86D; color: white; border-radius: 50%; font-size: 9pt; font-weight: 600; display: flex; align-items: center; justify-content: center; }
            
            .warning-box { background: #FFFBEB; border: 1pt solid #F59E0B; border-radius: 6pt; padding: 14pt; margin: 18pt 0; }
            .warning-title { font-weight: 600; color: #92400E; margin-bottom: 6pt; font-size: 10.5pt; }
            .warning-text { font-size: 9.5pt; line-height: 1.5; color: #78350F; }
            
            .footer { margin-top: 32pt; padding-top: 18pt; border-top: 1pt solid #E5E5E5; text-align: center; font-size: 8.5pt; color: rgba(10,10,10,0.5); page-break-inside: avoid; }
            .footer-logo { font-family: 'Fraunces', serif; font-weight: 700; font-size: 11pt; color: #C7A86D; margin-bottom: 4pt; }
            
            @media print {
              body { print-color-adjust: exact; -webkit-print-color-adjust: exact; }
              .section { page-break-inside: avoid; }
              h2 { page-break-after: avoid; }
              .dimension-card { page-break-inside: avoid; }
            }
          </style>
        </head>
        <body>
          
          <div class="header">
            <div class="logo">NO√âSIS</div>
            <div class="document-title">Rapport d'√âvaluation TDAH Adaptatif</div>
            <div class="metadata">
              Participant : ${state.anamnesis.name} ‚Ä¢ G√©n√©r√© le ${new Date().toLocaleDateString('fr-FR', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })} √† ${new Date().toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' })}
            </div>
          </div>
          
          <div class="section">
            <div class="score-container">
              <div class="score-main">${scores.total}<span style="font-size: 24pt; color: rgba(10,10,10,0.3);">/${scores.maxTotal}</span></div>
              <div class="score-label">Score Total</div>
              <div class="level-badge ${resultBand.severity}">${resultBand.level}</div>
              <p class="interpretation-text">${resultBand.interpretation}</p>
            </div>
          </div>
          
          <div class="section">
            <h2>Profil & Contexte</h2>
            <table class="profile-table">
              <tr><td>√Çge</td><td>${state.anamnesis.age || 'Non pr√©cis√©'}</td></tr>
              <tr><td>Groupe d'√¢ge</td><td>${scores.ageGroup}</td></tr>
              <tr><td>D√©but des sympt√¥mes</td><td>${state.anamnesis.onsetAge === 'yes' ? 'Avant 12 ans' : state.anamnesis.onsetAge === 'no' ? 'Apr√®s 12 ans' : 'Non pr√©cis√©'}</td></tr>
              <tr><td>Impact multi-contextes</td><td>${state.anamnesis.multiContext === 'yes' ? 'Oui (‚â•2 domaines)' : state.anamnesis.multiContext === 'no' ? 'Non' : 'Non pr√©cis√©'}</td></tr>
              <tr><td>Type d'√©valuateur</td><td>${getEvaluatorLabel(state.anamnesis.evaluatorType)}</td></tr>
              <tr><td>Indice de Risque Composite</td><td><strong>${scores.riskIndex} / 100</strong></td></tr>
            </table>
            <p style="font-size: 9pt; color: rgba(10,10,10,0.6);">
              L'indice de risque composite int√®gre les scores dimensionnels, l'√¢ge de d√©but, les contextes d'impact et la coh√©rence des r√©ponses.
            </p>
          </div>
          
          <div class="section">
            <h2>Analyse par Dimension</h2>
            <div class="dimension-grid">
              ${Object.entries(scores.dimensions).map(([key, data]) => {
                const dim = DIMENSIONS.find(d => d.key === key);
                const interpretation = getDimensionInterpretation(key, data.percentage, scores.ageGroup);
                return `
                  <div class="dimension-card">
                    <div class="dimension-header">
                      <span class="dimension-name">${dim.fullLabel}</span>
                      <span class="dimension-score">${data.score}/${data.maxScore} (${data.percentage}%)</span>
                    </div>
                    <div class="dimension-bar">
                      <div class="dimension-bar-fill" style="width: ${data.percentage}%"></div>
                    </div>
                    <p class="dimension-description">${interpretation}</p>
                  </div>
                `;
              }).join('')}
            </div>
          </div>
          
          <div class="section">
            <h2>Analyse Approfondie du Profil</h2>
            ${(() => {
              const profileAnalysis = generateProfileAnalysis(scores);
              return `
                <div style="background: #F7F5EF; border: 1.5pt solid #C7A86D; border-radius: 8pt; padding: 16pt; margin-bottom: 16pt;">
                  <h3 style="margin-top: 0; font-size: 12pt; color: #C7A86D;">${profileAnalysis.profilePattern}</h3>
                </div>
                
                ${profileAnalysis.specificInsights.length > 0 ? `
                  <div style="margin-bottom: 16pt;">
                    <h3 style="font-size: 11.5pt;">Observations Cliniques</h3>
                    ${profileAnalysis.specificInsights.map(insight => `
                      <p style="margin-bottom: 10pt; padding-left: 12pt; border-left: 2pt solid #C7A86D; text-align: justify;">
                        ${insight}
                      </p>
                    `).join('')}
                  </div>
                ` : ''}
                
                ${profileAnalysis.functionalImpact ? `
                  <div style="margin-bottom: 16pt;">
                    <h3 style="font-size: 11.5pt;">Impact Fonctionnel</h3>
                    <p style="text-align: justify;">${profileAnalysis.functionalImpact}</p>
                  </div>
                ` : ''}
                
                ${profileAnalysis.developmentalConsiderations ? `
                  <div style="margin-bottom: 16pt;">
                    <h3 style="font-size: 11.5pt;">Consid√©rations D√©veloppementales</h3>
                    <p style="text-align: justify;">${profileAnalysis.developmentalConsiderations}</p>
                  </div>
                ` : ''}
                
                ${profileAnalysis.interactionPatterns ? `
                  <div style="margin-bottom: 16pt;">
                    <h3 style="font-size: 11.5pt;">Interactions entre Dimensions</h3>
                    <p style="text-align: justify;">${profileAnalysis.interactionPatterns}</p>
                  </div>
                ` : ''}
                
                ${profileAnalysis.dominantDimensions.length > 0 ? `
                  <div style="background: #FFFBEB; border: 1pt solid #F59E0B; border-radius: 6pt; padding: 12pt; margin-top: 16pt;">
                    <p style="font-size: 10pt; font-weight: 600; color: #92400E; margin-bottom: 6pt;">
                      üìä Dimensions Pr√©dominantes (‚â•60%)
                    </p>
                    <p style="font-size: 9.5pt; color: #78350F; margin-bottom: 0;">
                      ${profileAnalysis.dominantDimensions.map(d => `${d.label} (${d.percentage}%)`).join(' ‚Ä¢ ')}
                    </p>
                  </div>
                ` : ''}
              `;
            })()}
          </div>
          
          <div class="section">
            <h2>D√©tail des R√©ponses</h2>
            <p style="font-size: 9.5pt; color: rgba(10,10,10,0.7); margin-bottom: 14pt;">
              Cette section pr√©sente l'ensemble des questions pos√©es et vos r√©ponses respectives, organis√©es par dimension.
            </p>
            ${DIMENSIONS.map(dim => {
              const questionsForDim = QUESTIONS.filter(q => q.dim === dim.key);
              return `
                <div style="margin-bottom: 20pt; page-break-inside: avoid;">
                  <h3 style="color: ${dim.color}; margin-bottom: 10pt;">${dim.fullLabel}</h3>
                  ${questionsForDim.map((q, idx) => {
                    const answer = state.answers[q.id];
                    const answerLabel = SCALE_OPTIONS.find(opt => opt.value === answer);
                    return `
                      <div style="margin-bottom: 12pt; padding-left: 12pt; border-left: 2pt solid #E5E5E5; page-break-inside: avoid;">
                        <p style="font-size: 10pt; font-weight: 600; margin-bottom: 4pt; color: rgba(10,10,10,0.8);">
                          Question ${QUESTIONS.indexOf(q) + 1} : ${q.text}
                        </p>
                        <p style="font-size: 9.5pt; margin-bottom: 2pt;">
                          <strong style="color: #C7A86D;">R√©ponse :</strong> ${answerLabel ? answerLabel.label : 'Non r√©pondu'}
                          ${answerLabel && answerLabel.sublabel ? `<span style="color: rgba(10,10,10,0.6); font-size: 9pt;"> (${answerLabel.sublabel})</span>` : ''}
                        </p>
                      </div>
                    `;
                  }).join('')}
                </div>
              `;
            }).join('')}
          </div>
          
          <div class="section">
            <h2>Recommandations Personnalis√©es</h2>
            <ol class="recommendation-list">
              ${resultBand.recommendations.map(rec => `<li class="recommendation-item">${rec}</li>`).join('')}
            </ol>
          </div>
          
          <div class="warning-box">
            <div class="warning-title">‚ö† Avertissement Important</div>
            <p class="warning-text">
              Ce questionnaire constitue un outil de sensibilisation et ne remplace en aucun cas une consultation avec un professionnel qualifi√©. Les r√©sultats refl√®tent votre perception subjective et n√©cessitent interpr√©tation contextuelle.
            </p>
            <p class="warning-text" style="margin-top: 8pt;">
              <strong>Ressources France :</strong> HyperSupers TDAH France (www.tdah-france.fr) ‚Ä¢ 3114 (pr√©vention suicide) ‚Ä¢ Fil Sant√© Jeunes 0800 235 236
            </p>
          </div>
          
          <div class="footer">
            <div class="footer-logo">NO√âSIS</div>
            <p>Intelligence transdisciplinaire au service de la lucidit√©</p>
            <p style="margin-top: 8pt;">¬© ${new Date().getFullYear()} NO√âSIS ‚Äî Tous droits r√©serv√©s</p>
            <p style="margin-top: 6pt; font-size: 8pt;">
              Outil de sensibilisation et pr√©-√©valuation ‚Äî Non valid√© psychom√©triquement<br>
              Ne remplace pas une consultation avec un professionnel qualifi√©<br>
              Confidentialit√© : aucune donn√©e collect√©e sans action explicite
            </p>
          </div>
          
        </body>
        </html>
      `);
      
      printWindow.document.close();
      
      setTimeout(() => {
        printWindow.print();
      }, 800);
    }
    
    // ==================== EXPORT EMAIL ====================
    
    function sendResultsByEmail() {
      const scores = calculateScores();
      const resultBand = getResultBand(scores.total, scores.maxTotal);
      
      const emailBody = `
Rapport NO√âSIS ‚Äî Autotest TDAH Adaptatif
Participant : ${state.anamnesis.name}
G√©n√©r√© le ${new Date().toLocaleDateString('fr-FR')}

SCORE TOTAL : ${scores.total}/${scores.maxTotal} (${Math.round((scores.total/scores.maxTotal)*100)}%)
NIVEAU : ${resultBand.level}
INDICE DE RISQUE COMPOSITE : ${scores.riskIndex} / 100

ANALYSE DIMENSIONNELLE :
${Object.entries(scores.dimensions).map(([key, data]) => {
  const dim = DIMENSIONS.find(d => d.key === key);
  return `‚Ä¢ ${dim.fullLabel} : ${data.percentage}%`;
}).join('\n')}

PROFIL :
‚Ä¢ √Çge : ${state.anamnesis.age || 'Non pr√©cis√©'}
‚Ä¢ Groupe d'√¢ge : ${scores.ageGroup}
‚Ä¢ D√©but sympt√¥mes : ${state.anamnesis.onsetAge === 'yes' ? 'Avant 12 ans' : state.anamnesis.onsetAge === 'no' ? 'Apr√®s 12 ans' : 'Non pr√©cis√©'}
‚Ä¢ Multi-contextes : ${state.anamnesis.multiContext === 'yes' ? 'Oui (‚â•2)' : state.anamnesis.multiContext === 'no' ? 'Non' : 'Non pr√©cis√©'}
‚Ä¢ √âvaluateur : ${getEvaluatorLabel(state.anamnesis.evaluatorType)}

Pour consulter le rapport complet avec analyses approfondies et recommandations personnalis√©es, veuillez t√©l√©charger la version PDF depuis l'interface NO√âSIS.

---
NO√âSIS ‚Äî Intelligence transdisciplinaire
¬© ${new Date().getFullYear()} ‚Äî Tous droits r√©serv√©s
      `.trim();
      
      const subject = `Rapport TDAH Adaptatif ‚Äî ${state.anamnesis.name} ‚Äî NO√âSIS`;
      const mailtoLink = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(emailBody)}`;
      
      window.location.href = mailtoLink;
    }
    
    // ==================== EXPORT JSON ====================
    
    function downloadJSON() {
      const scores = calculateScores();
      const resultBand = getResultBand(scores.total, scores.maxTotal);
      
      const data = {
        metadata: {
          test: "Autotest TDAH Adaptatif",
          version: "1.0 - NO√âSIS",
          theoreticalFramework: "DSM-5-TR",
          date: new Date().toISOString(),
          participant: state.anamnesis.name
        },
        anamnesis: {
          age: state.anamnesis.age,
          ageGroup: scores.ageGroup,
          onsetAge: state.anamnesis.onsetAge,
          multiContext: state.anamnesis.multiContext,
          evaluatorType: state.anamnesis.evaluatorType
        },
        responses: {
          answers: state.answers,
          completion: `${Object.keys(state.answers).length}/${QUESTIONS.length}`
        },
        scoring: {
          total: scores.total,
          maxTotal: scores.maxTotal,
          percentage: Math.round((scores.total/scores.maxTotal)*100),
          riskIndex: scores.riskIndex,
          dimensions: scores.dimensions,
          resultBand: {
            level: resultBand.level,
            severity: resultBand.severity,
            interpretation: resultBand.interpretation
          }
        },
        detailedResponses: QUESTIONS.map(q => ({
          id: q.id,
          dimension: q.dim,
          text: q.text,
          response: {
            value: state.answers[q.id],
            label: SCALE_OPTIONS.find(opt => opt.value === state.answers[q.id])?.label,
            sublabel: SCALE_OPTIONS.find(opt => opt.value === state.answers[q.id])?.sublabel
          }
        }))
      };
      
      const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json;charset=utf-8' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `noesis-tdah-${Date.now()}.json`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }
    
    // ==================== EVENT LISTENERS ====================
    
    document.addEventListener('DOMContentLoaded', () => {
      // Consentement
      document.getElementById('consent-check').addEventListener('change', (e) => {
        document.getElementById('start-btn').disabled = !e.target.checked;
      });
      
      // Boutons
      document.getElementById('start-btn').addEventListener('click', startTest);
      document.getElementById('next-btn').addEventListener('click', nextQuestion);
      document.getElementById('prev-btn').addEventListener('click', prevQuestion);
      document.getElementById('pdf-btn').addEventListener('click', generatePDF);
      document.getElementById('email-btn').addEventListener('click', sendResultsByEmail);
      document.getElementById('json-btn').addEventListener('click', downloadJSON);
      document.getElementById('reset-btn').addEventListener('click', resetTest);
    });
    
    // Rendre selectAnswer accessible globalement
    window.selectAnswer = selectAnswer;
  </script>
  
</body>
</html>