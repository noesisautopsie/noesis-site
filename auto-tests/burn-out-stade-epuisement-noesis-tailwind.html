<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- SEO -->
  <title>Burn-out : Stade d'Épuisement — Auto-test NOÉSIS</title>
  <meta name="description" content="Grille d'évaluation clinique (45 items) du burn-out professionnel basée sur le modèle MBI : épuisement émotionnel, dépersonnalisation/cynisme et accomplissement personnel.">
  
  <!-- Open Graph -->
  <meta property="og:title" content="Burn-out : Stade d'Épuisement — NOÉSIS">
  <meta property="og:description" content="Test clinique 45 questions basé sur MBI. Évaluation épuisement professionnel.">
  <meta property="og:type" content="website">
  
  <!-- Tailwind CSS via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- React + ReactDOM via CDN -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  
  <!-- Babel Standalone pour JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  
  <style>
    /* Styles d'impression PDF optimisés A4 */
    @media print {
      .no-print { display: none !important; }
      .print-only { display: block !important; }
      
      body { 
        background: white !important;
        margin: 0;
        padding: 0;
      }
      
      @page {
        size: A4;
        margin: 12mm 15mm;
      }
      
      .print-container {
        max-width: 100%;
        padding: 0 !important;
        margin: 0 !important;
      }
      
      .print-section {
        padding: 8px 0 !important;
        margin-bottom: 12px !important;
      }
      
      .print-header {
        font-size: 18px !important;
        margin-bottom: 8px !important;
        padding-bottom: 4px !important;
        border-bottom: 2px solid #334155;
      }
      
      .print-subheader {
        font-size: 14px !important;
        margin: 8px 0 4px 0 !important;
      }
      
      .print-text {
        font-size: 11px !important;
        line-height: 1.4 !important;
        margin: 2px 0 !important;
      }
      
      .print-question {
        font-size: 11px !important;
        padding: 3px 0 !important;
        page-break-inside: avoid;
      }
      
      .print-axis-section {
        page-break-inside: avoid;
        margin-bottom: 10px !important;
      }
      
      .print-score-box {
        padding: 6px !important;
        margin: 4px 0 !important;
        border: 1px solid #e2e8f0;
        border-radius: 4px;
      }
      
      .print-reco {
        font-size: 11px !important;
        padding: 2px 0 2px 16px !important;
        margin: 2px 0 !important;
      }
    }
    
    .print-only {
      display: none;
    }
  </style>
</head>
<body class="m-0 p-0">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useMemo, useCallback } = React;

    // ============================================================
    // CONFIGURATION
    // ============================================================

    const DIMENSIONS = [
      { 
        key: "ee", 
        label: "Épuisement émotionnel", 
        color: "rose",
        description: "Vidage des ressources, fatigue chronique, irritabilité"
      },
      { 
        key: "dp", 
        label: "Dépersonnalisation / Cynisme", 
        color: "fuchsia",
        description: "Distance émotionnelle, froideur, désengagement"
      },
      { 
        key: "pa", 
        label: "Accomplissement personnel", 
        color: "emerald",
        description: "Sentiment d'efficacité, sens du travail, progression"
      }
    ];

    const CHOICES = [
      { value: 0, label: "Jamais", anchor: "0 fois / 6 mois" },
      { value: 1, label: "Parfois", anchor: "1-3× / mois" },
      { value: 2, label: "Souvent", anchor: "1-3× / semaine" },
      { value: 3, label: "Très souvent", anchor: "Quasi quotidien" }
    ];

    const QUESTIONS = [
      // Épuisement émotionnel (15)
      {id:"Q1", dim:"ee", text:"Je me sens vidé·e émotionnellement par mon travail."},
      {id:"Q2", dim:"ee", text:"Je me réveille déjà fatigué·e à l'idée de ma journée."},
      {id:"Q3", dim:"ee", text:"Mon énergie chute fortement avant la fin de la journée."},
      {id:"Q4", dim:"ee", text:"Je n'arrive pas à 'débrancher' après le travail."},
      {id:"Q5", dim:"ee", text:"Je dors mal à cause de ruminations professionnelles."},
      {id:"Q6", dim:"ee", text:"Je ressens des tensions physiques (dos, ventre, migraines)."},
      {id:"Q7", dim:"ee", text:"Je fais plus d'erreurs par surcharge ou distraction."},
      {id:"Q8", dim:"ee", text:"Je manque de patience pour des tâches habituelles."},
      {id:"Q9", dim:"ee", text:"Je me sens à la limite de mes capacités la plupart du temps."},
      {id:"Q10", dim:"ee", text:"J'ai besoin d'urgences pour rester mobilisé·e."},
      {id:"Q11", dim:"ee", text:"Je reporte des tâches simples faute d'énergie mentale."},
      {id:"Q12", dim:"ee", text:"Je tombe plus souvent malade ou épuisé·e qu'avant."},
      {id:"Q13", dim:"ee", text:"Je me sens à fleur de peau et irritable au travail."},
      {id:"Q14", dim:"ee", text:"Je me surprends à pleurer ou à me renfermer après le travail."},
      {id:"Q15", dim:"ee", text:"Je n'arrive plus à récupérer même après un week-end."},
      
      // Dépersonnalisation / Cynisme (15)
      {id:"Q16", dim:"dp", text:"Je deviens sarcastique ou amer·e envers collègues/usagers."},
      {id:"Q17", dim:"dp", text:"Je me coupe émotionnellement pour 'tenir'."},
      {id:"Q18", dim:"dp", text:"Je parle des gens comme de dossiers ou de chiffres."},
      {id:"Q19", dim:"dp", text:"Je me sens détaché·e de la finalité de mon travail."},
      {id:"Q20", dim:"dp", text:"Je réponds en pilote automatique, sans réelle présence."},
      {id:"Q21", dim:"dp", text:"Je nourris des pensées cyniques sur mon organisation."},
      {id:"Q22", dim:"dp", text:"Je me protège en évitant les interactions quand c'est possible."},
      {id:"Q23", dim:"dp", text:"Je ressens une froideur qui ne me ressemble pas."},
      {id:"Q24", dim:"dp", text:"Je minimise la souffrance ou les besoins des autres."},
      {id:"Q25", dim:"dp", text:"Je redoute le contact avec le public/patients/clients."},
      {id:"Q26", dim:"dp", text:"Je n'ai plus envie d'aider ou de m'impliquer."},
      {id:"Q27", dim:"dp", text:"Je m'isole pendant les pauses pour ne pas parler."},
      {id:"Q28", dim:"dp", text:"Je rejette les nouveautés par réflexe ('à quoi bon')."},
      {id:"Q29", dim:"dp", text:"Je me sens indifférent·e aux réussites de l'équipe."},
      {id:"Q30", dim:"dp", text:"Je me surprends à déshumaniser certaines situations."},
      
      // Accomplissement personnel (protecteur) (15)
      {id:"Q31", dim:"pa", text:"Je vois l'impact utile de mon travail pour autrui."},
      {id:"Q32", dim:"pa", text:"J'éprouve de la fierté pour des tâches bien réalisées."},
      {id:"Q33", dim:"pa", text:"Je me sens compétent·e sur mes missions clés."},
      {id:"Q34", dim:"pa", text:"Je peux apprendre/progresser régulièrement."},
      {id:"Q35", dim:"pa", text:"Je reçois des retours constructifs et exploitables."},
      {id:"Q36", dim:"pa", text:"Je peux organiser mon travail avec une certaine autonomie."},
      {id:"Q37", dim:"pa", text:"Je collabore avec des personnes soutenantes."},
      {id:"Q38", dim:"pa", text:"Je parviens à équilibrer exigences et récupération."},
      {id:"Q39", dim:"pa", text:"Je sens que mes valeurs sont globalement respectées."},
      {id:"Q40", dim:"pa", text:"Je parviens à dire non et à prioriser."},
      {id:"Q41", dim:"pa", text:"Je retrouve du sens dans au moins une partie de mon activité."},
      {id:"Q42", dim:"pa", text:"Je me sens soutenu·e par mon/ma manager quand c'est nécessaire."},
      {id:"Q43", dim:"pa", text:"Je progresse malgré les difficultés récentes."},
      {id:"Q44", dim:"pa", text:"J'arrive à terminer mes journées sans me sentir vidé·e."},
      {id:"Q45", dim:"pa", text:"Je peux me projeter sereinement à court terme."}
    ];

    // ============================================================
    // FONCTIONS DE SCORING
    // ============================================================

    function scoreBands(total) {
      if (total <= 45) {
        return {
          band: "Risque faible",
          color: "green",
          severity: "none",
          message: "Les scores révèlent une fatigue professionnelle gérable. Vous maintenez un équilibre global entre ressources et exigences. Les symptômes d'épuisement restent limités et la capacité de récupération est préservée.",
          recommendations: [
            "Poursuivre les pratiques actuelles de régulation (sommeil, pauses, limites).",
            "Maintenir une vigilance sur la charge de travail et anticiper les pics d'activité.",
            "Cultiver les espaces de récupération (activités hors travail, relations sociales stables).",
            "Documenter factuellement les missions et objectifs pour éviter la dérive de charge."
          ]
        };
      }
      
      if (total <= 75) {
        return {
          band: "Vigilance nécessaire",
          color: "yellow",
          severity: "low",
          message: "Vos résultats témoignent de signes de surmenage émergents. L'équilibre effort-récupération commence à se fragiliser. Les symptômes d'épuisement sont présents mais réversibles avec des ajustements rapides.",
          recommendations: [
            "Ajuster la charge de travail : négocier priorités, délais et critères de réussite réalistes.",
            "Restaurer le sommeil prioritairement (rituels, lumière, réduction écrans, activité physique douce).",
            "Solliciter un soutien managérial pour clarifier les attentes et alléger temporairement.",
            "Intégrer des micro-pauses régulières et des pratiques de régulation (respiration, mouvement, nature).",
            "Consulter le médecin du travail pour évaluation et aménagements si nécessaire."
          ]
        };
      }
      
      if (total <= 100) {
        return {
          band: "Épuisement modéré",
          color: "orange",
          severity: "moderate",
          message: "Plusieurs symptômes d'épuisement professionnel convergent. La fatigue est chronique, la distance émotionnelle s'installe et le sens du travail s'érode. L'état actuel nécessite des actions correctives immédiates pour éviter l'aggravation.",
          recommendations: [
            "PRIORITÉ : Consulter le médecin du travail ou médecin traitant pour évaluation clinique et arrêt de travail si nécessaire.",
            "Mettre en place un plan d'allégement : réduction temporaire de charge, délégation, report de projets non urgents.",
            "Restaurer les fondamentaux physiologiques : sommeil, alimentation stable, activité physique douce quotidienne.",
            "Intégrer un accompagnement psychologique spécialisé (TCC/ACT, gestion du stress, régulation émotionnelle).",
            "Documenter factuellement la surcharge et les impacts (pour médecine du travail, CHSCT, inspection).",
            "Activer les ressources de soutien : proches, collègues de confiance, médecin traitant."
          ]
        };
      }
      
      if (total <= 120) {
        return {
          band: "Burn-out probable",
          color: "red",
          severity: "high",
          message: "Vos scores témoignent d'un épuisement professionnel sévère compatible avec un burn-out constitué. L'épuisement émotionnel est majeur, la dépersonnalisation installée et le sentiment d'efficacité effondré. L'état actuel compromet votre santé et nécessite une prise en charge médicale urgente.",
          recommendations: [
            "URGENCE : Consulter immédiatement médecin traitant ou médecin du travail pour arrêt de travail et évaluation psychiatrique si nécessaire.",
            "Arrêt de travail prolongé indispensable pour permettre la récupération physiologique et psychologique.",
            "Accompagnement pluridisciplinaire : psychiatre (diagnostic, médication si pertinent), psychologue spécialisé burn-out, médecin traitant (suivi somatique).",
            "Restauration prioritaire des rythmes biologiques : sommeil, alimentation, lumière naturelle, mouvement doux quotidien.",
            "Protocole de régulation intensive : cohérence cardiaque, relaxation, mindfulness, thérapie cognitive.",
            "Analyse ergonomique et organisationnelle du poste avec médecine du travail pour identifier les facteurs de risque.",
            "Contact avec inspection du travail ou CHSCT si conditions de travail manifestement dégradées.",
            "Soutien social stable : informer proches de confiance, éviter isolement."
          ]
        };
      }
      
      return {
        band: "Burn-out sévère",
        color: "red",
        severity: "critical",
        message: "Vos résultats révèlent un épuisement professionnel critique. L'état d'effondrement atteint une intensité alarmante sur l'ensemble des dimensions : épuisement total des ressources, cynisme généralisé, perte complète du sens. Vous êtes en situation d'urgence médicale.",
        recommendations: [
          "URGENCE MÉDICALE : Consulter immédiatement médecin traitant, urgences psychiatriques ou appeler le 3114 (prévention du suicide).",
          "Arrêt de travail prolongé obligatoire (plusieurs semaines à plusieurs mois selon évaluation médicale).",
          "Prise en charge psychiatrique spécialisée : diagnostic différentiel (dépression sévère, PTSD, troubles anxieux), traitement médicamenteux si nécessaire.",
          "Accompagnement psychothérapeutique intensif : TCC, thérapie d'acceptation et d'engagement, EMDR si trauma.",
          "Hospitalisation de jour ou soins ambulatoires si décompensation sévère (idées suicidaires, dissociation, incapacité fonctionnelle majeure).",
          "Restauration physiologique prioritaire sous supervision médicale : sommeil, nutrition, hydratation, activité physique adaptée.",
          "Soutien social renforcé : informer famille/proches, éviter isolement absolu, groupe de parole burn-out.",
          "Déclaration en maladie professionnelle (si critères remplis) avec médecine du travail et CPAM.",
          "Protection juridique si harcèlement ou conditions de travail délétères avérées (inspection du travail, avocat droit du travail)."
        ]
      };
    }

    function getAxisAnalysis(dimScores) {
      const sorted = Object.entries(dimScores)
        .map(([key, score]) => ({ key, score, dim: DIMENSIONS.find(d => d.key === key) }))
        .sort((a, b) => b.score - a.score);
      
      const dominant = sorted[0];
      
      const analyses = {
        ee: "L'épuisement émotionnel est votre dimension dominante. Vous êtes probablement en déficit chronique d'énergie, avec des manifestations somatiques (troubles du sommeil, tensions physiques) et une irritabilité inhabituelle. La capacité de récupération est compromise.",
        dp: "La dépersonnalisation/cynisme domine votre profil. Vous vous protégez par la distance émotionnelle et le détachement, ce qui peut créer une froideur relationnelle inhabituelle. Ce mécanisme de défense témoigne d'une surcharge émotionnelle chronique.",
        pa: "Votre accomplissement personnel reste votre point fort. Malgré les difficultés, vous préservez un sentiment d'efficacité et de sens au travail. Cette dimension protectrice est essentielle pour maintenir votre résilience face aux exigences professionnelles."
      };
      
      return {
        dominant: dominant.key,
        analysis: analyses[dominant.key]
      };
    }

    // ============================================================
    // COMPOSANT PRINCIPAL
    // ============================================================

    function BurnoutTest() {
      const [page, setPage] = useState("intro");
      const [currentQ, setCurrentQ] = useState(0);
      const [answers, setAnswers] = useState({});
      const [email, setEmail] = useState("");

      // SUPPRESSION TOTALE localStorage — Test toujours vierge

      const allAnswered = Object.keys(answers).length === QUESTIONS.length;

      const handleAnswer = useCallback((qId, value) => {
        setAnswers(prev => ({ ...prev, [qId]: value }));
        
        if (currentQ < QUESTIONS.length - 1) {
          setTimeout(() => setCurrentQ(c => c + 1), 150);
        }
      }, [currentQ]);

      const goToResults = useCallback(() => {
        if (!allAnswered) {
          alert(`Il reste ${QUESTIONS.length - Object.keys(answers).length} question(s) sans réponse.`);
          return;
        }
        setPage("results");
      }, [allAnswered, answers]);

      const reset = useCallback(() => {
        setAnswers({});
        setCurrentQ(0);
        setPage("intro");
        setEmail("");
      }, []);

      const dimensionScores = useMemo(() => {
        const scores = {};
        DIMENSIONS.forEach(dim => {
          const qs = QUESTIONS.filter(q => q.dim === dim.key);
          const total = qs.reduce((sum, q) => sum + (answers[q.id] || 0), 0);
          scores[dim.key] = total;
        });
        return scores;
      }, [answers]);

      const totalScore = useMemo(() => {
        return Object.values(dimensionScores).reduce((a, b) => a + b, 0);
      }, [dimensionScores]);

      const resultBand = useMemo(() => scoreBands(totalScore), [totalScore]);
      const profileAnalysis = useMemo(() => getAxisAnalysis(dimensionScores), [dimensionScores]);

      const handlePDF = useCallback(() => {
        window.print();
      }, []);

      const handleDownloadJSON = useCallback(() => {
        const data = {
          test: "Burn-out : Stade d'Épuisement",
          date: new Date().toISOString(),
          totalScore,
          resultBand: resultBand.band,
          dimensionScores,
          answers: QUESTIONS.map(q => ({
            id: q.id,
            dimension: q.dim,
            question: q.text,
            answer: CHOICES.find(c => c.value === answers[q.id])?.label || "Non répondu"
          }))
        };
        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `noesis-burnout-${new Date().toISOString().split('T')[0]}.json`;
        a.click();
        URL.revokeObjectURL(url);
      }, [totalScore, resultBand, dimensionScores, answers]);

      const handleEmail = useCallback(() => {
        if (!email) return;
        const subject = encodeURIComponent("Résultats Auto-test Burn-out");
        const body = encodeURIComponent(
          `Bonjour,\n\nVoici mes résultats au test Burn-out NOÉSIS :\n\n` +
          `Score total : ${totalScore}/135\n` +
          `Profil : ${resultBand.band}\n\n` +
          `Scores par dimension :\n` +
          DIMENSIONS.map(d => `- ${d.label} : ${dimensionScores[d.key]}`).join('\n') +
          `\n\nPour consulter le détail complet, merci de télécharger le PDF ou JSON depuis le site.`
        );
        window.location.href = `mailto:${email}?subject=${subject}&body=${body}`;
      }, [email, totalScore, resultBand, dimensionScores]);

      const progress = useMemo(() => Math.round((currentQ / QUESTIONS.length) * 100), [currentQ]);

      // ============================================================
      // PAGE INTRO
      // ============================================================
      
      if (page === "intro") {
        return (
          <div className="min-h-screen bg-gradient-to-br from-slate-50 via-indigo-50 to-purple-50 p-4 md:p-8">
            <div className="max-w-3xl mx-auto">
              <div className="text-center mb-8">
                <div className="inline-block p-4 bg-indigo-100 rounded-2xl mb-4">
                  <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5" className="text-indigo-600">
                    <path d="M9.5 2c-1.82 0-3.53.5-5 1.36C2.68 4.72 1.5 6.73 1.5 9c0 1.56.52 3 1.39 4.14.87 1.14 2.07 2 3.43 2.36"/>
                    <path d="M14.5 2c1.82 0 3.53.5 5 1.36C21.32 4.72 22.5 6.73 22.5 9c0 1.56-.52 3-1.39 4.14-.87 1.14-2.07 2-3.43 2.36"/>
                    <path d="M12 2v20"/>
                    <path d="M9.5 15.5c0 1.38.62 2.5 1.5 2.5"/>
                    <path d="M14.5 15.5c0 1.38-.62 2.5-1.5 2.5"/>
                    <circle cx="9" cy="9" r="1" fill="currentColor"/>
                    <circle cx="15" cy="9" r="1" fill="currentColor"/>
                  </svg>
                </div>
                <h1 className="text-4xl md:text-5xl font-black text-slate-900 mb-3">
                  Burn-out : Stade d'Épuisement
                </h1>
                <p className="text-lg text-slate-600 font-medium">
                  Grille d'évaluation clinique — Modèle MBI
                </p>
              </div>

              <div className="bg-white rounded-2xl shadow-2xl p-6 md:p-8 mb-6">
                <div className="bg-amber-50 border-l-4 border-amber-500 p-4 mb-6 rounded-r-lg">
                  <div className="flex gap-3">
                    <span className="text-2xl flex-shrink-0">⚠️</span>
                    <div className="text-sm text-amber-900">
                      <p className="font-bold mb-1">Avertissement méthodologique</p>
                      <p className="leading-relaxed">
                        Cet auto-test de 45 items <strong>ne remplace pas un diagnostic médical</strong>. 
                        Il s'agit d'une grille d'évaluation basée sur le modèle MBI (Maslach Burnout Inventory) pour identifier les symptômes d'épuisement professionnel. 
                        En cas de scores élevés, une consultation médicale est indispensable.
                      </p>
                    </div>
                  </div>
                </div>

                <div className="mb-8">
                  <div className="flex items-center gap-2 mb-4">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5" className="text-slate-700">
                      <circle cx="11" cy="11" r="8"/>
                      <path d="m21 21-4.35-4.35"/>
                      <circle cx="11" cy="11" r="3"/>
                    </svg>
                    <h2 className="text-xl font-bold text-slate-900">Méthodologie</h2>
                  </div>
                  <div className="grid grid-cols-1 md:grid-cols-3 gap-3 mb-6">
                    <div className="bg-rose-50 text-rose-700 px-3 py-2 rounded-lg text-center text-sm font-semibold">
                      Épuisement émotionnel
                    </div>
                    <div className="bg-fuchsia-50 text-fuchsia-700 px-3 py-2 rounded-lg text-center text-sm font-semibold">
                      Dépersonnalisation
                    </div>
                    <div className="bg-emerald-50 text-emerald-700 px-3 py-2 rounded-lg text-center text-sm font-semibold">
                      Accomplissement
                    </div>
                  </div>

                  <div className="prose prose-sm text-slate-700 space-y-3">
                    <p className="leading-relaxed">
                      Ce test évalue <strong>trois dimensions du burn-out professionnel</strong> selon le modèle MBI : 
                      l'épuisement émotionnel (vidage des ressources), la dépersonnalisation/cynisme (distance émotionnelle) et l'accomplissement personnel (sentiment d'efficacité). 
                      Évaluation sur les <strong>6 derniers mois</strong>.
                    </p>
                  </div>
                </div>

                <div className="grid md:grid-cols-3 gap-4 mb-8">
                  <div className="bg-slate-50 p-4 rounded-xl text-center">
                    <div className="flex justify-center mb-2">
                      <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5" className="text-indigo-600">
                        <circle cx="12" cy="13" r="9"/>
                        <polyline points="12 7 12 13 15 15"/>
                        <path d="M10 2h4"/>
                      </svg>
                    </div>
                    <div className="text-2xl font-bold text-slate-900">14-18 min</div>
                    <div className="text-sm text-slate-600">Durée estimée</div>
                  </div>
                  <div className="bg-slate-50 p-4 rounded-xl text-center">
                    <div className="flex justify-center mb-2">
                      <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5" className="text-indigo-600">
                        <line x1="18" y1="20" x2="18" y2="10"/>
                        <line x1="12" y1="20" x2="12" y2="4"/>
                        <line x1="6" y1="20" x2="6" y2="14"/>
                      </svg>
                    </div>
                    <div className="text-2xl font-bold text-slate-900">45 questions</div>
                    <div className="text-sm text-slate-600">Questionnaire MBI</div>
                  </div>
                  <div className="bg-slate-50 p-4 rounded-xl text-center">
                    <div className="flex justify-center mb-2">
                      <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5" className="text-indigo-600">
                        <path d="M3 3v18h18"/>
                        <path d="M18 9l-5 5-4-4-4 4"/>
                        <circle cx="18" cy="9" r="2" fill="currentColor"/>
                        <circle cx="13" cy="14" r="2" fill="currentColor"/>
                        <circle cx="9" cy="10" r="2" fill="currentColor"/>
                        <circle cx="5" cy="14" r="2" fill="currentColor"/>
                      </svg>
                    </div>
                    <div className="text-2xl font-bold text-slate-900">3 dimensions</div>
                    <div className="text-sm text-slate-600">Analyse multi-axes</div>
                  </div>
                </div>

                <button
                  onClick={() => setPage("test")}
                  className="w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white text-lg font-bold py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-xl"
                >
                  Commencer le test →
                </button>
              </div>

              <div className="text-center text-xs text-slate-500 space-y-1">
                <p className="font-semibold">NOÉSIS — Burn-out Épuisement v1.0 • © 2025</p>
                <p>Confidentialité : aucune donnée collectée sans action explicite (RGPD)</p>
              </div>
            </div>
          </div>
        );
      }

      // ============================================================
      // PAGE TEST
      // ============================================================

      if (page === "test") {
        const q = QUESTIONS[currentQ];
        const dimInfo = DIMENSIONS.find(d => d.key === q.dim);
        const colorMap = {
          rose: { bg: "bg-rose-50", border: "border-rose-300", text: "text-rose-700", badge: "bg-rose-100 text-rose-700" },
          fuchsia: { bg: "bg-fuchsia-50", border: "border-fuchsia-300", text: "text-fuchsia-700", badge: "bg-fuchsia-100 text-fuchsia-700" },
          emerald: { bg: "bg-emerald-50", border: "border-emerald-300", text: "text-emerald-700", badge: "bg-emerald-100 text-emerald-700" },
        };
        const colors = colorMap[dimInfo.color];

        return (
          <div className="min-h-screen bg-gradient-to-br from-slate-50 via-indigo-50 to-purple-50 p-4 md:p-8">
            <div className="max-w-3xl mx-auto">
              
              <div className="mb-6">
                <div className="flex justify-between items-center mb-2">
                  <span className="text-sm font-medium text-slate-600">
                    Question {currentQ + 1} / {QUESTIONS.length}
                  </span>
                  <span className="text-sm font-bold text-indigo-600">{progress}%</span>
                </div>
                <div className="w-full bg-slate-200 rounded-full h-3 overflow-hidden">
                  <div 
                    className="h-full bg-gradient-to-r from-indigo-500 to-purple-500 transition-all duration-300"
                    style={{ width: `${progress}%` }}
                  />
                </div>
              </div>

              <div className="bg-white rounded-2xl shadow-2xl p-6 md:p-8 mb-6">
                <div className="flex items-center gap-3 mb-6">
                  <div className={`w-12 h-12 rounded-full ${colors.bg} ${colors.border} border-2 flex items-center justify-center font-bold ${colors.text} text-lg`}>
                    {currentQ + 1}
                  </div>
                  <span className={`px-3 py-1 rounded-full text-xs font-semibold ${colors.badge}`}>
                    {dimInfo.label}
                  </span>
                </div>

                <h2 className="text-xl md:text-2xl font-bold text-slate-900 mb-8 leading-relaxed">
                  {q.text}
                </h2>

                <div className="space-y-3">
                  {CHOICES.map(choice => {
                    const isSelected = answers[q.id] === choice.value;
                    return (
                      <button
                        key={choice.value}
                        onClick={() => handleAnswer(q.id, choice.value)}
                        className={`w-full text-left p-4 rounded-xl border-2 transition-all ${
                          isSelected
                            ? 'bg-indigo-50 border-indigo-500 shadow-lg'
                            : 'bg-white border-slate-200 hover:border-indigo-300 hover:bg-slate-50'
                        }`}
                      >
                        <div className="flex items-center justify-between">
                          <div>
                            <div className={`font-semibold mb-1 ${isSelected ? 'text-indigo-700' : 'text-slate-900'}`}>
                              {choice.label}
                            </div>
                            <div className="text-xs text-slate-500">{choice.anchor}</div>
                          </div>
                          <div className={`w-6 h-6 rounded-full border-2 flex items-center justify-center ${
                            isSelected ? 'bg-indigo-500 border-indigo-500' : 'border-slate-300'
                          }`}>
                            {isSelected && <span className="text-white text-xs font-bold">✓</span>}
                          </div>
                        </div>
                      </button>
                    );
                  })}
                </div>
              </div>

              <div className="flex gap-4">
                <button
                  onClick={() => setCurrentQ(c => Math.max(0, c - 1))}
                  disabled={currentQ === 0}
                  className="flex-1 bg-slate-200 hover:bg-slate-300 disabled:bg-slate-100 disabled:text-slate-400 text-slate-700 font-semibold py-3 px-6 rounded-xl transition"
                >
                  ← Précédent
                </button>
                
                {currentQ === QUESTIONS.length - 1 ? (
                  <button
                    onClick={goToResults}
                    disabled={!allAnswered}
                    className="flex-1 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 disabled:from-slate-300 disabled:to-slate-300 text-white font-bold py-3 px-6 rounded-xl transition-all shadow-lg"
                  >
                    Voir les résultats →
                  </button>
                ) : (
                  <button
                    onClick={() => setCurrentQ(c => Math.min(QUESTIONS.length - 1, c + 1))}
                    className="flex-1 bg-slate-700 hover:bg-slate-800 text-white font-semibold py-3 px-6 rounded-xl transition"
                  >
                    Suivant →
                  </button>
                )}
              </div>

              <div className="mt-4 text-center">
                <button
                  onClick={goToResults}
                  disabled={!allAnswered}
                  className="text-sm text-slate-500 hover:text-slate-700 underline disabled:text-slate-300"
                >
                  {allAnswered ? "Aller directement aux résultats" : `${QUESTIONS.length - Object.keys(answers).length} question(s) restante(s)`}
                </button>
              </div>
            </div>
          </div>
        );
      }

      // ============================================================
      // PAGE RÉSULTATS + SECTION IMPRIMABLE
      // ============================================================

      return (
        <div className="min-h-screen bg-gradient-to-br from-slate-50 via-indigo-50 to-purple-50 p-4 md:p-8">
          <div className="max-w-5xl mx-auto">
            
            {/* SECTION ÉCRAN */}
            <div className="no-print">
              <div className="text-center mb-8">
                <div className="inline-block p-4 bg-gradient-to-br from-indigo-100 to-purple-100 rounded-2xl mb-4">
                  <svg width="56" height="56" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5" className="text-indigo-600">
                    <path d="M3 3v18h18"/>
                    <path d="M18 9l-5 5-4-4-4 4"/>
                    <circle cx="18" cy="9" r="2"/>
                    <circle cx="13" cy="14" r="2"/>
                    <circle cx="9" cy="10" r="2"/>
                    <circle cx="5" cy="14" r="2"/>
                  </svg>
                </div>
                <h1 className="text-4xl md:text-5xl font-black text-slate-900 mb-3">
                  Tes résultats
                </h1>
                <p className="text-lg text-slate-600 font-medium">
                  Analyse détaillée de ton profil d'épuisement
                </p>
              </div>

              <div className="bg-white rounded-2xl shadow-2xl p-6 md:p-8 mb-6">
                <div className="text-center mb-6">
                  <div className="text-6xl font-black text-slate-900 mb-2">
                    {totalScore}<span className="text-3xl text-slate-400">/135</span>
                  </div>
                  <div className={`inline-block px-6 py-2 rounded-full text-lg font-bold ${
                    resultBand.color === 'green' ? 'bg-green-100 text-green-700' :
                    resultBand.color === 'yellow' ? 'bg-yellow-100 text-yellow-700' :
                    resultBand.color === 'orange' ? 'bg-orange-100 text-orange-700' :
                    'bg-red-100 text-red-700'
                  }`}>
                    {resultBand.band}
                  </div>
                </div>

                <div className="bg-slate-50 p-6 rounded-2xl mb-6">
                  <h3 className="font-bold text-slate-900 mb-3">🔍 Interprétation clinique</h3>
                  <p className="text-sm text-slate-700 leading-relaxed">
                    {resultBand.message}
                  </p>
                </div>

                <div className="space-y-4 mb-6">
                  <h3 className="font-bold text-slate-900">Scores par dimension</h3>
                  {DIMENSIONS.map(dim => {
                    const score = dimensionScores[dim.key];
                    const max = QUESTIONS.filter(q => q.dim === dim.key).length * 3;
                    const percentage = Math.round((score / max) * 100);
                    const colorMap = {
                      rose: { bg: "bg-rose-50", bar: "bg-rose-500", text: "text-rose-700" },
                      fuchsia: { bg: "bg-fuchsia-50", bar: "bg-fuchsia-500", text: "text-fuchsia-700" },
                      emerald: { bg: "bg-emerald-50", bar: "bg-emerald-500", text: "text-emerald-700" },
                    };
                    const colors = colorMap[dim.color];
                    
                    return (
                      <div key={dim.key} className={`p-4 rounded-xl ${colors.bg}`}>
                        <div className="flex justify-between items-center mb-2">
                          <span className={`text-sm font-bold ${colors.text}`}>{dim.label}</span>
                          <span className="text-sm font-bold text-slate-700">{score}/{max}</span>
                        </div>
                        <div className="w-full bg-white rounded-full h-3 overflow-hidden">
                          <div 
                            className={`h-full ${colors.bar} transition-all duration-500`}
                            style={{ width: `${percentage}%` }}
                          />
                        </div>
                        <div className="text-xs text-slate-600 mt-1">{percentage}%</div>
                      </div>
                    );
                  })}
                </div>

                <div className="bg-slate-50 p-6 rounded-2xl">
                  <h3 className="font-bold text-slate-900 mb-3">📌 Ton profil dominant</h3>
                  <p className="text-sm font-semibold text-indigo-600 mb-2">
                    {DIMENSIONS.find(d => d.key === profileAnalysis.dominant)?.label}
                  </p>
                  <p className="text-sm text-slate-700 leading-relaxed">
                    {profileAnalysis.analysis}
                  </p>
                </div>
              </div>

              <div className="grid md:grid-cols-2 gap-6">
                
                <div className="bg-white rounded-2xl shadow-xl p-6">
                  <h2 className="text-xl font-bold text-slate-900 mb-4">Recommandations</h2>
                  <ul className="space-y-3">
                    {resultBand.recommendations.map((rec, idx) => (
                      <li key={idx} className="flex gap-3 text-sm text-slate-700">
                        <span className="flex-shrink-0 w-6 h-6 rounded-full bg-indigo-100 text-indigo-600 font-bold text-xs flex items-center justify-center">
                          {idx + 1}
                        </span>
                        <span>{rec}</span>
                      </li>
                    ))}
                  </ul>

                  <div className="mt-6 pt-6 border-t-2 border-slate-100">
                    <h3 className="font-bold text-slate-900 mb-3">Ressources utiles</h3>
                    <ul className="space-y-2 text-sm">
                      <li>
                        <span className="text-slate-900 font-medium">3114</span>
                        <span className="text-slate-600"> — Numéro national prévention suicide</span>
                      </li>
                      <li>
                        <span className="text-slate-900 font-medium">Médecine du travail</span>
                        <span className="text-slate-600"> — Évaluation et protection</span>
                      </li>
                    </ul>
                  </div>
                </div>

                <div className="bg-white rounded-2xl shadow-xl p-6">
                  <h2 className="text-xl font-bold text-slate-900 mb-4">Exporter les résultats</h2>
                  
                  <div className="space-y-3">
                    <button
                      onClick={handlePDF}
                      className="w-full bg-slate-900 text-white font-semibold py-3 px-4 rounded-xl hover:bg-slate-800 transition"
                    >
                      📄 Télécharger en PDF
                    </button>

                    <button
                      onClick={handleDownloadJSON}
                      className="w-full bg-slate-700 text-white font-semibold py-3 px-4 rounded-xl hover:bg-slate-600 transition"
                    >
                      💾 Télécharger en JSON
                    </button>

                    <div className="pt-4 border-t-2 border-slate-100">
                      <label className="block text-sm font-medium text-slate-700 mb-2">
                        Envoyer par email
                      </label>
                      <div className="flex gap-2">
                        <input
                          type="email"
                          value={email}
                          onChange={(e) => setEmail(e.target.value)}
                          placeholder="email@exemple.com"
                          className="flex-1 rounded-lg border-2 border-slate-300 px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none"
                        />
                        <button
                          onClick={handleEmail}
                          disabled={!email}
                          className="bg-indigo-600 disabled:bg-slate-300 text-white font-semibold px-4 py-2 rounded-lg hover:bg-indigo-700 transition"
                        >
                          📧
                        </button>
                      </div>
                    </div>

                    <button
                      onClick={reset}
                      className="w-full mt-4 text-slate-600 hover:text-slate-900 font-medium underline text-sm"
                    >
                      Refaire le test
                    </button>
                  </div>
                </div>
              </div>

              <div className="mt-8 text-center text-xs text-slate-500 space-y-2">
                <p className="font-semibold">NOÉSIS — Burn-out Épuisement v1.0 • © 2025</p>
                <p>Outil de pré-diagnostic d'orientation • Pas un diagnostic médical</p>
                <p>Confidentialité : aucune donnée collectée sans action explicite (RGPD)</p>
              </div>
            </div>

            {/* SECTION IMPRIMABLE PDF (cachée à l'écran) */}
            <div className="print-only print-container">
              <div className="print-section">
                <h1 className="print-header">Résultats — Burn-out : Stade d'Épuisement</h1>
                <p className="print-text">Date : {new Date().toLocaleDateString('fr-FR')}</p>
                <p className="print-text">Score total : <strong>{totalScore}/135</strong></p>
                <p className="print-text">Profil : <strong>{resultBand.band}</strong></p>
              </div>

              <div className="print-section">
                <h2 className="print-subheader">Interprétation clinique</h2>
                <p className="print-text">{resultBand.message}</p>
              </div>

              <div className="print-section">
                <h2 className="print-subheader">Scores par dimension</h2>
                {DIMENSIONS.map(dim => {
                  const score = dimensionScores[dim.key];
                  const max = QUESTIONS.filter(q => q.dim === dim.key).length * 3;
                  const percentage = Math.round((score / max) * 100);
                  return (
                    <div key={dim.key} className="print-score-box">
                      <p className="print-text"><strong>{dim.label}</strong> : {score}/{max} ({percentage}%)</p>
                    </div>
                  );
                })}
              </div>

              <div className="print-section">
                <h2 className="print-subheader">Profil dominant</h2>
                <p className="print-text"><strong>{DIMENSIONS.find(d => d.key === profileAnalysis.dominant)?.label}</strong></p>
                <p className="print-text">{profileAnalysis.analysis}</p>
              </div>

              <div className="print-section">
                <h2 className="print-subheader">Recommandations</h2>
                {resultBand.recommendations.map((rec, idx) => (
                  <p key={idx} className="print-reco">{idx + 1}. {rec}</p>
                ))}
              </div>

              {/* DÉTAIL COMPLET DES QUESTIONS PAR AXE */}
              <div className="print-section" style={{pageBreakBefore: 'always'}}>
                <h2 className="print-header">Détail des réponses par dimension</h2>
                
                {DIMENSIONS.map(dim => {
                  const dimQuestions = QUESTIONS.filter(q => q.dim === dim.key);
                  return (
                    <div key={dim.key} className="print-axis-section">
                      <h3 className="print-subheader">{dim.label}</h3>
                      {dimQuestions.map(q => {
                        const answer = CHOICES.find(c => c.value === answers[q.id]);
                        return (
                          <div key={q.id} className="print-question">
                            <p className="print-text">
                              <strong>{q.id}</strong> : {q.text}
                            </p>
                            <p className="print-text" style={{paddingLeft: '16px', color: '#4b5563'}}>
                              → Réponse : <strong>{answer?.label || 'Non répondu'}</strong> ({answer?.anchor || ''})
                            </p>
                          </div>
                        );
                      })}
                    </div>
                  );
                })}
              </div>

              <div className="print-section" style={{marginTop: '20px', paddingTop: '12px', borderTop: '1px solid #e2e8f0'}}>
                <p className="print-text" style={{fontSize: '10px', color: '#64748b'}}>
                  NOÉSIS — Burn-out Épuisement v1.0 • © 2025 • Outil de pré-diagnostic d'orientation, ne remplace pas un diagnostic médical
                </p>
              </div>
            </div>
          </div>
        </div>
      );
    }

    // ============================================================
    // RENDU DANS LE DOM
    // ============================================================

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<BurnoutTest />);
  </script>
</body>
</html>
